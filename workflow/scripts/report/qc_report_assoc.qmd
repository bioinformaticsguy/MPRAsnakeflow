---
title: "QC Measures"
page-layout: full
format:
  html:
    code-fold: true
    code-tools: true
    embed-resources: true
    anchor-sections: true
    smooth-scroll: true
    toc: true
jupyter: python3
---


```{python}
#| tags: [parameters]
#| echo: false
```

```{python}
#| echo: false
# Imports
from IPython.display import display, Image
```



# Assignment QC Report
The Assignment QC (Quality Control) Report is a comprehensive document designed to evaluate and 
ensure the quality of data or processes involved in a specific assignment. This report is generated 
for the `{python} assignment` assignment with settings defined in the config `{python} configs`. The barcode length for this experiment is `{python} bc_length` base pairs.

Forward: `{python} fw`  
Reverse: `{python} rev`  
Barcode: `{python} bc`  
Design File: `{python} design_file`


```{python}
#| echo: false

with open(f"{workdir}/{design_file}") as f:
    lines = f.readlines()
    seq_num_in_design = len(lines)/2


```


# BC distribution over oligos
```{python}
#| echo: false
display(Image(f"{workdir}/{plot_file}"))
```


# Average number of BCs per oligo 
```{python}
#| echo: false
import pandas as pd
from IPython.display import HTML, display

df_all = pd.read_csv(f"{workdir}/{statistic_all_file}", sep='\t', compression='gzip')
df_filter = pd.read_csv(f"{workdir}/{statistic_filter_file}", sep='\t', compression='gzip')

new_row = pd.DataFrame({'Unnamed: 0': ['Sequences in design file'], 'Counts': int(seq_num_in_design)})

# Concatenate the new row DataFrame with the original DataFrame
df_all = pd.concat([new_row, df_all]).reset_index(drop=True).rename(columns={'Counts': 'Before filter', 'Unnamed: 0': ' '})
df_filter = pd.concat([new_row, df_filter]).reset_index(drop=True).rename(columns={'Counts': 'After filter', 'Unnamed: 0': ' '})
df = df_all.merge(df_filter, on=' ')

df
```


