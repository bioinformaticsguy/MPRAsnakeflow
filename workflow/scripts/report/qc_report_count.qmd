---
title: "QC Measures"
page-layout: full
format:
  html:
    code-fold: true
    code-tools: true
    embed-resources: true
    anchor-sections: true
    smooth-scroll: true
    toc: true
jupyter: python3
---

```{python}
#| echo: false
# Imports
from IPython.display import display, Image
from pathlib import Path
import pandas as pd 
import os
import sys
 
## Testing Imports
import matplotlib.pyplot as plt
import numpy as np

## Constants
image_path = Path(os.getcwd()).parent
ROOT_PATH = Path(os.getcwd()).parent
```

```{python}
#| echo: false
## Function Imports
cwd = Path.cwd()
while cwd.name != 'MPRAsnakeflow': cwd = cwd.parent
sys.path.insert(0, str(cwd))
from workflow.scripts.report.report_functions import display_unique_images, get_unique_files
```

```{python}
#| tags: [parameters]
#| echo: false
```


```{python}
#| echo: false
import yaml

def display_image(file_path, root_path=ROOT_PATH):
    full_path = str(root_path) + file_path
    print(full_path)
    display(Image(full_path))
```

# Per Barcode
## DNA
```{python}
#| echo: false
display(Image(f"{workdir}/{per_bar_code_dna}")) 
```



# BC Corelation   
## DNA
```{python}
#| echo: false
display_unique_images('**/*barcode_DNA_pairwise*.png', image_path)
```


## RNA
```{python}
#| echo: false
display_unique_images('**/*barcode_RNA_pairwise*.png', image_path)
```

## Ratio
```{python}
#| echo: false
display_unique_images('**/*barcode_Ratio_pairwise*.png', image_path)
```

# Oligo Corelation
## DNA
```{python}
#| echo: false
display(Image(f"{workdir}/{dna_oligo_coor_plot}"))
```


### Minimum Threashold
```{python}
#| echo: false
display(Image(f"{workdir}/{dna_oligo_coor_min_thre_plot}"))
```


## RNA
```{python}
#| echo: false
display(Image(f"{workdir}/{rna_oligo_coor_plot}"))
```


### Minimum Threashold
```{python}
#| echo: false
display(Image(f"{workdir}/{rna_oligo_coor_min_thre_plot}"))
```


## Ratio
```{python}
#| echo: false
display(Image(f"{workdir}/{ratio_oligo_coor_plot}"))
```


### Minimum Threashold
```{python}
#| echo: false
display(Image(f"{workdir}/{ratio_oligo_min_thre_plot}"))
```


# Barcodes Per Insert
```{python}
#| echo: false
display_unique_images('**/*barcodesPerInsert.png', image_path)
```

# Oligo Correlation
```{python}
#| echo: false
pd.read_csv(f"{workdir}/{statistics_all}", sep='\t')
```