Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 11
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Job stats:
job                                                             count
------------------------------------------------------------  -------
all                                                                 1
assigned_counts_assignBarcodes                                     12
assigned_counts_combine_replicates                                  4
assigned_counts_combine_replicates_barcode_output                   2
assigned_counts_dna_rna_merge                                       6
assigned_counts_filterAssignment                                    2
assigned_counts_make_master_tables                                  2
counts_dna_rna_merge_counts                                        12
counts_filter_counts                                               12
counts_final_counts                                                12
counts_umi_create_BAM                                              12
counts_umi_raw_counts                                              12
statistic_assigned_counts_combine_BC_assignment_stats               2
statistic_assigned_counts_combine_BC_assignment_stats_helper        2
statistic_assigned_counts_combine_stats_dna_rna_merge               2
statistic_assigned_counts_combine_stats_dna_rna_merge_all           2
statistic_bc_overlap_combine_assigned_counts                        2
statistic_bc_overlap_combine_counts                                 2
statistic_bc_overlap_run                                            8
statistic_correlation_bc_counts                                     4
statistic_correlation_bc_counts_hist                                4
statistic_correlation_calculate                                     2
statistic_correlation_combine_bc_assigned                           2
statistic_correlation_combine_bc_raw                                2
statistic_correlation_combine_oligo                                 2
statistic_correlation_hist_box_plots                                2
statistic_counts_BC_in_RNA_DNA                                     12
statistic_counts_BC_in_RNA_DNA_merge                                4
statistic_counts_barcode_base_composition                          12
statistic_counts_final                                              4
statistic_counts_frequent_umis                                     12
statistic_counts_stats_merge                                        4
statistic_counts_table                                             24
total                                                             199

Select jobs to execute...

[Sun Jun 23 16:21:10 2024]
rule assigned_counts_filterAssignment:
    input: data/SRR10800986_barcodes_to_coords.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/samplerer_assignment.py
    output: results/experiments/exampleCount1/assignment/fromFile.tsv.gz
    log: results/logs/assigned_counts/filterAssignment.exampleCount1.fromFile.log
    jobid: 147
    reason: Missing output files: results/experiments/exampleCount1/assignment/fromFile.tsv.gz
    wildcards: project=exampleCount1, assignment=fromFile
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/samplerer_assignment.py         --input data/SRR10800986_barcodes_to_coords.tsv.gz                                    --output results/experiments/exampleCount1/assignment/fromFile.tsv.gz &> results/logs/assigned_counts/filterAssignment.exampleCount1.fromFile.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_

[Sun Jun 23 16:21:10 2024]
rule counts_umi_create_BAM:
    input: data/SRR10800881_1.fastq.gz, data/SRR10800881_3.fastq.gz, data/SRR10800881_2.fastq.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/FastQ2doubleIndexBAM_python3.py, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/MergeTrimReadsBAM_python3.py
    output: results/experiments/exampleCount1/counts/useUMI.HEPG2_1_DNA.bam
    log: results/logs/counts/umi/create_BAM.exampleCount1.HEPG2.1.DNA.log
    jobid: 40
    reason: Missing output files: results/experiments/exampleCount1/counts/useUMI.HEPG2_1_DNA.bam
    wildcards: project=exampleCount1, condition=HEPG2, replicate=1, type=DNA
    resources: tmpdir=/tmp


        set +o pipefail;

        fwd_length=`zcat data/SRR10800881_1.fastq.gz | head -2 | tail -1 | wc -c`;
        fwd_length=$(expr $(($fwd_length-1)));

        rev_start=$(expr $(($fwd_length+1)));

        minoverlap=`echo ${fwd_length} ${fwd_length} 15 | awk '{print ($1+$2-$3-1 < 11) ? $1+$2-$3-1 : 11}'`;

        echo $rev_start >> results/logs/counts/umi/create_BAM.exampleCount1.HEPG2.1.DNA.log
        echo $minoverlap >> results/logs/counts/umi/create_BAM.exampleCount1.HEPG2.1.DNA.log

        paste <( zcat data/SRR10800881_1.fastq.gz ) <( zcat data/SRR10800881_3.fastq.gz  ) <( zcat data/SRR10800881_2.fastq.gz ) |         awk '{if (NR % 4 == 2 || NR % 4 == 0) {print $1$2$3} else {print $1}}' |         python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/FastQ2doubleIndexBAM_python3.py -p -s $rev_start -l 0 -m 10 --RG HEPG2_1_DNA |         python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/MergeTrimReadsBAM_python3.py --FirstReadChimeraFilter '' --adapterFirstRead '' --adapterSecondRead '' -p --mergeoverlap --minoverlap $minoverlap > results/experiments/exampleCount1/counts/useUMI.HEPG2_1_DNA.bam 2>> results/logs/counts/umi/create_BAM.exampleCount1.HEPG2.1.DNA.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_

[Sun Jun 23 16:21:10 2024]
rule counts_umi_create_BAM:
    input: data/SRR10800886_1.fastq.gz, data/SRR10800886_3.fastq.gz, data/SRR10800886_2.fastq.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/FastQ2doubleIndexBAM_python3.py, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/MergeTrimReadsBAM_python3.py
    output: results/experiments/exampleCount/counts/useUMI.HEPG2_3_RNA.bam
    log: results/logs/counts/umi/create_BAM.exampleCount.HEPG2.3.RNA.log
    jobid: 25
    reason: Missing output files: results/experiments/exampleCount/counts/useUMI.HEPG2_3_RNA.bam
    wildcards: project=exampleCount, condition=HEPG2, replicate=3, type=RNA
    resources: tmpdir=/tmp


        set +o pipefail;

        fwd_length=`zcat data/SRR10800886_1.fastq.gz | head -2 | tail -1 | wc -c`;
        fwd_length=$(expr $(($fwd_length-1)));

        rev_start=$(expr $(($fwd_length+1)));

        minoverlap=`echo ${fwd_length} ${fwd_length} 15 | awk '{print ($1+$2-$3-1 < 11) ? $1+$2-$3-1 : 11}'`;

        echo $rev_start >> results/logs/counts/umi/create_BAM.exampleCount.HEPG2.3.RNA.log
        echo $minoverlap >> results/logs/counts/umi/create_BAM.exampleCount.HEPG2.3.RNA.log

        paste <( zcat data/SRR10800886_1.fastq.gz ) <( zcat data/SRR10800886_3.fastq.gz  ) <( zcat data/SRR10800886_2.fastq.gz ) |         awk '{if (NR % 4 == 2 || NR % 4 == 0) {print $1$2$3} else {print $1}}' |         python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/FastQ2doubleIndexBAM_python3.py -p -s $rev_start -l 0 -m 10 --RG HEPG2_3_RNA |         python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/MergeTrimReadsBAM_python3.py --FirstReadChimeraFilter '' --adapterFirstRead '' --adapterSecondRead '' -p --mergeoverlap --minoverlap $minoverlap > results/experiments/exampleCount/counts/useUMI.HEPG2_3_RNA.bam 2>> results/logs/counts/umi/create_BAM.exampleCount.HEPG2.3.RNA.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_

[Sun Jun 23 16:21:10 2024]
rule counts_umi_create_BAM:
    input: data/SRR10800885_1.fastq.gz, data/SRR10800885_3.fastq.gz, data/SRR10800885_2.fastq.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/FastQ2doubleIndexBAM_python3.py, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/MergeTrimReadsBAM_python3.py
    output: results/experiments/exampleCount/counts/useUMI.HEPG2_3_DNA.bam
    log: results/logs/counts/umi/create_BAM.exampleCount.HEPG2.3.DNA.log
    jobid: 30
    reason: Missing output files: results/experiments/exampleCount/counts/useUMI.HEPG2_3_DNA.bam
    wildcards: project=exampleCount, condition=HEPG2, replicate=3, type=DNA
    resources: tmpdir=/tmp


        set +o pipefail;

        fwd_length=`zcat data/SRR10800885_1.fastq.gz | head -2 | tail -1 | wc -c`;
        fwd_length=$(expr $(($fwd_length-1)));

        rev_start=$(expr $(($fwd_length+1)));

        minoverlap=`echo ${fwd_length} ${fwd_length} 15 | awk '{print ($1+$2-$3-1 < 11) ? $1+$2-$3-1 : 11}'`;

        echo $rev_start >> results/logs/counts/umi/create_BAM.exampleCount.HEPG2.3.DNA.log
        echo $minoverlap >> results/logs/counts/umi/create_BAM.exampleCount.HEPG2.3.DNA.log

        paste <( zcat data/SRR10800885_1.fastq.gz ) <( zcat data/SRR10800885_3.fastq.gz  ) <( zcat data/SRR10800885_2.fastq.gz ) |         awk '{if (NR % 4 == 2 || NR % 4 == 0) {print $1$2$3} else {print $1}}' |         python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/FastQ2doubleIndexBAM_python3.py -p -s $rev_start -l 0 -m 10 --RG HEPG2_3_DNA |         python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/MergeTrimReadsBAM_python3.py --FirstReadChimeraFilter '' --adapterFirstRead '' --adapterSecondRead '' -p --mergeoverlap --minoverlap $minoverlap > results/experiments/exampleCount/counts/useUMI.HEPG2_3_DNA.bam 2>> results/logs/counts/umi/create_BAM.exampleCount.HEPG2.3.DNA.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_

[Sun Jun 23 16:21:10 2024]
rule assigned_counts_filterAssignment:
    input: data/SRR10800986_barcodes_to_coords.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/samplerer_assignment.py
    output: results/experiments/exampleCount/assignment/fromFile.tsv.gz
    log: results/logs/assigned_counts/filterAssignment.exampleCount.fromFile.log
    jobid: 136
    reason: Missing output files: results/experiments/exampleCount/assignment/fromFile.tsv.gz
    wildcards: project=exampleCount, assignment=fromFile
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/samplerer_assignment.py         --input data/SRR10800986_barcodes_to_coords.tsv.gz                                    --output results/experiments/exampleCount/assignment/fromFile.tsv.gz &> results/logs/assigned_counts/filterAssignment.exampleCount.fromFile.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_

[Sun Jun 23 16:21:10 2024]
rule counts_umi_create_BAM:
    input: data/SRR10800883_1.fastq.gz, data/SRR10800883_3.fastq.gz, data/SRR10800883_2.fastq.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/FastQ2doubleIndexBAM_python3.py, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/MergeTrimReadsBAM_python3.py
    output: results/experiments/exampleCount/counts/useUMI.HEPG2_2_DNA.bam
    log: results/logs/counts/umi/create_BAM.exampleCount.HEPG2.2.DNA.log
    jobid: 20
    reason: Missing output files: results/experiments/exampleCount/counts/useUMI.HEPG2_2_DNA.bam
    wildcards: project=exampleCount, condition=HEPG2, replicate=2, type=DNA
    resources: tmpdir=/tmp


        set +o pipefail;

        fwd_length=`zcat data/SRR10800883_1.fastq.gz | head -2 | tail -1 | wc -c`;
        fwd_length=$(expr $(($fwd_length-1)));

        rev_start=$(expr $(($fwd_length+1)));

        minoverlap=`echo ${fwd_length} ${fwd_length} 15 | awk '{print ($1+$2-$3-1 < 11) ? $1+$2-$3-1 : 11}'`;

        echo $rev_start >> results/logs/counts/umi/create_BAM.exampleCount.HEPG2.2.DNA.log
        echo $minoverlap >> results/logs/counts/umi/create_BAM.exampleCount.HEPG2.2.DNA.log

        paste <( zcat data/SRR10800883_1.fastq.gz ) <( zcat data/SRR10800883_3.fastq.gz  ) <( zcat data/SRR10800883_2.fastq.gz ) |         awk '{if (NR % 4 == 2 || NR % 4 == 0) {print $1$2$3} else {print $1}}' |         python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/FastQ2doubleIndexBAM_python3.py -p -s $rev_start -l 0 -m 10 --RG HEPG2_2_DNA |         python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/MergeTrimReadsBAM_python3.py --FirstReadChimeraFilter '' --adapterFirstRead '' --adapterSecondRead '' -p --mergeoverlap --minoverlap $minoverlap > results/experiments/exampleCount/counts/useUMI.HEPG2_2_DNA.bam 2>> results/logs/counts/umi/create_BAM.exampleCount.HEPG2.2.DNA.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_

[Sun Jun 23 16:21:10 2024]
rule counts_umi_create_BAM:
    input: data/SRR10800882_1.fastq.gz, data/SRR10800882_3.fastq.gz, data/SRR10800882_2.fastq.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/FastQ2doubleIndexBAM_python3.py, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/MergeTrimReadsBAM_python3.py
    output: results/experiments/exampleCount1/counts/useUMI.HEPG2_1_RNA.bam
    log: results/logs/counts/umi/create_BAM.exampleCount1.HEPG2.1.RNA.log
    jobid: 35
    reason: Missing output files: results/experiments/exampleCount1/counts/useUMI.HEPG2_1_RNA.bam
    wildcards: project=exampleCount1, condition=HEPG2, replicate=1, type=RNA
    resources: tmpdir=/tmp


        set +o pipefail;

        fwd_length=`zcat data/SRR10800882_1.fastq.gz | head -2 | tail -1 | wc -c`;
        fwd_length=$(expr $(($fwd_length-1)));

        rev_start=$(expr $(($fwd_length+1)));

        minoverlap=`echo ${fwd_length} ${fwd_length} 15 | awk '{print ($1+$2-$3-1 < 11) ? $1+$2-$3-1 : 11}'`;

        echo $rev_start >> results/logs/counts/umi/create_BAM.exampleCount1.HEPG2.1.RNA.log
        echo $minoverlap >> results/logs/counts/umi/create_BAM.exampleCount1.HEPG2.1.RNA.log

        paste <( zcat data/SRR10800882_1.fastq.gz ) <( zcat data/SRR10800882_3.fastq.gz  ) <( zcat data/SRR10800882_2.fastq.gz ) |         awk '{if (NR % 4 == 2 || NR % 4 == 0) {print $1$2$3} else {print $1}}' |         python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/FastQ2doubleIndexBAM_python3.py -p -s $rev_start -l 0 -m 10 --RG HEPG2_1_RNA |         python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/MergeTrimReadsBAM_python3.py --FirstReadChimeraFilter '' --adapterFirstRead '' --adapterSecondRead '' -p --mergeoverlap --minoverlap $minoverlap > results/experiments/exampleCount1/counts/useUMI.HEPG2_1_RNA.bam 2>> results/logs/counts/umi/create_BAM.exampleCount1.HEPG2.1.RNA.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_

[Sun Jun 23 16:21:10 2024]
rule counts_umi_create_BAM:
    input: data/SRR10800881_1.fastq.gz, data/SRR10800881_3.fastq.gz, data/SRR10800881_2.fastq.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/FastQ2doubleIndexBAM_python3.py, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/MergeTrimReadsBAM_python3.py
    output: results/experiments/exampleCount/counts/useUMI.HEPG2_1_DNA.bam
    log: results/logs/counts/umi/create_BAM.exampleCount.HEPG2.1.DNA.log
    jobid: 10
    reason: Missing output files: results/experiments/exampleCount/counts/useUMI.HEPG2_1_DNA.bam
    wildcards: project=exampleCount, condition=HEPG2, replicate=1, type=DNA
    resources: tmpdir=/tmp


        set +o pipefail;

        fwd_length=`zcat data/SRR10800881_1.fastq.gz | head -2 | tail -1 | wc -c`;
        fwd_length=$(expr $(($fwd_length-1)));

        rev_start=$(expr $(($fwd_length+1)));

        minoverlap=`echo ${fwd_length} ${fwd_length} 15 | awk '{print ($1+$2-$3-1 < 11) ? $1+$2-$3-1 : 11}'`;

        echo $rev_start >> results/logs/counts/umi/create_BAM.exampleCount.HEPG2.1.DNA.log
        echo $minoverlap >> results/logs/counts/umi/create_BAM.exampleCount.HEPG2.1.DNA.log

        paste <( zcat data/SRR10800881_1.fastq.gz ) <( zcat data/SRR10800881_3.fastq.gz  ) <( zcat data/SRR10800881_2.fastq.gz ) |         awk '{if (NR % 4 == 2 || NR % 4 == 0) {print $1$2$3} else {print $1}}' |         python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/FastQ2doubleIndexBAM_python3.py -p -s $rev_start -l 0 -m 10 --RG HEPG2_1_DNA |         python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/MergeTrimReadsBAM_python3.py --FirstReadChimeraFilter '' --adapterFirstRead '' --adapterSecondRead '' -p --mergeoverlap --minoverlap $minoverlap > results/experiments/exampleCount/counts/useUMI.HEPG2_1_DNA.bam 2>> results/logs/counts/umi/create_BAM.exampleCount.HEPG2.1.DNA.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_

[Sun Jun 23 16:21:10 2024]
rule counts_umi_create_BAM:
    input: data/SRR10800883_1.fastq.gz, data/SRR10800883_3.fastq.gz, data/SRR10800883_2.fastq.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/FastQ2doubleIndexBAM_python3.py, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/MergeTrimReadsBAM_python3.py
    output: results/experiments/exampleCount1/counts/useUMI.HEPG2_2_DNA.bam
    log: results/logs/counts/umi/create_BAM.exampleCount1.HEPG2.2.DNA.log
    jobid: 50
    reason: Missing output files: results/experiments/exampleCount1/counts/useUMI.HEPG2_2_DNA.bam
    wildcards: project=exampleCount1, condition=HEPG2, replicate=2, type=DNA
    resources: tmpdir=/tmp


        set +o pipefail;

        fwd_length=`zcat data/SRR10800883_1.fastq.gz | head -2 | tail -1 | wc -c`;
        fwd_length=$(expr $(($fwd_length-1)));

        rev_start=$(expr $(($fwd_length+1)));

        minoverlap=`echo ${fwd_length} ${fwd_length} 15 | awk '{print ($1+$2-$3-1 < 11) ? $1+$2-$3-1 : 11}'`;

        echo $rev_start >> results/logs/counts/umi/create_BAM.exampleCount1.HEPG2.2.DNA.log
        echo $minoverlap >> results/logs/counts/umi/create_BAM.exampleCount1.HEPG2.2.DNA.log

        paste <( zcat data/SRR10800883_1.fastq.gz ) <( zcat data/SRR10800883_3.fastq.gz  ) <( zcat data/SRR10800883_2.fastq.gz ) |         awk '{if (NR % 4 == 2 || NR % 4 == 0) {print $1$2$3} else {print $1}}' |         python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/FastQ2doubleIndexBAM_python3.py -p -s $rev_start -l 0 -m 10 --RG HEPG2_2_DNA |         python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/MergeTrimReadsBAM_python3.py --FirstReadChimeraFilter '' --adapterFirstRead '' --adapterSecondRead '' -p --mergeoverlap --minoverlap $minoverlap > results/experiments/exampleCount1/counts/useUMI.HEPG2_2_DNA.bam 2>> results/logs/counts/umi/create_BAM.exampleCount1.HEPG2.2.DNA.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_

[Sun Jun 23 16:21:10 2024]
rule counts_umi_create_BAM:
    input: data/SRR10800885_1.fastq.gz, data/SRR10800885_3.fastq.gz, data/SRR10800885_2.fastq.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/FastQ2doubleIndexBAM_python3.py, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/MergeTrimReadsBAM_python3.py
    output: results/experiments/exampleCount1/counts/useUMI.HEPG2_3_DNA.bam
    log: results/logs/counts/umi/create_BAM.exampleCount1.HEPG2.3.DNA.log
    jobid: 60
    reason: Missing output files: results/experiments/exampleCount1/counts/useUMI.HEPG2_3_DNA.bam
    wildcards: project=exampleCount1, condition=HEPG2, replicate=3, type=DNA
    resources: tmpdir=/tmp


        set +o pipefail;

        fwd_length=`zcat data/SRR10800885_1.fastq.gz | head -2 | tail -1 | wc -c`;
        fwd_length=$(expr $(($fwd_length-1)));

        rev_start=$(expr $(($fwd_length+1)));

        minoverlap=`echo ${fwd_length} ${fwd_length} 15 | awk '{print ($1+$2-$3-1 < 11) ? $1+$2-$3-1 : 11}'`;

        echo $rev_start >> results/logs/counts/umi/create_BAM.exampleCount1.HEPG2.3.DNA.log
        echo $minoverlap >> results/logs/counts/umi/create_BAM.exampleCount1.HEPG2.3.DNA.log

        paste <( zcat data/SRR10800885_1.fastq.gz ) <( zcat data/SRR10800885_3.fastq.gz  ) <( zcat data/SRR10800885_2.fastq.gz ) |         awk '{if (NR % 4 == 2 || NR % 4 == 0) {print $1$2$3} else {print $1}}' |         python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/FastQ2doubleIndexBAM_python3.py -p -s $rev_start -l 0 -m 10 --RG HEPG2_3_DNA |         python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/MergeTrimReadsBAM_python3.py --FirstReadChimeraFilter '' --adapterFirstRead '' --adapterSecondRead '' -p --mergeoverlap --minoverlap $minoverlap > results/experiments/exampleCount1/counts/useUMI.HEPG2_3_DNA.bam 2>> results/logs/counts/umi/create_BAM.exampleCount1.HEPG2.3.DNA.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_

[Sun Jun 23 16:21:10 2024]
rule counts_umi_create_BAM:
    input: data/SRR10800882_1.fastq.gz, data/SRR10800882_3.fastq.gz, data/SRR10800882_2.fastq.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/FastQ2doubleIndexBAM_python3.py, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/MergeTrimReadsBAM_python3.py
    output: results/experiments/exampleCount/counts/useUMI.HEPG2_1_RNA.bam
    log: results/logs/counts/umi/create_BAM.exampleCount.HEPG2.1.RNA.log
    jobid: 5
    reason: Missing output files: results/experiments/exampleCount/counts/useUMI.HEPG2_1_RNA.bam
    wildcards: project=exampleCount, condition=HEPG2, replicate=1, type=RNA
    resources: tmpdir=/tmp


        set +o pipefail;

        fwd_length=`zcat data/SRR10800882_1.fastq.gz | head -2 | tail -1 | wc -c`;
        fwd_length=$(expr $(($fwd_length-1)));

        rev_start=$(expr $(($fwd_length+1)));

        minoverlap=`echo ${fwd_length} ${fwd_length} 15 | awk '{print ($1+$2-$3-1 < 11) ? $1+$2-$3-1 : 11}'`;

        echo $rev_start >> results/logs/counts/umi/create_BAM.exampleCount.HEPG2.1.RNA.log
        echo $minoverlap >> results/logs/counts/umi/create_BAM.exampleCount.HEPG2.1.RNA.log

        paste <( zcat data/SRR10800882_1.fastq.gz ) <( zcat data/SRR10800882_3.fastq.gz  ) <( zcat data/SRR10800882_2.fastq.gz ) |         awk '{if (NR % 4 == 2 || NR % 4 == 0) {print $1$2$3} else {print $1}}' |         python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/FastQ2doubleIndexBAM_python3.py -p -s $rev_start -l 0 -m 10 --RG HEPG2_1_RNA |         python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/MergeTrimReadsBAM_python3.py --FirstReadChimeraFilter '' --adapterFirstRead '' --adapterSecondRead '' -p --mergeoverlap --minoverlap $minoverlap > results/experiments/exampleCount/counts/useUMI.HEPG2_1_RNA.bam 2>> results/logs/counts/umi/create_BAM.exampleCount.HEPG2.1.RNA.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:21:37 2024]
Finished job 147.
1 of 199 steps (1%) done
Select jobs to execute...

[Sun Jun 23 16:21:37 2024]
rule counts_umi_create_BAM:
    input: data/SRR10800884_1.fastq.gz, data/SRR10800884_3.fastq.gz, data/SRR10800884_2.fastq.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/FastQ2doubleIndexBAM_python3.py, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/MergeTrimReadsBAM_python3.py
    output: results/experiments/exampleCount1/counts/useUMI.HEPG2_2_RNA.bam
    log: results/logs/counts/umi/create_BAM.exampleCount1.HEPG2.2.RNA.log
    jobid: 45
    reason: Missing output files: results/experiments/exampleCount1/counts/useUMI.HEPG2_2_RNA.bam
    wildcards: project=exampleCount1, condition=HEPG2, replicate=2, type=RNA
    resources: tmpdir=/tmp


        set +o pipefail;

        fwd_length=`zcat data/SRR10800884_1.fastq.gz | head -2 | tail -1 | wc -c`;
        fwd_length=$(expr $(($fwd_length-1)));

        rev_start=$(expr $(($fwd_length+1)));

        minoverlap=`echo ${fwd_length} ${fwd_length} 15 | awk '{print ($1+$2-$3-1 < 11) ? $1+$2-$3-1 : 11}'`;

        echo $rev_start >> results/logs/counts/umi/create_BAM.exampleCount1.HEPG2.2.RNA.log
        echo $minoverlap >> results/logs/counts/umi/create_BAM.exampleCount1.HEPG2.2.RNA.log

        paste <( zcat data/SRR10800884_1.fastq.gz ) <( zcat data/SRR10800884_3.fastq.gz  ) <( zcat data/SRR10800884_2.fastq.gz ) |         awk '{if (NR % 4 == 2 || NR % 4 == 0) {print $1$2$3} else {print $1}}' |         python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/FastQ2doubleIndexBAM_python3.py -p -s $rev_start -l 0 -m 10 --RG HEPG2_2_RNA |         python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/MergeTrimReadsBAM_python3.py --FirstReadChimeraFilter '' --adapterFirstRead '' --adapterSecondRead '' -p --mergeoverlap --minoverlap $minoverlap > results/experiments/exampleCount1/counts/useUMI.HEPG2_2_RNA.bam 2>> results/logs/counts/umi/create_BAM.exampleCount1.HEPG2.2.RNA.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:21:37 2024]
Finished job 136.
2 of 199 steps (1%) done
Select jobs to execute...

[Sun Jun 23 16:21:37 2024]
rule counts_umi_create_BAM:
    input: data/SRR10800886_1.fastq.gz, data/SRR10800886_3.fastq.gz, data/SRR10800886_2.fastq.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/FastQ2doubleIndexBAM_python3.py, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/MergeTrimReadsBAM_python3.py
    output: results/experiments/exampleCount1/counts/useUMI.HEPG2_3_RNA.bam
    log: results/logs/counts/umi/create_BAM.exampleCount1.HEPG2.3.RNA.log
    jobid: 55
    reason: Missing output files: results/experiments/exampleCount1/counts/useUMI.HEPG2_3_RNA.bam
    wildcards: project=exampleCount1, condition=HEPG2, replicate=3, type=RNA
    resources: tmpdir=/tmp


        set +o pipefail;

        fwd_length=`zcat data/SRR10800886_1.fastq.gz | head -2 | tail -1 | wc -c`;
        fwd_length=$(expr $(($fwd_length-1)));

        rev_start=$(expr $(($fwd_length+1)));

        minoverlap=`echo ${fwd_length} ${fwd_length} 15 | awk '{print ($1+$2-$3-1 < 11) ? $1+$2-$3-1 : 11}'`;

        echo $rev_start >> results/logs/counts/umi/create_BAM.exampleCount1.HEPG2.3.RNA.log
        echo $minoverlap >> results/logs/counts/umi/create_BAM.exampleCount1.HEPG2.3.RNA.log

        paste <( zcat data/SRR10800886_1.fastq.gz ) <( zcat data/SRR10800886_3.fastq.gz  ) <( zcat data/SRR10800886_2.fastq.gz ) |         awk '{if (NR % 4 == 2 || NR % 4 == 0) {print $1$2$3} else {print $1}}' |         python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/FastQ2doubleIndexBAM_python3.py -p -s $rev_start -l 0 -m 10 --RG HEPG2_3_RNA |         python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/MergeTrimReadsBAM_python3.py --FirstReadChimeraFilter '' --adapterFirstRead '' --adapterSecondRead '' -p --mergeoverlap --minoverlap $minoverlap > results/experiments/exampleCount1/counts/useUMI.HEPG2_3_RNA.bam 2>> results/logs/counts/umi/create_BAM.exampleCount1.HEPG2.3.RNA.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:22:49 2024]
Finished job 35.
3 of 199 steps (2%) done
Select jobs to execute...

[Sun Jun 23 16:22:49 2024]
rule counts_umi_create_BAM:
    input: data/SRR10800884_1.fastq.gz, data/SRR10800884_3.fastq.gz, data/SRR10800884_2.fastq.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/FastQ2doubleIndexBAM_python3.py, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/MergeTrimReadsBAM_python3.py
    output: results/experiments/exampleCount/counts/useUMI.HEPG2_2_RNA.bam
    log: results/logs/counts/umi/create_BAM.exampleCount.HEPG2.2.RNA.log
    jobid: 15
    reason: Missing output files: results/experiments/exampleCount/counts/useUMI.HEPG2_2_RNA.bam
    wildcards: project=exampleCount, condition=HEPG2, replicate=2, type=RNA
    resources: tmpdir=/tmp


        set +o pipefail;

        fwd_length=`zcat data/SRR10800884_1.fastq.gz | head -2 | tail -1 | wc -c`;
        fwd_length=$(expr $(($fwd_length-1)));

        rev_start=$(expr $(($fwd_length+1)));

        minoverlap=`echo ${fwd_length} ${fwd_length} 15 | awk '{print ($1+$2-$3-1 < 11) ? $1+$2-$3-1 : 11}'`;

        echo $rev_start >> results/logs/counts/umi/create_BAM.exampleCount.HEPG2.2.RNA.log
        echo $minoverlap >> results/logs/counts/umi/create_BAM.exampleCount.HEPG2.2.RNA.log

        paste <( zcat data/SRR10800884_1.fastq.gz ) <( zcat data/SRR10800884_3.fastq.gz  ) <( zcat data/SRR10800884_2.fastq.gz ) |         awk '{if (NR % 4 == 2 || NR % 4 == 0) {print $1$2$3} else {print $1}}' |         python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/FastQ2doubleIndexBAM_python3.py -p -s $rev_start -l 0 -m 10 --RG HEPG2_2_RNA |         python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/MergeTrimReadsBAM_python3.py --FirstReadChimeraFilter '' --adapterFirstRead '' --adapterSecondRead '' -p --mergeoverlap --minoverlap $minoverlap > results/experiments/exampleCount/counts/useUMI.HEPG2_2_RNA.bam 2>> results/logs/counts/umi/create_BAM.exampleCount.HEPG2.2.RNA.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:22:49 2024]
Finished job 25.
4 of 199 steps (2%) done
Select jobs to execute...

[Sun Jun 23 16:22:49 2024]
rule counts_umi_raw_counts:
    input: results/experiments/exampleCount/counts/useUMI.HEPG2_3_RNA.bam
    output: results/experiments/exampleCount/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz
    log: results/logs/counts/umi/raw_counts.exampleCount.HEPG2.3.RNA.log
    jobid: 24
    reason: Missing output files: results/experiments/exampleCount/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/useUMI.HEPG2_3_RNA.bam
    wildcards: project=exampleCount, condition=HEPG2, replicate=3, type=RNA
    resources: tmpdir=/tmp


        samtools view -F 1 -r HEPG2_3_RNA results/experiments/exampleCount/counts/useUMI.HEPG2_3_RNA.bam |         awk -v 'OFS=\t' '{ for (i=12; i<=NF; i++) {
          if ($i ~ /^XJ:Z:/) print $10,substr($i,6,10)
        }}' |         sort | uniq -c |         awk -v 'OFS=\t' '{ print $2,$3,$1 }' |         gzip -c > results/experiments/exampleCount/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz 2> results/logs/counts/umi/raw_counts.exampleCount.HEPG2.3.RNA.log
        
Activating conda environment: .snakemake/conda/9030bacf18a7682e51f4bb53f8e2c2d9_
[Sun Jun 23 16:22:49 2024]
Finished job 30.
5 of 199 steps (3%) done
Select jobs to execute...

[Sun Jun 23 16:22:49 2024]
rule counts_umi_raw_counts:
    input: results/experiments/exampleCount/counts/useUMI.HEPG2_3_DNA.bam
    output: results/experiments/exampleCount/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz
    log: results/logs/counts/umi/raw_counts.exampleCount.HEPG2.3.DNA.log
    jobid: 29
    reason: Missing output files: results/experiments/exampleCount/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/useUMI.HEPG2_3_DNA.bam
    wildcards: project=exampleCount, condition=HEPG2, replicate=3, type=DNA
    resources: tmpdir=/tmp


        samtools view -F 1 -r HEPG2_3_DNA results/experiments/exampleCount/counts/useUMI.HEPG2_3_DNA.bam |         awk -v 'OFS=\t' '{ for (i=12; i<=NF; i++) {
          if ($i ~ /^XJ:Z:/) print $10,substr($i,6,10)
        }}' |         sort | uniq -c |         awk -v 'OFS=\t' '{ print $2,$3,$1 }' |         gzip -c > results/experiments/exampleCount/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz 2> results/logs/counts/umi/raw_counts.exampleCount.HEPG2.3.DNA.log
        
Activating conda environment: .snakemake/conda/9030bacf18a7682e51f4bb53f8e2c2d9_
[Sun Jun 23 16:22:50 2024]
Finished job 40.
6 of 199 steps (3%) done
Select jobs to execute...

[Sun Jun 23 16:22:50 2024]
rule counts_umi_raw_counts:
    input: results/experiments/exampleCount1/counts/useUMI.HEPG2_1_DNA.bam
    output: results/experiments/exampleCount1/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz
    log: results/logs/counts/umi/raw_counts.exampleCount1.HEPG2.1.DNA.log
    jobid: 39
    reason: Missing output files: results/experiments/exampleCount1/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/useUMI.HEPG2_1_DNA.bam
    wildcards: project=exampleCount1, condition=HEPG2, replicate=1, type=DNA
    resources: tmpdir=/tmp


        samtools view -F 1 -r HEPG2_1_DNA results/experiments/exampleCount1/counts/useUMI.HEPG2_1_DNA.bam |         awk -v 'OFS=\t' '{ for (i=12; i<=NF; i++) {
          if ($i ~ /^XJ:Z:/) print $10,substr($i,6,10)
        }}' |         sort | uniq -c |         awk -v 'OFS=\t' '{ print $2,$3,$1 }' |         gzip -c > results/experiments/exampleCount1/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz 2> results/logs/counts/umi/raw_counts.exampleCount1.HEPG2.1.DNA.log
        
Activating conda environment: .snakemake/conda/9030bacf18a7682e51f4bb53f8e2c2d9_
[Sun Jun 23 16:22:50 2024]
Finished job 5.
7 of 199 steps (4%) done
[Sun Jun 23 16:22:50 2024]
Finished job 10.
8 of 199 steps (4%) done
Select jobs to execute...

[Sun Jun 23 16:22:50 2024]
rule counts_umi_raw_counts:
    input: results/experiments/exampleCount/counts/useUMI.HEPG2_1_DNA.bam
    output: results/experiments/exampleCount/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz
    log: results/logs/counts/umi/raw_counts.exampleCount.HEPG2.1.DNA.log
    jobid: 9
    reason: Missing output files: results/experiments/exampleCount/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/useUMI.HEPG2_1_DNA.bam
    wildcards: project=exampleCount, condition=HEPG2, replicate=1, type=DNA
    resources: tmpdir=/tmp


        samtools view -F 1 -r HEPG2_1_DNA results/experiments/exampleCount/counts/useUMI.HEPG2_1_DNA.bam |         awk -v 'OFS=\t' '{ for (i=12; i<=NF; i++) {
          if ($i ~ /^XJ:Z:/) print $10,substr($i,6,10)
        }}' |         sort | uniq -c |         awk -v 'OFS=\t' '{ print $2,$3,$1 }' |         gzip -c > results/experiments/exampleCount/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz 2> results/logs/counts/umi/raw_counts.exampleCount.HEPG2.1.DNA.log
        
Activating conda environment: .snakemake/conda/9030bacf18a7682e51f4bb53f8e2c2d9_

[Sun Jun 23 16:22:50 2024]
rule counts_umi_raw_counts:
    input: results/experiments/exampleCount/counts/useUMI.HEPG2_1_RNA.bam
    output: results/experiments/exampleCount/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz
    log: results/logs/counts/umi/raw_counts.exampleCount.HEPG2.1.RNA.log
    jobid: 4
    reason: Missing output files: results/experiments/exampleCount/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/useUMI.HEPG2_1_RNA.bam
    wildcards: project=exampleCount, condition=HEPG2, replicate=1, type=RNA
    resources: tmpdir=/tmp


        samtools view -F 1 -r HEPG2_1_RNA results/experiments/exampleCount/counts/useUMI.HEPG2_1_RNA.bam |         awk -v 'OFS=\t' '{ for (i=12; i<=NF; i++) {
          if ($i ~ /^XJ:Z:/) print $10,substr($i,6,10)
        }}' |         sort | uniq -c |         awk -v 'OFS=\t' '{ print $2,$3,$1 }' |         gzip -c > results/experiments/exampleCount/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz 2> results/logs/counts/umi/raw_counts.exampleCount.HEPG2.1.RNA.log
        
Select jobs to execute...
Activating conda environment: .snakemake/conda/9030bacf18a7682e51f4bb53f8e2c2d9_
[Sun Jun 23 16:22:50 2024]
Finished job 20.
9 of 199 steps (5%) done

[Sun Jun 23 16:22:50 2024]
rule counts_umi_raw_counts:
    input: results/experiments/exampleCount1/counts/useUMI.HEPG2_1_RNA.bam
    output: results/experiments/exampleCount1/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz
    log: results/logs/counts/umi/raw_counts.exampleCount1.HEPG2.1.RNA.log
    jobid: 34
    reason: Missing output files: results/experiments/exampleCount1/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/useUMI.HEPG2_1_RNA.bam
    wildcards: project=exampleCount1, condition=HEPG2, replicate=1, type=RNA
    resources: tmpdir=/tmp


        samtools view -F 1 -r HEPG2_1_RNA results/experiments/exampleCount1/counts/useUMI.HEPG2_1_RNA.bam |         awk -v 'OFS=\t' '{ for (i=12; i<=NF; i++) {
          if ($i ~ /^XJ:Z:/) print $10,substr($i,6,10)
        }}' |         sort | uniq -c |         awk -v 'OFS=\t' '{ print $2,$3,$1 }' |         gzip -c > results/experiments/exampleCount1/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz 2> results/logs/counts/umi/raw_counts.exampleCount1.HEPG2.1.RNA.log
        
Activating conda environment: .snakemake/conda/9030bacf18a7682e51f4bb53f8e2c2d9_
[Sun Jun 23 16:22:51 2024]
Finished job 60.
10 of 199 steps (5%) done
Select jobs to execute...

[Sun Jun 23 16:22:51 2024]
rule counts_umi_raw_counts:
    input: results/experiments/exampleCount1/counts/useUMI.HEPG2_3_DNA.bam
    output: results/experiments/exampleCount1/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz
    log: results/logs/counts/umi/raw_counts.exampleCount1.HEPG2.3.DNA.log
    jobid: 59
    reason: Missing output files: results/experiments/exampleCount1/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/useUMI.HEPG2_3_DNA.bam
    wildcards: project=exampleCount1, condition=HEPG2, replicate=3, type=DNA
    resources: tmpdir=/tmp


        samtools view -F 1 -r HEPG2_3_DNA results/experiments/exampleCount1/counts/useUMI.HEPG2_3_DNA.bam |         awk -v 'OFS=\t' '{ for (i=12; i<=NF; i++) {
          if ($i ~ /^XJ:Z:/) print $10,substr($i,6,10)
        }}' |         sort | uniq -c |         awk -v 'OFS=\t' '{ print $2,$3,$1 }' |         gzip -c > results/experiments/exampleCount1/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz 2> results/logs/counts/umi/raw_counts.exampleCount1.HEPG2.3.DNA.log
        
Activating conda environment: .snakemake/conda/9030bacf18a7682e51f4bb53f8e2c2d9_
[Sun Jun 23 16:22:51 2024]
Finished job 50.
11 of 199 steps (6%) done
Select jobs to execute...

[Sun Jun 23 16:22:51 2024]
rule counts_umi_raw_counts:
    input: results/experiments/exampleCount1/counts/useUMI.HEPG2_2_DNA.bam
    output: results/experiments/exampleCount1/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz
    log: results/logs/counts/umi/raw_counts.exampleCount1.HEPG2.2.DNA.log
    jobid: 49
    reason: Missing output files: results/experiments/exampleCount1/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/useUMI.HEPG2_2_DNA.bam
    wildcards: project=exampleCount1, condition=HEPG2, replicate=2, type=DNA
    resources: tmpdir=/tmp


        samtools view -F 1 -r HEPG2_2_DNA results/experiments/exampleCount1/counts/useUMI.HEPG2_2_DNA.bam |         awk -v 'OFS=\t' '{ for (i=12; i<=NF; i++) {
          if ($i ~ /^XJ:Z:/) print $10,substr($i,6,10)
        }}' |         sort | uniq -c |         awk -v 'OFS=\t' '{ print $2,$3,$1 }' |         gzip -c > results/experiments/exampleCount1/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz 2> results/logs/counts/umi/raw_counts.exampleCount1.HEPG2.2.DNA.log
        
Activating conda environment: .snakemake/conda/9030bacf18a7682e51f4bb53f8e2c2d9_
[Sun Jun 23 16:22:59 2024]
Finished job 24.
12 of 199 steps (6%) done
Select jobs to execute...

[Sun Jun 23 16:22:59 2024]
rule statistic_counts_table:
    input: results/experiments/exampleCount/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts/HEPG2_3_RNA_raw_counts.tsv.gz
    log: results/logs/statistic/counts/table.exampleCount.HEPG2_3_RNA_raw.log
    jobid: 68
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/HEPG2_3_RNA_raw_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=3, type=RNA, countType=raw
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "3") <( echo "RNA")         <( 
            zcat results/experiments/exampleCount/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz |             awk -v OFS='\t' 'BEGIN{
                pbar="NA"
            }{ 
                count += $NF; umi_sum+=$3; if (pbar != $1) { barcodes+=1 }; pbar=$1 
            }END{ 
                if (NR > 0) {
                    print umi_sum/NR,count,NR,barcodes
                } else {
                    print 0,0,0,0
                }
            }' 
        )         <( 
            zcat results/experiments/exampleCount/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz | cut -f 2 | sort -u | wc -l 
        ) |         gzip -c > results/experiments/exampleCount/statistic/counts/HEPG2_3_RNA_raw_counts.tsv.gz 2> results/logs/statistic/counts/table.exampleCount.HEPG2_3_RNA_raw.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:22:59 2024]
Finished job 59.
13 of 199 steps (7%) done
Select jobs to execute...

[Sun Jun 23 16:22:59 2024]
rule counts_umi_raw_counts:
    input: results/experiments/exampleCount/counts/useUMI.HEPG2_2_DNA.bam
    output: results/experiments/exampleCount/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz
    log: results/logs/counts/umi/raw_counts.exampleCount.HEPG2.2.DNA.log
    jobid: 19
    reason: Missing output files: results/experiments/exampleCount/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/useUMI.HEPG2_2_DNA.bam
    wildcards: project=exampleCount, condition=HEPG2, replicate=2, type=DNA
    resources: tmpdir=/tmp


        samtools view -F 1 -r HEPG2_2_DNA results/experiments/exampleCount/counts/useUMI.HEPG2_2_DNA.bam |         awk -v 'OFS=\t' '{ for (i=12; i<=NF; i++) {
          if ($i ~ /^XJ:Z:/) print $10,substr($i,6,10)
        }}' |         sort | uniq -c |         awk -v 'OFS=\t' '{ print $2,$3,$1 }' |         gzip -c > results/experiments/exampleCount/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz 2> results/logs/counts/umi/raw_counts.exampleCount.HEPG2.2.DNA.log
        
[Sun Jun 23 16:22:59 2024]
Finished job 39.
14 of 199 steps (7%) done
Select jobs to execute...
Activating conda environment: .snakemake/conda/9030bacf18a7682e51f4bb53f8e2c2d9_

[Sun Jun 23 16:22:59 2024]
rule counts_filter_counts:
    input: results/experiments/exampleCount/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount/counts/HEPG2_3_RNA_filtered_counts.tsv.gz
    log: results/logs/counts/filter_counts.exampleCount.HEPG2.3.RNA.log
    jobid: 23
    reason: Missing output files: results/experiments/exampleCount/counts/HEPG2_3_RNA_filtered_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=3, type=RNA
    resources: tmpdir=/tmp


        bc=15;
        echo $bc;
        zcat results/experiments/exampleCount/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz | grep -v "N" |         awk -v var="$bc" -v 'OFS=\t' '{ if (length($1) == var) { print } }' |         sort |         gzip -c > results/experiments/exampleCount/counts/HEPG2_3_RNA_filtered_counts.tsv.gz
        
[Sun Jun 23 16:22:59 2024]
Finished job 4.
15 of 199 steps (8%) done
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:22:59 2024]
Finished job 9.
16 of 199 steps (8%) done
Select jobs to execute...

[Sun Jun 23 16:22:59 2024]
rule counts_filter_counts:
    input: results/experiments/exampleCount1/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount1/counts/HEPG2_3_DNA_filtered_counts.tsv.gz
    log: results/logs/counts/filter_counts.exampleCount1.HEPG2.3.DNA.log
    jobid: 58
    reason: Missing output files: results/experiments/exampleCount1/counts/HEPG2_3_DNA_filtered_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=3, type=DNA
    resources: tmpdir=/tmp


        bc=15;
        echo $bc;
        zcat results/experiments/exampleCount1/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz | grep -v "N" |         awk -v var="$bc" -v 'OFS=\t' '{ if (length($1) == var) { print } }' |         sort |         gzip -c > results/experiments/exampleCount1/counts/HEPG2_3_DNA_filtered_counts.tsv.gz
        

[Sun Jun 23 16:22:59 2024]
rule counts_filter_counts:
    input: results/experiments/exampleCount/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount/counts/HEPG2_1_RNA_filtered_counts.tsv.gz
    log: results/logs/counts/filter_counts.exampleCount.HEPG2.1.RNA.log
    jobid: 3
    reason: Missing output files: results/experiments/exampleCount/counts/HEPG2_1_RNA_filtered_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=1, type=RNA
    resources: tmpdir=/tmp


        bc=15;
        echo $bc;
        zcat results/experiments/exampleCount/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz | grep -v "N" |         awk -v var="$bc" -v 'OFS=\t' '{ if (length($1) == var) { print } }' |         sort |         gzip -c > results/experiments/exampleCount/counts/HEPG2_1_RNA_filtered_counts.tsv.gz
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:22:59 2024]
Finished job 29.
17 of 199 steps (9%) done
Select jobs to execute...

[Sun Jun 23 16:22:59 2024]
rule statistic_counts_table:
    input: results/experiments/exampleCount/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts/HEPG2_1_RNA_raw_counts.tsv.gz
    log: results/logs/statistic/counts/table.exampleCount.HEPG2_1_RNA_raw.log
    jobid: 64
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/HEPG2_1_RNA_raw_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=1, type=RNA, countType=raw
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "1") <( echo "RNA")         <( 
            zcat results/experiments/exampleCount/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz |             awk -v OFS='\t' 'BEGIN{
                pbar="NA"
            }{ 
                count += $NF; umi_sum+=$3; if (pbar != $1) { barcodes+=1 }; pbar=$1 
            }END{ 
                if (NR > 0) {
                    print umi_sum/NR,count,NR,barcodes
                } else {
                    print 0,0,0,0
                }
            }' 
        )         <( 
            zcat results/experiments/exampleCount/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz | cut -f 2 | sort -u | wc -l 
        ) |         gzip -c > results/experiments/exampleCount/statistic/counts/HEPG2_1_RNA_raw_counts.tsv.gz 2> results/logs/statistic/counts/table.exampleCount.HEPG2_1_RNA_raw.log
        
[Sun Jun 23 16:22:59 2024]
Finished job 49.
18 of 199 steps (9%) done
Select jobs to execute...
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_

[Sun Jun 23 16:22:59 2024]
rule statistic_counts_table:
    input: results/experiments/exampleCount1/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts/HEPG2_3_DNA_raw_counts.tsv.gz
    log: results/logs/statistic/counts/table.exampleCount1.HEPG2_3_DNA_raw.log
    jobid: 91
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/HEPG2_3_DNA_raw_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=3, type=DNA, countType=raw
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "3") <( echo "DNA")         <( 
            zcat results/experiments/exampleCount1/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz |             awk -v OFS='\t' 'BEGIN{
                pbar="NA"
            }{ 
                count += $NF; umi_sum+=$3; if (pbar != $1) { barcodes+=1 }; pbar=$1 
            }END{ 
                if (NR > 0) {
                    print umi_sum/NR,count,NR,barcodes
                } else {
                    print 0,0,0,0
                }
            }' 
        )         <( 
            zcat results/experiments/exampleCount1/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz | cut -f 2 | sort -u | wc -l 
        ) |         gzip -c > results/experiments/exampleCount1/statistic/counts/HEPG2_3_DNA_raw_counts.tsv.gz 2> results/logs/statistic/counts/table.exampleCount1.HEPG2_3_DNA_raw.log
        
Select jobs to execute...
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:22:59 2024]
Finished job 34.
19 of 199 steps (10%) done

[Sun Jun 23 16:22:59 2024]
rule counts_filter_counts:
    input: results/experiments/exampleCount1/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount1/counts/HEPG2_2_DNA_filtered_counts.tsv.gz
    log: results/logs/counts/filter_counts.exampleCount1.HEPG2.2.DNA.log
    jobid: 48
    reason: Missing output files: results/experiments/exampleCount1/counts/HEPG2_2_DNA_filtered_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=2, type=DNA
    resources: tmpdir=/tmp


        bc=15;
        echo $bc;
        zcat results/experiments/exampleCount1/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz | grep -v "N" |         awk -v var="$bc" -v 'OFS=\t' '{ if (length($1) == var) { print } }' |         sort |         gzip -c > results/experiments/exampleCount1/counts/HEPG2_2_DNA_filtered_counts.tsv.gz
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:22:59 2024]
Finished job 68.
20 of 199 steps (10%) done
Select jobs to execute...

[Sun Jun 23 16:22:59 2024]
rule statistic_counts_table:
    input: results/experiments/exampleCount1/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts/HEPG2_2_DNA_raw_counts.tsv.gz
    log: results/logs/statistic/counts/table.exampleCount1.HEPG2_2_DNA_raw.log
    jobid: 89
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/HEPG2_2_DNA_raw_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=2, type=DNA, countType=raw
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "2") <( echo "DNA")         <( 
            zcat results/experiments/exampleCount1/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz |             awk -v OFS='\t' 'BEGIN{
                pbar="NA"
            }{ 
                count += $NF; umi_sum+=$3; if (pbar != $1) { barcodes+=1 }; pbar=$1 
            }END{ 
                if (NR > 0) {
                    print umi_sum/NR,count,NR,barcodes
                } else {
                    print 0,0,0,0
                }
            }' 
        )         <( 
            zcat results/experiments/exampleCount1/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz | cut -f 2 | sort -u | wc -l 
        ) |         gzip -c > results/experiments/exampleCount1/statistic/counts/HEPG2_2_DNA_raw_counts.tsv.gz 2> results/logs/statistic/counts/table.exampleCount1.HEPG2_2_DNA_raw.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:00 2024]
Finished job 64.
21 of 199 steps (11%) done
Select jobs to execute...

[Sun Jun 23 16:23:00 2024]
rule counts_filter_counts:
    input: results/experiments/exampleCount/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount/counts/HEPG2_3_DNA_filtered_counts.tsv.gz
    log: results/logs/counts/filter_counts.exampleCount.HEPG2.3.DNA.log
    jobid: 28
    reason: Missing output files: results/experiments/exampleCount/counts/HEPG2_3_DNA_filtered_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=3, type=DNA
    resources: tmpdir=/tmp


        bc=15;
        echo $bc;
        zcat results/experiments/exampleCount/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz | grep -v "N" |         awk -v var="$bc" -v 'OFS=\t' '{ if (length($1) == var) { print } }' |         sort |         gzip -c > results/experiments/exampleCount/counts/HEPG2_3_DNA_filtered_counts.tsv.gz
        
[Sun Jun 23 16:23:00 2024]
Finished job 91.
22 of 199 steps (11%) done
Select jobs to execute...
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_

[Sun Jun 23 16:23:00 2024]
rule counts_filter_counts:
    input: results/experiments/exampleCount1/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount1/counts/HEPG2_1_DNA_filtered_counts.tsv.gz
    log: results/logs/counts/filter_counts.exampleCount1.HEPG2.1.DNA.log
    jobid: 38
    reason: Missing output files: results/experiments/exampleCount1/counts/HEPG2_1_DNA_filtered_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=1, type=DNA
    resources: tmpdir=/tmp


        bc=15;
        echo $bc;
        zcat results/experiments/exampleCount1/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz | grep -v "N" |         awk -v var="$bc" -v 'OFS=\t' '{ if (length($1) == var) { print } }' |         sort |         gzip -c > results/experiments/exampleCount1/counts/HEPG2_1_DNA_filtered_counts.tsv.gz
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:00 2024]
Finished job 89.
23 of 199 steps (12%) done
Select jobs to execute...

[Sun Jun 23 16:23:00 2024]
rule statistic_counts_BC_in_RNA_DNA:
    input: results/experiments/exampleCount/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz, results/experiments/exampleCount/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts/HEPG2_3_raw_BC_in_RNA_DNA.tsv.gz
    log: results/logs/statistic/counts/BC_in_RNA_DNA.exampleCount.HEPG2_3_raw.log
    jobid: 72
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/HEPG2_3_raw_BC_in_RNA_DNA.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz, results/experiments/exampleCount/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=3, countType=raw
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "3")         <( join <( zcat results/experiments/exampleCount/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz | cut -f 1 | sort | uniq )         <( zcat results/experiments/exampleCount/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz | cut -f 1 | sort | uniq ) | wc -l ) |         gzip -c > results/experiments/exampleCount/statistic/counts/HEPG2_3_raw_BC_in_RNA_DNA.tsv.gz 2> results/logs/statistic/counts/BC_in_RNA_DNA.exampleCount.HEPG2_3_raw.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:00 2024]
Finished job 23.
24 of 199 steps (12%) done
Select jobs to execute...

[Sun Jun 23 16:23:00 2024]
rule statistic_counts_table:
    input: results/experiments/exampleCount/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts/HEPG2_1_DNA_raw_counts.tsv.gz
    log: results/logs/statistic/counts/table.exampleCount.HEPG2_1_DNA_raw.log
    jobid: 63
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/HEPG2_1_DNA_raw_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=1, type=DNA, countType=raw
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "1") <( echo "DNA")         <( 
            zcat results/experiments/exampleCount/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz |             awk -v OFS='\t' 'BEGIN{
                pbar="NA"
            }{ 
                count += $NF; umi_sum+=$3; if (pbar != $1) { barcodes+=1 }; pbar=$1 
            }END{ 
                if (NR > 0) {
                    print umi_sum/NR,count,NR,barcodes
                } else {
                    print 0,0,0,0
                }
            }' 
        )         <( 
            zcat results/experiments/exampleCount/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz | cut -f 2 | sort -u | wc -l 
        ) |         gzip -c > results/experiments/exampleCount/statistic/counts/HEPG2_1_DNA_raw_counts.tsv.gz 2> results/logs/statistic/counts/table.exampleCount.HEPG2_1_DNA_raw.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:00 2024]
Finished job 58.
25 of 199 steps (13%) done
Select jobs to execute...

[Sun Jun 23 16:23:00 2024]
rule statistic_counts_frequent_umis:
    input: results/experiments/exampleCount1/counts/HEPG2_3_DNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_3_DNA.txt
    log: results/logs/statistic/counts/frequent_umis.exampleCount1.HEPG2.3.DNA.log
    jobid: 120
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_3_DNA.txt; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_3_DNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=3, type=DNA
    resources: tmpdir=/tmp


        set +o pipefail;
        zcat results/experiments/exampleCount1/counts/HEPG2_3_DNA_filtered_counts.tsv.gz | cut -f 2 | sort | uniq -c | sort -nr | head > results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_3_DNA.txt 2> results/logs/statistic/counts/frequent_umis.exampleCount1.HEPG2.3.DNA.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:00 2024]
Finished job 3.
26 of 199 steps (13%) done
Select jobs to execute...

[Sun Jun 23 16:23:00 2024]
rule statistic_counts_frequent_umis:
    input: results/experiments/exampleCount/counts/HEPG2_3_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_3_RNA.txt
    log: results/logs/statistic/counts/frequent_umis.exampleCount.HEPG2.3.RNA.log
    jobid: 113
    reason: Missing output files: results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_3_RNA.txt; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_3_RNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=3, type=RNA
    resources: tmpdir=/tmp


        set +o pipefail;
        zcat results/experiments/exampleCount/counts/HEPG2_3_RNA_filtered_counts.tsv.gz | cut -f 2 | sort | uniq -c | sort -nr | head > results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_3_RNA.txt 2> results/logs/statistic/counts/frequent_umis.exampleCount.HEPG2.3.RNA.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:01 2024]
Finished job 48.
27 of 199 steps (14%) done
Select jobs to execute...

[Sun Jun 23 16:23:01 2024]
rule statistic_counts_table:
    input: results/experiments/exampleCount/counts/HEPG2_3_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts/HEPG2_3_RNA_filtered_counts.tsv.gz
    log: results/logs/statistic/counts/table.exampleCount.HEPG2_3_RNA_filtered.log
    jobid: 80
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/HEPG2_3_RNA_filtered_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_3_RNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=3, type=RNA, countType=filtered
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "3") <( echo "RNA")         <( 
            zcat results/experiments/exampleCount/counts/HEPG2_3_RNA_filtered_counts.tsv.gz |             awk -v OFS='\t' 'BEGIN{
                pbar="NA"
            }{ 
                count += $NF; umi_sum+=$3; if (pbar != $1) { barcodes+=1 }; pbar=$1 
            }END{ 
                if (NR > 0) {
                    print umi_sum/NR,count,NR,barcodes
                } else {
                    print 0,0,0,0
                }
            }' 
        )         <( 
            zcat results/experiments/exampleCount/counts/HEPG2_3_RNA_filtered_counts.tsv.gz | cut -f 2 | sort -u | wc -l 
        ) |         gzip -c > results/experiments/exampleCount/statistic/counts/HEPG2_3_RNA_filtered_counts.tsv.gz 2> results/logs/statistic/counts/table.exampleCount.HEPG2_3_RNA_filtered.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:01 2024]
Finished job 72.
28 of 199 steps (14%) done
Select jobs to execute...

[Sun Jun 23 16:23:01 2024]
rule statistic_counts_BC_in_RNA_DNA:
    input: results/experiments/exampleCount1/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz, results/experiments/exampleCount1/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts/HEPG2_1_raw_BC_in_RNA_DNA.tsv.gz
    log: results/logs/statistic/counts/BC_in_RNA_DNA.exampleCount1.HEPG2_1_raw.log
    jobid: 94
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/HEPG2_1_raw_BC_in_RNA_DNA.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz, results/experiments/exampleCount1/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=1, countType=raw
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "1")         <( join <( zcat results/experiments/exampleCount1/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz | cut -f 1 | sort | uniq )         <( zcat results/experiments/exampleCount1/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz | cut -f 1 | sort | uniq ) | wc -l ) |         gzip -c > results/experiments/exampleCount1/statistic/counts/HEPG2_1_raw_BC_in_RNA_DNA.tsv.gz 2> results/logs/statistic/counts/BC_in_RNA_DNA.exampleCount1.HEPG2_1_raw.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:01 2024]
Finished job 28.
29 of 199 steps (15%) done
Select jobs to execute...

[Sun Jun 23 16:23:01 2024]
rule counts_filter_counts:
    input: results/experiments/exampleCount/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount/counts/HEPG2_1_DNA_filtered_counts.tsv.gz
    log: results/logs/counts/filter_counts.exampleCount.HEPG2.1.DNA.log
    jobid: 8
    reason: Missing output files: results/experiments/exampleCount/counts/HEPG2_1_DNA_filtered_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=1, type=DNA
    resources: tmpdir=/tmp


        bc=15;
        echo $bc;
        zcat results/experiments/exampleCount/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz | grep -v "N" |         awk -v var="$bc" -v 'OFS=\t' '{ if (length($1) == var) { print } }' |         sort |         gzip -c > results/experiments/exampleCount/counts/HEPG2_1_DNA_filtered_counts.tsv.gz
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:01 2024]
Finished job 63.
30 of 199 steps (15%) done
Select jobs to execute...

[Sun Jun 23 16:23:01 2024]
rule counts_final_counts:
    input: results/experiments/exampleCount/counts/HEPG2_3_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount/counts/HEPG2_3_RNA_final_counts.tsv.gz
    log: results/logs/counts/final_counts_umi.exampleCount.HEPG2.3.RNA.log
    jobid: 22
    reason: Missing output files: results/experiments/exampleCount/counts/HEPG2_3_RNA_final_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_3_RNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=3, type=RNA
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount/counts/HEPG2_3_RNA_filtered_counts.tsv.gz | awk '{print $1}' |         uniq -c |         awk -v 'OFS=\t' '{ print $2,$1 }' |         gzip -c > results/experiments/exampleCount/counts/HEPG2_3_RNA_final_counts.tsv.gz 2> results/logs/counts/final_counts_umi.exampleCount.HEPG2.3.RNA.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:01 2024]
Finished job 38.
31 of 199 steps (16%) done
Select jobs to execute...

[Sun Jun 23 16:23:01 2024]
rule statistic_counts_table:
    input: results/experiments/exampleCount1/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts/HEPG2_1_DNA_raw_counts.tsv.gz
    log: results/logs/statistic/counts/table.exampleCount1.HEPG2_1_DNA_raw.log
    jobid: 87
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/HEPG2_1_DNA_raw_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=1, type=DNA, countType=raw
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "1") <( echo "DNA")         <( 
            zcat results/experiments/exampleCount1/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz |             awk -v OFS='\t' 'BEGIN{
                pbar="NA"
            }{ 
                count += $NF; umi_sum+=$3; if (pbar != $1) { barcodes+=1 }; pbar=$1 
            }END{ 
                if (NR > 0) {
                    print umi_sum/NR,count,NR,barcodes
                } else {
                    print 0,0,0,0
                }
            }' 
        )         <( 
            zcat results/experiments/exampleCount1/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz | cut -f 2 | sort -u | wc -l 
        ) |         gzip -c > results/experiments/exampleCount1/statistic/counts/HEPG2_1_DNA_raw_counts.tsv.gz 2> results/logs/statistic/counts/table.exampleCount1.HEPG2_1_DNA_raw.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:01 2024]
Finished job 80.
32 of 199 steps (16%) done
Select jobs to execute...

[Sun Jun 23 16:23:01 2024]
rule statistic_counts_frequent_umis:
    input: results/experiments/exampleCount1/counts/HEPG2_1_DNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_1_DNA.txt
    log: results/logs/statistic/counts/frequent_umis.exampleCount1.HEPG2.1.DNA.log
    jobid: 116
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_1_DNA.txt; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_1_DNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=1, type=DNA
    resources: tmpdir=/tmp


        set +o pipefail;
        zcat results/experiments/exampleCount1/counts/HEPG2_1_DNA_filtered_counts.tsv.gz | cut -f 2 | sort | uniq -c | sort -nr | head > results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_1_DNA.txt 2> results/logs/statistic/counts/frequent_umis.exampleCount1.HEPG2.1.DNA.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:02 2024]
Finished job 120.
33 of 199 steps (17%) done
Select jobs to execute...

[Sun Jun 23 16:23:02 2024]
rule statistic_counts_table:
    input: results/experiments/exampleCount1/counts/HEPG2_3_DNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts/HEPG2_3_DNA_filtered_counts.tsv.gz
    log: results/logs/statistic/counts/table.exampleCount1.HEPG2_3_DNA_filtered.log
    jobid: 103
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/HEPG2_3_DNA_filtered_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_3_DNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=3, type=DNA, countType=filtered
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "3") <( echo "DNA")         <( 
            zcat results/experiments/exampleCount1/counts/HEPG2_3_DNA_filtered_counts.tsv.gz |             awk -v OFS='\t' 'BEGIN{
                pbar="NA"
            }{ 
                count += $NF; umi_sum+=$3; if (pbar != $1) { barcodes+=1 }; pbar=$1 
            }END{ 
                if (NR > 0) {
                    print umi_sum/NR,count,NR,barcodes
                } else {
                    print 0,0,0,0
                }
            }' 
        )         <( 
            zcat results/experiments/exampleCount1/counts/HEPG2_3_DNA_filtered_counts.tsv.gz | cut -f 2 | sort -u | wc -l 
        ) |         gzip -c > results/experiments/exampleCount1/statistic/counts/HEPG2_3_DNA_filtered_counts.tsv.gz 2> results/logs/statistic/counts/table.exampleCount1.HEPG2_3_DNA_filtered.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:02 2024]
Finished job 113.
34 of 199 steps (17%) done
Select jobs to execute...

[Sun Jun 23 16:23:02 2024]
rule counts_filter_counts:
    input: results/experiments/exampleCount1/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount1/counts/HEPG2_1_RNA_filtered_counts.tsv.gz
    log: results/logs/counts/filter_counts.exampleCount1.HEPG2.1.RNA.log
    jobid: 33
    reason: Missing output files: results/experiments/exampleCount1/counts/HEPG2_1_RNA_filtered_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=1, type=RNA
    resources: tmpdir=/tmp


        bc=15;
        echo $bc;
        zcat results/experiments/exampleCount1/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz | grep -v "N" |         awk -v var="$bc" -v 'OFS=\t' '{ if (length($1) == var) { print } }' |         sort |         gzip -c > results/experiments/exampleCount1/counts/HEPG2_1_RNA_filtered_counts.tsv.gz
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:02 2024]
Finished job 94.
35 of 199 steps (18%) done
Select jobs to execute...

[Sun Jun 23 16:23:02 2024]
rule statistic_counts_table:
    input: results/experiments/exampleCount1/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts/HEPG2_1_RNA_raw_counts.tsv.gz
    log: results/logs/statistic/counts/table.exampleCount1.HEPG2_1_RNA_raw.log
    jobid: 88
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/HEPG2_1_RNA_raw_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=1, type=RNA, countType=raw
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "1") <( echo "RNA")         <( 
            zcat results/experiments/exampleCount1/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz |             awk -v OFS='\t' 'BEGIN{
                pbar="NA"
            }{ 
                count += $NF; umi_sum+=$3; if (pbar != $1) { barcodes+=1 }; pbar=$1 
            }END{ 
                if (NR > 0) {
                    print umi_sum/NR,count,NR,barcodes
                } else {
                    print 0,0,0,0
                }
            }' 
        )         <( 
            zcat results/experiments/exampleCount1/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz | cut -f 2 | sort -u | wc -l 
        ) |         gzip -c > results/experiments/exampleCount1/statistic/counts/HEPG2_1_RNA_raw_counts.tsv.gz 2> results/logs/statistic/counts/table.exampleCount1.HEPG2_1_RNA_raw.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:02 2024]
Finished job 22.
36 of 199 steps (18%) done
Select jobs to execute...

[Sun Jun 23 16:23:02 2024]
rule statistic_counts_table:
    input: results/experiments/exampleCount/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts/HEPG2_3_DNA_raw_counts.tsv.gz
    log: results/logs/statistic/counts/table.exampleCount.HEPG2_3_DNA_raw.log
    jobid: 67
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/HEPG2_3_DNA_raw_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=3, type=DNA, countType=raw
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "3") <( echo "DNA")         <( 
            zcat results/experiments/exampleCount/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz |             awk -v OFS='\t' 'BEGIN{
                pbar="NA"
            }{ 
                count += $NF; umi_sum+=$3; if (pbar != $1) { barcodes+=1 }; pbar=$1 
            }END{ 
                if (NR > 0) {
                    print umi_sum/NR,count,NR,barcodes
                } else {
                    print 0,0,0,0
                }
            }' 
        )         <( 
            zcat results/experiments/exampleCount/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz | cut -f 2 | sort -u | wc -l 
        ) |         gzip -c > results/experiments/exampleCount/statistic/counts/HEPG2_3_DNA_raw_counts.tsv.gz 2> results/logs/statistic/counts/table.exampleCount.HEPG2_3_DNA_raw.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:02 2024]
Finished job 87.
37 of 199 steps (19%) done
Select jobs to execute...

[Sun Jun 23 16:23:02 2024]
rule statistic_counts_frequent_umis:
    input: results/experiments/exampleCount1/counts/HEPG2_2_DNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_2_DNA.txt
    log: results/logs/statistic/counts/frequent_umis.exampleCount1.HEPG2.2.DNA.log
    jobid: 118
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_2_DNA.txt; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_2_DNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=2, type=DNA
    resources: tmpdir=/tmp


        set +o pipefail;
        zcat results/experiments/exampleCount1/counts/HEPG2_2_DNA_filtered_counts.tsv.gz | cut -f 2 | sort | uniq -c | sort -nr | head > results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_2_DNA.txt 2> results/logs/statistic/counts/frequent_umis.exampleCount1.HEPG2.2.DNA.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:02 2024]
Finished job 103.
38 of 199 steps (19%) done
Select jobs to execute...

[Sun Jun 23 16:23:03 2024]
rule counts_final_counts:
    input: results/experiments/exampleCount1/counts/HEPG2_1_DNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount1/counts/HEPG2_1_DNA_final_counts.tsv.gz
    log: results/logs/counts/final_counts_umi.exampleCount1.HEPG2.1.DNA.log
    jobid: 37
    reason: Missing output files: results/experiments/exampleCount1/counts/HEPG2_1_DNA_final_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_1_DNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=1, type=DNA
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount1/counts/HEPG2_1_DNA_filtered_counts.tsv.gz | awk '{print $1}' |         uniq -c |         awk -v 'OFS=\t' '{ print $2,$1 }' |         gzip -c > results/experiments/exampleCount1/counts/HEPG2_1_DNA_final_counts.tsv.gz 2> results/logs/counts/final_counts_umi.exampleCount1.HEPG2.1.DNA.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:03 2024]
Finished job 88.
39 of 199 steps (20%) done
Select jobs to execute...

[Sun Jun 23 16:23:03 2024]
rule assigned_counts_assignBarcodes:
    input: results/experiments/exampleCount/counts/HEPG2_3_RNA_final_counts.tsv.gz, results/experiments/exampleCount/assignment/fromFile.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_BC_and_assignment.py
    output: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3_RNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_3_RNA_exampleConfig.statistic.tsv.gz
    log: results/logs/assigned_counts/assignBarcodes.exampleCount.HEPG2.3.RNA.exampleConfig.fromFile.log
    jobid: 143
    reason: Missing output files: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3_RNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_3_RNA_exampleConfig.statistic.tsv.gz; Input files updated by another job: results/experiments/exampleCount/assignment/fromFile.tsv.gz, results/experiments/exampleCount/counts/HEPG2_3_RNA_final_counts.tsv.gz
    wildcards: project=exampleCount, assignment=fromFile, condition=HEPG2, replicate=3, type=RNA, config=exampleConfig
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_BC_and_assignment.py --counts results/experiments/exampleCount/counts/HEPG2_3_RNA_final_counts.tsv.gz         --assignment results/experiments/exampleCount/assignment/fromFile.tsv.gz         --output results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3_RNA_final_counts.config.exampleConfig.tsv.gz         --statistic results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_3_RNA_exampleConfig.statistic.tsv.gz         --name HEPG2_3_RNA &> results/logs/assigned_counts/assignBarcodes.exampleCount.HEPG2.3.RNA.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:03 2024]
Finished job 116.
40 of 199 steps (20%) done
Select jobs to execute...

[Sun Jun 23 16:23:03 2024]
rule statistic_counts_frequent_umis:
    input: results/experiments/exampleCount/counts/HEPG2_3_DNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_3_DNA.txt
    log: results/logs/statistic/counts/frequent_umis.exampleCount.HEPG2.3.DNA.log
    jobid: 114
    reason: Missing output files: results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_3_DNA.txt; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_3_DNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=3, type=DNA
    resources: tmpdir=/tmp


        set +o pipefail;
        zcat results/experiments/exampleCount/counts/HEPG2_3_DNA_filtered_counts.tsv.gz | cut -f 2 | sort | uniq -c | sort -nr | head > results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_3_DNA.txt 2> results/logs/statistic/counts/frequent_umis.exampleCount.HEPG2.3.DNA.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:03 2024]
Finished job 67.
41 of 199 steps (21%) done
Select jobs to execute...

[Sun Jun 23 16:23:03 2024]
rule statistic_counts_table:
    input: results/experiments/exampleCount/counts/HEPG2_1_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts/HEPG2_1_RNA_filtered_counts.tsv.gz
    log: results/logs/statistic/counts/table.exampleCount.HEPG2_1_RNA_filtered.log
    jobid: 76
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/HEPG2_1_RNA_filtered_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_1_RNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=1, type=RNA, countType=filtered
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "1") <( echo "RNA")         <( 
            zcat results/experiments/exampleCount/counts/HEPG2_1_RNA_filtered_counts.tsv.gz |             awk -v OFS='\t' 'BEGIN{
                pbar="NA"
            }{ 
                count += $NF; umi_sum+=$3; if (pbar != $1) { barcodes+=1 }; pbar=$1 
            }END{ 
                if (NR > 0) {
                    print umi_sum/NR,count,NR,barcodes
                } else {
                    print 0,0,0,0
                }
            }' 
        )         <( 
            zcat results/experiments/exampleCount/counts/HEPG2_1_RNA_filtered_counts.tsv.gz | cut -f 2 | sort -u | wc -l 
        ) |         gzip -c > results/experiments/exampleCount/statistic/counts/HEPG2_1_RNA_filtered_counts.tsv.gz 2> results/logs/statistic/counts/table.exampleCount.HEPG2_1_RNA_filtered.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:03 2024]
Finished job 8.
42 of 199 steps (21%) done
Select jobs to execute...

[Sun Jun 23 16:23:03 2024]
rule statistic_counts_table:
    input: results/experiments/exampleCount1/counts/HEPG2_1_DNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts/HEPG2_1_DNA_filtered_counts.tsv.gz
    log: results/logs/statistic/counts/table.exampleCount1.HEPG2_1_DNA_filtered.log
    jobid: 99
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/HEPG2_1_DNA_filtered_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_1_DNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=1, type=DNA, countType=filtered
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "1") <( echo "DNA")         <( 
            zcat results/experiments/exampleCount1/counts/HEPG2_1_DNA_filtered_counts.tsv.gz |             awk -v OFS='\t' 'BEGIN{
                pbar="NA"
            }{ 
                count += $NF; umi_sum+=$3; if (pbar != $1) { barcodes+=1 }; pbar=$1 
            }END{ 
                if (NR > 0) {
                    print umi_sum/NR,count,NR,barcodes
                } else {
                    print 0,0,0,0
                }
            }' 
        )         <( 
            zcat results/experiments/exampleCount1/counts/HEPG2_1_DNA_filtered_counts.tsv.gz | cut -f 2 | sort -u | wc -l 
        ) |         gzip -c > results/experiments/exampleCount1/statistic/counts/HEPG2_1_DNA_filtered_counts.tsv.gz 2> results/logs/statistic/counts/table.exampleCount1.HEPG2_1_DNA_filtered.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:03 2024]
Finished job 19.
43 of 199 steps (22%) done
Select jobs to execute...

[Sun Jun 23 16:23:03 2024]
rule counts_final_counts:
    input: results/experiments/exampleCount1/counts/HEPG2_3_DNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount1/counts/HEPG2_3_DNA_final_counts.tsv.gz
    log: results/logs/counts/final_counts_umi.exampleCount1.HEPG2.3.DNA.log
    jobid: 57
    reason: Missing output files: results/experiments/exampleCount1/counts/HEPG2_3_DNA_final_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_3_DNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=3, type=DNA
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount1/counts/HEPG2_3_DNA_filtered_counts.tsv.gz | awk '{print $1}' |         uniq -c |         awk -v 'OFS=\t' '{ print $2,$1 }' |         gzip -c > results/experiments/exampleCount1/counts/HEPG2_3_DNA_final_counts.tsv.gz 2> results/logs/counts/final_counts_umi.exampleCount1.HEPG2.3.DNA.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:03 2024]
Finished job 37.
44 of 199 steps (22%) done
Select jobs to execute...

[Sun Jun 23 16:23:03 2024]
rule statistic_counts_table:
    input: results/experiments/exampleCount/counts/HEPG2_1_DNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts/HEPG2_1_DNA_filtered_counts.tsv.gz
    log: results/logs/statistic/counts/table.exampleCount.HEPG2_1_DNA_filtered.log
    jobid: 75
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/HEPG2_1_DNA_filtered_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_1_DNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=1, type=DNA, countType=filtered
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "1") <( echo "DNA")         <( 
            zcat results/experiments/exampleCount/counts/HEPG2_1_DNA_filtered_counts.tsv.gz |             awk -v OFS='\t' 'BEGIN{
                pbar="NA"
            }{ 
                count += $NF; umi_sum+=$3; if (pbar != $1) { barcodes+=1 }; pbar=$1 
            }END{ 
                if (NR > 0) {
                    print umi_sum/NR,count,NR,barcodes
                } else {
                    print 0,0,0,0
                }
            }' 
        )         <( 
            zcat results/experiments/exampleCount/counts/HEPG2_1_DNA_filtered_counts.tsv.gz | cut -f 2 | sort -u | wc -l 
        ) |         gzip -c > results/experiments/exampleCount/statistic/counts/HEPG2_1_DNA_filtered_counts.tsv.gz 2> results/logs/statistic/counts/table.exampleCount.HEPG2_1_DNA_filtered.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:03 2024]
Finished job 33.
45 of 199 steps (23%) done
Select jobs to execute...

[Sun Jun 23 16:23:03 2024]
rule statistic_counts_frequent_umis:
    input: results/experiments/exampleCount1/counts/HEPG2_1_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_1_RNA.txt
    log: results/logs/statistic/counts/frequent_umis.exampleCount1.HEPG2.1.RNA.log
    jobid: 115
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_1_RNA.txt; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_1_RNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=1, type=RNA
    resources: tmpdir=/tmp


        set +o pipefail;
        zcat results/experiments/exampleCount1/counts/HEPG2_1_RNA_filtered_counts.tsv.gz | cut -f 2 | sort | uniq -c | sort -nr | head > results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_1_RNA.txt 2> results/logs/statistic/counts/frequent_umis.exampleCount1.HEPG2.1.RNA.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:03 2024]
Finished job 118.
46 of 199 steps (23%) done
Select jobs to execute...

[Sun Jun 23 16:23:04 2024]
rule statistic_counts_BC_in_RNA_DNA:
    input: results/experiments/exampleCount1/counts/HEPG2_1_DNA_filtered_counts.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_1_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts/HEPG2_1_filtered_BC_in_RNA_DNA.tsv.gz
    log: results/logs/statistic/counts/BC_in_RNA_DNA.exampleCount1.HEPG2_1_filtered.log
    jobid: 106
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/HEPG2_1_filtered_BC_in_RNA_DNA.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_1_RNA_filtered_counts.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_1_DNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=1, countType=filtered
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "1")         <( join <( zcat results/experiments/exampleCount1/counts/HEPG2_1_DNA_filtered_counts.tsv.gz | cut -f 1 | sort | uniq )         <( zcat results/experiments/exampleCount1/counts/HEPG2_1_RNA_filtered_counts.tsv.gz | cut -f 1 | sort | uniq ) | wc -l ) |         gzip -c > results/experiments/exampleCount1/statistic/counts/HEPG2_1_filtered_BC_in_RNA_DNA.tsv.gz 2> results/logs/statistic/counts/BC_in_RNA_DNA.exampleCount1.HEPG2_1_filtered.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:04 2024]
Finished job 76.
47 of 199 steps (24%) done
Select jobs to execute...

[Sun Jun 23 16:23:04 2024]
rule statistic_counts_barcode_base_composition:
    input: results/experiments/exampleCount1/counts/HEPG2_1_DNA_final_counts.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/nucleotideCountPerPosition.py
    output: results/experiments/exampleCount1/counts/HEPG2_1_DNA_final.BC.tsv.gz, results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_1_DNA.tsv.gz
    log: results/logs/statistic/counts/barcode_base_composition.exampleCount1.HEPG2_1_DNA.log
    jobid: 36
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_1_DNA.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_1_DNA_final_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=1, type=DNA
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount1/counts/HEPG2_1_DNA_final_counts.tsv.gz | awk '{print $1}' | gzip -c > results/experiments/exampleCount1/counts/HEPG2_1_DNA_final.BC.tsv.gz;
        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/nucleotideCountPerPosition.py         --column 1         --chunksize 100000         --input results/experiments/exampleCount1/counts/HEPG2_1_DNA_final.BC.tsv.gz         --output results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_1_DNA.tsv.gz &> results/logs/statistic/counts/barcode_base_composition.exampleCount1.HEPG2_1_DNA.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:04 2024]
Finished job 99.
48 of 199 steps (24%) done
Select jobs to execute...

[Sun Jun 23 16:23:04 2024]
rule counts_final_counts:
    input: results/experiments/exampleCount/counts/HEPG2_1_DNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount/counts/HEPG2_1_DNA_final_counts.tsv.gz
    log: results/logs/counts/final_counts_umi.exampleCount.HEPG2.1.DNA.log
    jobid: 7
    reason: Missing output files: results/experiments/exampleCount/counts/HEPG2_1_DNA_final_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_1_DNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=1, type=DNA
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount/counts/HEPG2_1_DNA_filtered_counts.tsv.gz | awk '{print $1}' |         uniq -c |         awk -v 'OFS=\t' '{ print $2,$1 }' |         gzip -c > results/experiments/exampleCount/counts/HEPG2_1_DNA_final_counts.tsv.gz 2> results/logs/counts/final_counts_umi.exampleCount.HEPG2.1.DNA.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:04 2024]
Finished job 57.
49 of 199 steps (25%) done
Select jobs to execute...

[Sun Jun 23 16:23:04 2024]
rule statistic_counts_frequent_umis:
    input: results/experiments/exampleCount/counts/HEPG2_1_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_1_RNA.txt
    log: results/logs/statistic/counts/frequent_umis.exampleCount.HEPG2.1.RNA.log
    jobid: 109
    reason: Missing output files: results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_1_RNA.txt; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_1_RNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=1, type=RNA
    resources: tmpdir=/tmp


        set +o pipefail;
        zcat results/experiments/exampleCount/counts/HEPG2_1_RNA_filtered_counts.tsv.gz | cut -f 2 | sort | uniq -c | sort -nr | head > results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_1_RNA.txt 2> results/logs/statistic/counts/frequent_umis.exampleCount.HEPG2.1.RNA.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:04 2024]
Finished job 114.
50 of 199 steps (25%) done
Select jobs to execute...

[Sun Jun 23 16:23:04 2024]
rule counts_final_counts:
    input: results/experiments/exampleCount1/counts/HEPG2_2_DNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount1/counts/HEPG2_2_DNA_final_counts.tsv.gz
    log: results/logs/counts/final_counts_umi.exampleCount1.HEPG2.2.DNA.log
    jobid: 47
    reason: Missing output files: results/experiments/exampleCount1/counts/HEPG2_2_DNA_final_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_2_DNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=2, type=DNA
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount1/counts/HEPG2_2_DNA_filtered_counts.tsv.gz | awk '{print $1}' |         uniq -c |         awk -v 'OFS=\t' '{ print $2,$1 }' |         gzip -c > results/experiments/exampleCount1/counts/HEPG2_2_DNA_final_counts.tsv.gz 2> results/logs/counts/final_counts_umi.exampleCount1.HEPG2.2.DNA.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:04 2024]
Finished job 75.
51 of 199 steps (26%) done
Select jobs to execute...

[Sun Jun 23 16:23:04 2024]
rule statistic_counts_BC_in_RNA_DNA:
    input: results/experiments/exampleCount/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz, results/experiments/exampleCount/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts/HEPG2_1_raw_BC_in_RNA_DNA.tsv.gz
    log: results/logs/statistic/counts/BC_in_RNA_DNA.exampleCount.HEPG2_1_raw.log
    jobid: 70
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/HEPG2_1_raw_BC_in_RNA_DNA.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz, results/experiments/exampleCount/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=1, countType=raw
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "1")         <( join <( zcat results/experiments/exampleCount/counts/useUMI.HEPG2_1_DNA_raw_counts.tsv.gz | cut -f 1 | sort | uniq )         <( zcat results/experiments/exampleCount/counts/useUMI.HEPG2_1_RNA_raw_counts.tsv.gz | cut -f 1 | sort | uniq ) | wc -l ) |         gzip -c > results/experiments/exampleCount/statistic/counts/HEPG2_1_raw_BC_in_RNA_DNA.tsv.gz 2> results/logs/statistic/counts/BC_in_RNA_DNA.exampleCount.HEPG2_1_raw.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:04 2024]
Finished job 106.
52 of 199 steps (26%) done
Select jobs to execute...

[Sun Jun 23 16:23:04 2024]
rule statistic_counts_BC_in_RNA_DNA:
    input: results/experiments/exampleCount/counts/HEPG2_1_DNA_filtered_counts.tsv.gz, results/experiments/exampleCount/counts/HEPG2_1_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts/HEPG2_1_filtered_BC_in_RNA_DNA.tsv.gz
    log: results/logs/statistic/counts/BC_in_RNA_DNA.exampleCount.HEPG2_1_filtered.log
    jobid: 82
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/HEPG2_1_filtered_BC_in_RNA_DNA.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_1_DNA_filtered_counts.tsv.gz, results/experiments/exampleCount/counts/HEPG2_1_RNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=1, countType=filtered
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "1")         <( join <( zcat results/experiments/exampleCount/counts/HEPG2_1_DNA_filtered_counts.tsv.gz | cut -f 1 | sort | uniq )         <( zcat results/experiments/exampleCount/counts/HEPG2_1_RNA_filtered_counts.tsv.gz | cut -f 1 | sort | uniq ) | wc -l ) |         gzip -c > results/experiments/exampleCount/statistic/counts/HEPG2_1_filtered_BC_in_RNA_DNA.tsv.gz 2> results/logs/statistic/counts/BC_in_RNA_DNA.exampleCount.HEPG2_1_filtered.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:04 2024]
Finished job 7.
53 of 199 steps (27%) done
Select jobs to execute...

[Sun Jun 23 16:23:05 2024]
rule assigned_counts_assignBarcodes:
    input: results/experiments/exampleCount/counts/HEPG2_1_DNA_final_counts.tsv.gz, results/experiments/exampleCount/assignment/fromFile.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_BC_and_assignment.py
    output: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_1_DNA_exampleConfig.statistic.tsv.gz
    log: results/logs/assigned_counts/assignBarcodes.exampleCount.HEPG2.1.DNA.exampleConfig.fromFile.log
    jobid: 135
    reason: Missing output files: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_1_DNA_exampleConfig.statistic.tsv.gz; Input files updated by another job: results/experiments/exampleCount/assignment/fromFile.tsv.gz, results/experiments/exampleCount/counts/HEPG2_1_DNA_final_counts.tsv.gz
    wildcards: project=exampleCount, assignment=fromFile, condition=HEPG2, replicate=1, type=DNA, config=exampleConfig
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_BC_and_assignment.py --counts results/experiments/exampleCount/counts/HEPG2_1_DNA_final_counts.tsv.gz         --assignment results/experiments/exampleCount/assignment/fromFile.tsv.gz         --output results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1_DNA_final_counts.config.exampleConfig.tsv.gz         --statistic results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_1_DNA_exampleConfig.statistic.tsv.gz         --name HEPG2_1_DNA &> results/logs/assigned_counts/assignBarcodes.exampleCount.HEPG2.1.DNA.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:05 2024]
Finished job 115.
54 of 199 steps (27%) done
Select jobs to execute...

[Sun Jun 23 16:23:05 2024]
rule assigned_counts_assignBarcodes:
    input: results/experiments/exampleCount1/counts/HEPG2_3_DNA_final_counts.tsv.gz, results/experiments/exampleCount1/assignment/fromFile.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_BC_and_assignment.py
    output: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_3_DNA_exampleConfig.statistic.tsv.gz
    log: results/logs/assigned_counts/assignBarcodes.exampleCount1.HEPG2.3.DNA.exampleConfig.fromFile.log
    jobid: 153
    reason: Missing output files: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_3_DNA_exampleConfig.statistic.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/assignment/fromFile.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_3_DNA_final_counts.tsv.gz
    wildcards: project=exampleCount1, assignment=fromFile, condition=HEPG2, replicate=3, type=DNA, config=exampleConfig
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_BC_and_assignment.py --counts results/experiments/exampleCount1/counts/HEPG2_3_DNA_final_counts.tsv.gz         --assignment results/experiments/exampleCount1/assignment/fromFile.tsv.gz         --output results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3_DNA_final_counts.config.exampleConfig.tsv.gz         --statistic results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_3_DNA_exampleConfig.statistic.tsv.gz         --name HEPG2_3_DNA &> results/logs/assigned_counts/assignBarcodes.exampleCount1.HEPG2.3.DNA.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:05 2024]
Finished job 70.
55 of 199 steps (28%) done
Select jobs to execute...

[Sun Jun 23 16:23:05 2024]
rule statistic_counts_barcode_base_composition:
    input: results/experiments/exampleCount1/counts/HEPG2_3_DNA_final_counts.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/nucleotideCountPerPosition.py
    output: results/experiments/exampleCount1/counts/HEPG2_3_DNA_final.BC.tsv.gz, results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_3_DNA.tsv.gz
    log: results/logs/statistic/counts/barcode_base_composition.exampleCount1.HEPG2_3_DNA.log
    jobid: 56
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_3_DNA.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_3_DNA_final_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=3, type=DNA
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount1/counts/HEPG2_3_DNA_final_counts.tsv.gz | awk '{print $1}' | gzip -c > results/experiments/exampleCount1/counts/HEPG2_3_DNA_final.BC.tsv.gz;
        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/nucleotideCountPerPosition.py         --column 1         --chunksize 100000         --input results/experiments/exampleCount1/counts/HEPG2_3_DNA_final.BC.tsv.gz         --output results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_3_DNA.tsv.gz &> results/logs/statistic/counts/barcode_base_composition.exampleCount1.HEPG2_3_DNA.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:05 2024]
Finished job 47.
56 of 199 steps (28%) done
Select jobs to execute...

[Sun Jun 23 16:23:05 2024]
rule assigned_counts_assignBarcodes:
    input: results/experiments/exampleCount1/counts/HEPG2_2_DNA_final_counts.tsv.gz, results/experiments/exampleCount1/assignment/fromFile.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_BC_and_assignment.py
    output: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_2_DNA_exampleConfig.statistic.tsv.gz
    log: results/logs/assigned_counts/assignBarcodes.exampleCount1.HEPG2.2.DNA.exampleConfig.fromFile.log
    jobid: 150
    reason: Missing output files: results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_2_DNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2_DNA_final_counts.config.exampleConfig.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_2_DNA_final_counts.tsv.gz, results/experiments/exampleCount1/assignment/fromFile.tsv.gz
    wildcards: project=exampleCount1, assignment=fromFile, condition=HEPG2, replicate=2, type=DNA, config=exampleConfig
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_BC_and_assignment.py --counts results/experiments/exampleCount1/counts/HEPG2_2_DNA_final_counts.tsv.gz         --assignment results/experiments/exampleCount1/assignment/fromFile.tsv.gz         --output results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2_DNA_final_counts.config.exampleConfig.tsv.gz         --statistic results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_2_DNA_exampleConfig.statistic.tsv.gz         --name HEPG2_2_DNA &> results/logs/assigned_counts/assignBarcodes.exampleCount1.HEPG2.2.DNA.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:05 2024]
Finished job 82.
57 of 199 steps (29%) done
Select jobs to execute...

[Sun Jun 23 16:23:05 2024]
rule statistic_counts_frequent_umis:
    input: results/experiments/exampleCount/counts/HEPG2_1_DNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_1_DNA.txt
    log: results/logs/statistic/counts/frequent_umis.exampleCount.HEPG2.1.DNA.log
    jobid: 110
    reason: Missing output files: results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_1_DNA.txt; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_1_DNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=1, type=DNA
    resources: tmpdir=/tmp


        set +o pipefail;
        zcat results/experiments/exampleCount/counts/HEPG2_1_DNA_filtered_counts.tsv.gz | cut -f 2 | sort | uniq -c | sort -nr | head > results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_1_DNA.txt 2> results/logs/statistic/counts/frequent_umis.exampleCount.HEPG2.1.DNA.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:05 2024]
Finished job 109.
58 of 199 steps (29%) done
Select jobs to execute...

[Sun Jun 23 16:23:05 2024]
rule statistic_counts_barcode_base_composition:
    input: results/experiments/exampleCount1/counts/HEPG2_2_DNA_final_counts.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/nucleotideCountPerPosition.py
    output: results/experiments/exampleCount1/counts/HEPG2_2_DNA_final.BC.tsv.gz, results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_2_DNA.tsv.gz
    log: results/logs/statistic/counts/barcode_base_composition.exampleCount1.HEPG2_2_DNA.log
    jobid: 46
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_2_DNA.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_2_DNA_final_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=2, type=DNA
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount1/counts/HEPG2_2_DNA_final_counts.tsv.gz | awk '{print $1}' | gzip -c > results/experiments/exampleCount1/counts/HEPG2_2_DNA_final.BC.tsv.gz;
        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/nucleotideCountPerPosition.py         --column 1         --chunksize 100000         --input results/experiments/exampleCount1/counts/HEPG2_2_DNA_final.BC.tsv.gz         --output results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_2_DNA.tsv.gz &> results/logs/statistic/counts/barcode_base_composition.exampleCount1.HEPG2_2_DNA.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:06 2024]
Finished job 110.
59 of 199 steps (30%) done
Select jobs to execute...

[Sun Jun 23 16:23:06 2024]
rule statistic_counts_BC_in_RNA_DNA:
    input: results/experiments/exampleCount/counts/HEPG2_3_DNA_filtered_counts.tsv.gz, results/experiments/exampleCount/counts/HEPG2_3_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts/HEPG2_3_filtered_BC_in_RNA_DNA.tsv.gz
    log: results/logs/statistic/counts/BC_in_RNA_DNA.exampleCount.HEPG2_3_filtered.log
    jobid: 84
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/HEPG2_3_filtered_BC_in_RNA_DNA.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_3_DNA_filtered_counts.tsv.gz, results/experiments/exampleCount/counts/HEPG2_3_RNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=3, countType=filtered
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "3")         <( join <( zcat results/experiments/exampleCount/counts/HEPG2_3_DNA_filtered_counts.tsv.gz | cut -f 1 | sort | uniq )         <( zcat results/experiments/exampleCount/counts/HEPG2_3_RNA_filtered_counts.tsv.gz | cut -f 1 | sort | uniq ) | wc -l ) |         gzip -c > results/experiments/exampleCount/statistic/counts/HEPG2_3_filtered_BC_in_RNA_DNA.tsv.gz 2> results/logs/statistic/counts/BC_in_RNA_DNA.exampleCount.HEPG2_3_filtered.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:07 2024]
Finished job 84.
60 of 199 steps (30%) done
Select jobs to execute...

[Sun Jun 23 16:23:07 2024]
rule assigned_counts_assignBarcodes:
    input: results/experiments/exampleCount1/counts/HEPG2_1_DNA_final_counts.tsv.gz, results/experiments/exampleCount1/assignment/fromFile.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_BC_and_assignment.py
    output: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_1_DNA_exampleConfig.statistic.tsv.gz
    log: results/logs/assigned_counts/assignBarcodes.exampleCount1.HEPG2.1.DNA.exampleConfig.fromFile.log
    jobid: 146
    reason: Missing output files: results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_1_DNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1_DNA_final_counts.config.exampleConfig.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/assignment/fromFile.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_1_DNA_final_counts.tsv.gz
    wildcards: project=exampleCount1, assignment=fromFile, condition=HEPG2, replicate=1, type=DNA, config=exampleConfig
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_BC_and_assignment.py --counts results/experiments/exampleCount1/counts/HEPG2_1_DNA_final_counts.tsv.gz         --assignment results/experiments/exampleCount1/assignment/fromFile.tsv.gz         --output results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1_DNA_final_counts.config.exampleConfig.tsv.gz         --statistic results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_1_DNA_exampleConfig.statistic.tsv.gz         --name HEPG2_1_DNA &> results/logs/assigned_counts/assignBarcodes.exampleCount1.HEPG2.1.DNA.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:08 2024]
Finished job 45.
61 of 199 steps (31%) done
Select jobs to execute...

[Sun Jun 23 16:23:08 2024]
rule counts_umi_raw_counts:
    input: results/experiments/exampleCount1/counts/useUMI.HEPG2_2_RNA.bam
    output: results/experiments/exampleCount1/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz
    log: results/logs/counts/umi/raw_counts.exampleCount1.HEPG2.2.RNA.log
    jobid: 44
    reason: Missing output files: results/experiments/exampleCount1/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/useUMI.HEPG2_2_RNA.bam
    wildcards: project=exampleCount1, condition=HEPG2, replicate=2, type=RNA
    resources: tmpdir=/tmp


        samtools view -F 1 -r HEPG2_2_RNA results/experiments/exampleCount1/counts/useUMI.HEPG2_2_RNA.bam |         awk -v 'OFS=\t' '{ for (i=12; i<=NF; i++) {
          if ($i ~ /^XJ:Z:/) print $10,substr($i,6,10)
        }}' |         sort | uniq -c |         awk -v 'OFS=\t' '{ print $2,$3,$1 }' |         gzip -c > results/experiments/exampleCount1/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz 2> results/logs/counts/umi/raw_counts.exampleCount1.HEPG2.2.RNA.log
        
Activating conda environment: .snakemake/conda/9030bacf18a7682e51f4bb53f8e2c2d9_
[Sun Jun 23 16:23:11 2024]
Finished job 55.
62 of 199 steps (31%) done
Select jobs to execute...

[Sun Jun 23 16:23:11 2024]
rule counts_umi_raw_counts:
    input: results/experiments/exampleCount1/counts/useUMI.HEPG2_3_RNA.bam
    output: results/experiments/exampleCount1/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz
    log: results/logs/counts/umi/raw_counts.exampleCount1.HEPG2.3.RNA.log
    jobid: 54
    reason: Missing output files: results/experiments/exampleCount1/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/useUMI.HEPG2_3_RNA.bam
    wildcards: project=exampleCount1, condition=HEPG2, replicate=3, type=RNA
    resources: tmpdir=/tmp


        samtools view -F 1 -r HEPG2_3_RNA results/experiments/exampleCount1/counts/useUMI.HEPG2_3_RNA.bam |         awk -v 'OFS=\t' '{ for (i=12; i<=NF; i++) {
          if ($i ~ /^XJ:Z:/) print $10,substr($i,6,10)
        }}' |         sort | uniq -c |         awk -v 'OFS=\t' '{ print $2,$3,$1 }' |         gzip -c > results/experiments/exampleCount1/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz 2> results/logs/counts/umi/raw_counts.exampleCount1.HEPG2.3.RNA.log
        
Activating conda environment: .snakemake/conda/9030bacf18a7682e51f4bb53f8e2c2d9_
[Sun Jun 23 16:23:13 2024]
Finished job 44.
63 of 199 steps (32%) done
Select jobs to execute...

[Sun Jun 23 16:23:13 2024]
rule statistic_counts_barcode_base_composition:
    input: results/experiments/exampleCount/counts/HEPG2_3_RNA_final_counts.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/nucleotideCountPerPosition.py
    output: results/experiments/exampleCount/counts/HEPG2_3_RNA_final.BC.tsv.gz, results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_3_RNA.tsv.gz
    log: results/logs/statistic/counts/barcode_base_composition.exampleCount.HEPG2_3_RNA.log
    jobid: 21
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_3_RNA.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_3_RNA_final_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=3, type=RNA
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount/counts/HEPG2_3_RNA_final_counts.tsv.gz | awk '{print $1}' | gzip -c > results/experiments/exampleCount/counts/HEPG2_3_RNA_final.BC.tsv.gz;
        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/nucleotideCountPerPosition.py         --column 1         --chunksize 100000         --input results/experiments/exampleCount/counts/HEPG2_3_RNA_final.BC.tsv.gz         --output results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_3_RNA.tsv.gz &> results/logs/statistic/counts/barcode_base_composition.exampleCount.HEPG2_3_RNA.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:15 2024]
Finished job 143.
64 of 199 steps (32%) done
Select jobs to execute...

[Sun Jun 23 16:23:15 2024]
rule statistic_counts_BC_in_RNA_DNA:
    input: results/experiments/exampleCount1/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz, results/experiments/exampleCount1/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts/HEPG2_2_raw_BC_in_RNA_DNA.tsv.gz
    log: results/logs/statistic/counts/BC_in_RNA_DNA.exampleCount1.HEPG2_2_raw.log
    jobid: 95
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/HEPG2_2_raw_BC_in_RNA_DNA.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz, results/experiments/exampleCount1/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=2, countType=raw
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "2")         <( join <( zcat results/experiments/exampleCount1/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz | cut -f 1 | sort | uniq )         <( zcat results/experiments/exampleCount1/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz | cut -f 1 | sort | uniq ) | wc -l ) |         gzip -c > results/experiments/exampleCount1/statistic/counts/HEPG2_2_raw_BC_in_RNA_DNA.tsv.gz 2> results/logs/statistic/counts/BC_in_RNA_DNA.exampleCount1.HEPG2_2_raw.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:15 2024]
Finished job 54.
65 of 199 steps (33%) done
Select jobs to execute...

[Sun Jun 23 16:23:15 2024]
rule statistic_counts_table:
    input: results/experiments/exampleCount/counts/HEPG2_3_DNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts/HEPG2_3_DNA_filtered_counts.tsv.gz
    log: results/logs/statistic/counts/table.exampleCount.HEPG2_3_DNA_filtered.log
    jobid: 79
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/HEPG2_3_DNA_filtered_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_3_DNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=3, type=DNA, countType=filtered
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "3") <( echo "DNA")         <( 
            zcat results/experiments/exampleCount/counts/HEPG2_3_DNA_filtered_counts.tsv.gz |             awk -v OFS='\t' 'BEGIN{
                pbar="NA"
            }{ 
                count += $NF; umi_sum+=$3; if (pbar != $1) { barcodes+=1 }; pbar=$1 
            }END{ 
                if (NR > 0) {
                    print umi_sum/NR,count,NR,barcodes
                } else {
                    print 0,0,0,0
                }
            }' 
        )         <( 
            zcat results/experiments/exampleCount/counts/HEPG2_3_DNA_filtered_counts.tsv.gz | cut -f 2 | sort -u | wc -l 
        ) |         gzip -c > results/experiments/exampleCount/statistic/counts/HEPG2_3_DNA_filtered_counts.tsv.gz 2> results/logs/statistic/counts/table.exampleCount.HEPG2_3_DNA_filtered.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:15 2024]
Finished job 95.
66 of 199 steps (33%) done
Select jobs to execute...

[Sun Jun 23 16:23:15 2024]
rule statistic_counts_barcode_base_composition:
    input: results/experiments/exampleCount/counts/HEPG2_1_DNA_final_counts.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/nucleotideCountPerPosition.py
    output: results/experiments/exampleCount/counts/HEPG2_1_DNA_final.BC.tsv.gz, results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_1_DNA.tsv.gz
    log: results/logs/statistic/counts/barcode_base_composition.exampleCount.HEPG2_1_DNA.log
    jobid: 6
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_1_DNA.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_1_DNA_final_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=1, type=DNA
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount/counts/HEPG2_1_DNA_final_counts.tsv.gz | awk '{print $1}' | gzip -c > results/experiments/exampleCount/counts/HEPG2_1_DNA_final.BC.tsv.gz;
        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/nucleotideCountPerPosition.py         --column 1         --chunksize 100000         --input results/experiments/exampleCount/counts/HEPG2_1_DNA_final.BC.tsv.gz         --output results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_1_DNA.tsv.gz &> results/logs/statistic/counts/barcode_base_composition.exampleCount.HEPG2_1_DNA.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:16 2024]
Finished job 79.
67 of 199 steps (34%) done
Select jobs to execute...

[Sun Jun 23 16:23:16 2024]
rule statistic_counts_table:
    input: results/experiments/exampleCount/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts/HEPG2_2_DNA_raw_counts.tsv.gz
    log: results/logs/statistic/counts/table.exampleCount.HEPG2_2_DNA_raw.log
    jobid: 65
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/HEPG2_2_DNA_raw_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=2, type=DNA, countType=raw
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "2") <( echo "DNA")         <( 
            zcat results/experiments/exampleCount/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz |             awk -v OFS='\t' 'BEGIN{
                pbar="NA"
            }{ 
                count += $NF; umi_sum+=$3; if (pbar != $1) { barcodes+=1 }; pbar=$1 
            }END{ 
                if (NR > 0) {
                    print umi_sum/NR,count,NR,barcodes
                } else {
                    print 0,0,0,0
                }
            }' 
        )         <( 
            zcat results/experiments/exampleCount/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz | cut -f 2 | sort -u | wc -l 
        ) |         gzip -c > results/experiments/exampleCount/statistic/counts/HEPG2_2_DNA_raw_counts.tsv.gz 2> results/logs/statistic/counts/table.exampleCount.HEPG2_2_DNA_raw.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:17 2024]
Finished job 65.
68 of 199 steps (34%) done
Select jobs to execute...

[Sun Jun 23 16:23:17 2024]
rule counts_filter_counts:
    input: results/experiments/exampleCount1/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount1/counts/HEPG2_2_RNA_filtered_counts.tsv.gz
    log: results/logs/counts/filter_counts.exampleCount1.HEPG2.2.RNA.log
    jobid: 43
    reason: Missing output files: results/experiments/exampleCount1/counts/HEPG2_2_RNA_filtered_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=2, type=RNA
    resources: tmpdir=/tmp


        bc=15;
        echo $bc;
        zcat results/experiments/exampleCount1/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz | grep -v "N" |         awk -v var="$bc" -v 'OFS=\t' '{ if (length($1) == var) { print } }' |         sort |         gzip -c > results/experiments/exampleCount1/counts/HEPG2_2_RNA_filtered_counts.tsv.gz
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:18 2024]
Finished job 43.
69 of 199 steps (35%) done
Select jobs to execute...

[Sun Jun 23 16:23:18 2024]
rule statistic_counts_frequent_umis:
    input: results/experiments/exampleCount1/counts/HEPG2_2_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_2_RNA.txt
    log: results/logs/statistic/counts/frequent_umis.exampleCount1.HEPG2.2.RNA.log
    jobid: 117
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_2_RNA.txt; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_2_RNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=2, type=RNA
    resources: tmpdir=/tmp


        set +o pipefail;
        zcat results/experiments/exampleCount1/counts/HEPG2_2_RNA_filtered_counts.tsv.gz | cut -f 2 | sort | uniq -c | sort -nr | head > results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_2_RNA.txt 2> results/logs/statistic/counts/frequent_umis.exampleCount1.HEPG2.2.RNA.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:18 2024]
Finished job 150.
70 of 199 steps (35%) done
Select jobs to execute...

[Sun Jun 23 16:23:18 2024]
rule counts_final_counts:
    input: results/experiments/exampleCount/counts/HEPG2_3_DNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount/counts/HEPG2_3_DNA_final_counts.tsv.gz
    log: results/logs/counts/final_counts_umi.exampleCount.HEPG2.3.DNA.log
    jobid: 27
    reason: Missing output files: results/experiments/exampleCount/counts/HEPG2_3_DNA_final_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_3_DNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=3, type=DNA
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount/counts/HEPG2_3_DNA_filtered_counts.tsv.gz | awk '{print $1}' |         uniq -c |         awk -v 'OFS=\t' '{ print $2,$1 }' |         gzip -c > results/experiments/exampleCount/counts/HEPG2_3_DNA_final_counts.tsv.gz 2> results/logs/counts/final_counts_umi.exampleCount.HEPG2.3.DNA.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:19 2024]
Finished job 135.
71 of 199 steps (36%) done
Select jobs to execute...

[Sun Jun 23 16:23:19 2024]
rule statistic_counts_table:
    input: results/experiments/exampleCount1/counts/HEPG2_2_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts/HEPG2_2_RNA_filtered_counts.tsv.gz
    log: results/logs/statistic/counts/table.exampleCount1.HEPG2_2_RNA_filtered.log
    jobid: 102
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/HEPG2_2_RNA_filtered_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_2_RNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=2, type=RNA, countType=filtered
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "2") <( echo "RNA")         <( 
            zcat results/experiments/exampleCount1/counts/HEPG2_2_RNA_filtered_counts.tsv.gz |             awk -v OFS='\t' 'BEGIN{
                pbar="NA"
            }{ 
                count += $NF; umi_sum+=$3; if (pbar != $1) { barcodes+=1 }; pbar=$1 
            }END{ 
                if (NR > 0) {
                    print umi_sum/NR,count,NR,barcodes
                } else {
                    print 0,0,0,0
                }
            }' 
        )         <( 
            zcat results/experiments/exampleCount1/counts/HEPG2_2_RNA_filtered_counts.tsv.gz | cut -f 2 | sort -u | wc -l 
        ) |         gzip -c > results/experiments/exampleCount1/statistic/counts/HEPG2_2_RNA_filtered_counts.tsv.gz 2> results/logs/statistic/counts/table.exampleCount1.HEPG2_2_RNA_filtered.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:19 2024]
Finished job 153.
72 of 199 steps (36%) done
Select jobs to execute...

[Sun Jun 23 16:23:19 2024]
rule statistic_counts_BC_in_RNA_DNA:
    input: results/experiments/exampleCount1/counts/HEPG2_2_DNA_filtered_counts.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_2_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts/HEPG2_2_filtered_BC_in_RNA_DNA.tsv.gz
    log: results/logs/statistic/counts/BC_in_RNA_DNA.exampleCount1.HEPG2_2_filtered.log
    jobid: 107
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/HEPG2_2_filtered_BC_in_RNA_DNA.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_2_RNA_filtered_counts.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_2_DNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=2, countType=filtered
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "2")         <( join <( zcat results/experiments/exampleCount1/counts/HEPG2_2_DNA_filtered_counts.tsv.gz | cut -f 1 | sort | uniq )         <( zcat results/experiments/exampleCount1/counts/HEPG2_2_RNA_filtered_counts.tsv.gz | cut -f 1 | sort | uniq ) | wc -l ) |         gzip -c > results/experiments/exampleCount1/statistic/counts/HEPG2_2_filtered_BC_in_RNA_DNA.tsv.gz 2> results/logs/statistic/counts/BC_in_RNA_DNA.exampleCount1.HEPG2_2_filtered.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:19 2024]
Finished job 27.
73 of 199 steps (37%) done
Select jobs to execute...

[Sun Jun 23 16:23:19 2024]
rule counts_final_counts:
    input: results/experiments/exampleCount1/counts/HEPG2_2_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount1/counts/HEPG2_2_RNA_final_counts.tsv.gz
    log: results/logs/counts/final_counts_umi.exampleCount1.HEPG2.2.RNA.log
    jobid: 42
    reason: Missing output files: results/experiments/exampleCount1/counts/HEPG2_2_RNA_final_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_2_RNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=2, type=RNA
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount1/counts/HEPG2_2_RNA_filtered_counts.tsv.gz | awk '{print $1}' |         uniq -c |         awk -v 'OFS=\t' '{ print $2,$1 }' |         gzip -c > results/experiments/exampleCount1/counts/HEPG2_2_RNA_final_counts.tsv.gz 2> results/logs/counts/final_counts_umi.exampleCount1.HEPG2.2.RNA.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:20 2024]
Finished job 102.
74 of 199 steps (37%) done
Select jobs to execute...

[Sun Jun 23 16:23:20 2024]
rule counts_dna_rna_merge_counts:
    input: results/experiments/exampleCount/counts/HEPG2_3_DNA_final_counts.tsv.gz, results/experiments/exampleCount/counts/HEPG2_3_RNA_final_counts.tsv.gz
    output: results/experiments/exampleCount/counts/HEPG2_3.merged.config.exampleConfig.tsv.gz
    log: results/logs/counts/dna_rna_merge_counts.exampleCount.HEPG2.3.exampleConfig.log
    jobid: 125
    reason: Missing output files: results/experiments/exampleCount/counts/HEPG2_3.merged.config.exampleConfig.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_3_DNA_final_counts.tsv.gz, results/experiments/exampleCount/counts/HEPG2_3_RNA_final_counts.tsv.gz
    wildcards: project=exampleCount, raw_or_assigned=counts, condition=HEPG2, replicate=3, config=exampleConfig
    resources: tmpdir=/tmp


        zero=false;
        if [[ -z "${zero//false}" ]]
        then
            join -1 1 -2 1 -t"$(echo -e '\t')"             <( zcat  results/experiments/exampleCount/counts/HEPG2_3_DNA_final_counts.tsv.gz | sort )             <( zcat results/experiments/exampleCount/counts/HEPG2_3_RNA_final_counts.tsv.gz | sort);
        else
            join -e 0 -a1 -a2 -t"$(echo -e '\t')" -o 0 1.2 2.2             <( zcat  results/experiments/exampleCount/counts/HEPG2_3_DNA_final_counts.tsv.gz | sort )             <( zcat results/experiments/exampleCount/counts/HEPG2_3_RNA_final_counts.tsv.gz  | sort);
        fi  |         awk -v 'OFS=\t' '{if ($2 >= --minCounts 1 && $3 >= --minCounts 1) {print $0}}' |         gzip -c > results/experiments/exampleCount/counts/HEPG2_3.merged.config.exampleConfig.tsv.gz 2> results/logs/counts/dna_rna_merge_counts.exampleCount.HEPG2.3.exampleConfig.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:20 2024]
Finished job 117.
75 of 199 steps (38%) done
[Sun Jun 23 16:23:20 2024]
Finished job 107.
76 of 199 steps (38%) done
Select jobs to execute...

[Sun Jun 23 16:23:20 2024]
rule counts_final_counts:
    input: results/experiments/exampleCount/counts/HEPG2_1_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount/counts/HEPG2_1_RNA_final_counts.tsv.gz
    log: results/logs/counts/final_counts_umi.exampleCount.HEPG2.1.RNA.log
    jobid: 2
    reason: Missing output files: results/experiments/exampleCount/counts/HEPG2_1_RNA_final_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_1_RNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=1, type=RNA
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount/counts/HEPG2_1_RNA_filtered_counts.tsv.gz | awk '{print $1}' |         uniq -c |         awk -v 'OFS=\t' '{ print $2,$1 }' |         gzip -c > results/experiments/exampleCount/counts/HEPG2_1_RNA_final_counts.tsv.gz 2> results/logs/counts/final_counts_umi.exampleCount.HEPG2.1.RNA.log
        

[Sun Jun 23 16:23:20 2024]
rule assigned_counts_assignBarcodes:
    input: results/experiments/exampleCount/counts/HEPG2_3_DNA_final_counts.tsv.gz, results/experiments/exampleCount/assignment/fromFile.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_BC_and_assignment.py
    output: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_3_DNA_exampleConfig.statistic.tsv.gz
    log: results/logs/assigned_counts/assignBarcodes.exampleCount.HEPG2.3.DNA.exampleConfig.fromFile.log
    jobid: 142
    reason: Missing output files: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_3_DNA_exampleConfig.statistic.tsv.gz; Input files updated by another job: results/experiments/exampleCount/assignment/fromFile.tsv.gz, results/experiments/exampleCount/counts/HEPG2_3_DNA_final_counts.tsv.gz
    wildcards: project=exampleCount, assignment=fromFile, condition=HEPG2, replicate=3, type=DNA, config=exampleConfig
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_BC_and_assignment.py --counts results/experiments/exampleCount/counts/HEPG2_3_DNA_final_counts.tsv.gz         --assignment results/experiments/exampleCount/assignment/fromFile.tsv.gz         --output results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3_DNA_final_counts.config.exampleConfig.tsv.gz         --statistic results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_3_DNA_exampleConfig.statistic.tsv.gz         --name HEPG2_3_DNA &> results/logs/assigned_counts/assignBarcodes.exampleCount.HEPG2.3.DNA.exampleConfig.fromFile.log
        
Select jobs to execute...
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:20 2024]
Finished job 146.
77 of 199 steps (39%) done

[Sun Jun 23 16:23:20 2024]
rule counts_filter_counts:
    input: results/experiments/exampleCount/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount/counts/HEPG2_2_DNA_filtered_counts.tsv.gz
    log: results/logs/counts/filter_counts.exampleCount.HEPG2.2.DNA.log
    jobid: 18
    reason: Missing output files: results/experiments/exampleCount/counts/HEPG2_2_DNA_filtered_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=2, type=DNA
    resources: tmpdir=/tmp


        bc=15;
        echo $bc;
        zcat results/experiments/exampleCount/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz | grep -v "N" |         awk -v var="$bc" -v 'OFS=\t' '{ if (length($1) == var) { print } }' |         sort |         gzip -c > results/experiments/exampleCount/counts/HEPG2_2_DNA_filtered_counts.tsv.gz
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:20 2024]
Finished job 42.
78 of 199 steps (39%) done
Select jobs to execute...

[Sun Jun 23 16:23:20 2024]
rule statistic_counts_barcode_base_composition:
    input: results/experiments/exampleCount/counts/HEPG2_3_DNA_final_counts.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/nucleotideCountPerPosition.py
    output: results/experiments/exampleCount/counts/HEPG2_3_DNA_final.BC.tsv.gz, results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_3_DNA.tsv.gz
    log: results/logs/statistic/counts/barcode_base_composition.exampleCount.HEPG2_3_DNA.log
    jobid: 26
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_3_DNA.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_3_DNA_final_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=3, type=DNA
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount/counts/HEPG2_3_DNA_final_counts.tsv.gz | awk '{print $1}' | gzip -c > results/experiments/exampleCount/counts/HEPG2_3_DNA_final.BC.tsv.gz;
        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/nucleotideCountPerPosition.py         --column 1         --chunksize 100000         --input results/experiments/exampleCount/counts/HEPG2_3_DNA_final.BC.tsv.gz         --output results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_3_DNA.tsv.gz &> results/logs/statistic/counts/barcode_base_composition.exampleCount.HEPG2_3_DNA.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:20 2024]
Finished job 125.
79 of 199 steps (40%) done
Select jobs to execute...

[Sun Jun 23 16:23:20 2024]
rule assigned_counts_assignBarcodes:
    input: results/experiments/exampleCount1/counts/HEPG2_2_RNA_final_counts.tsv.gz, results/experiments/exampleCount1/assignment/fromFile.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_BC_and_assignment.py
    output: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2_RNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_2_RNA_exampleConfig.statistic.tsv.gz
    log: results/logs/assigned_counts/assignBarcodes.exampleCount1.HEPG2.2.RNA.exampleConfig.fromFile.log
    jobid: 151
    reason: Missing output files: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2_RNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_2_RNA_exampleConfig.statistic.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/assignment/fromFile.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_2_RNA_final_counts.tsv.gz
    wildcards: project=exampleCount1, assignment=fromFile, condition=HEPG2, replicate=2, type=RNA, config=exampleConfig
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_BC_and_assignment.py --counts results/experiments/exampleCount1/counts/HEPG2_2_RNA_final_counts.tsv.gz         --assignment results/experiments/exampleCount1/assignment/fromFile.tsv.gz         --output results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2_RNA_final_counts.config.exampleConfig.tsv.gz         --statistic results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_2_RNA_exampleConfig.statistic.tsv.gz         --name HEPG2_2_RNA &> results/logs/assigned_counts/assignBarcodes.exampleCount1.HEPG2.2.RNA.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:20 2024]
Finished job 2.
80 of 199 steps (40%) done
Select jobs to execute...

[Sun Jun 23 16:23:20 2024]
rule statistic_counts_barcode_base_composition:
    input: results/experiments/exampleCount1/counts/HEPG2_2_RNA_final_counts.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/nucleotideCountPerPosition.py
    output: results/experiments/exampleCount1/counts/HEPG2_2_RNA_final.BC.tsv.gz, results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_2_RNA.tsv.gz
    log: results/logs/statistic/counts/barcode_base_composition.exampleCount1.HEPG2_2_RNA.log
    jobid: 41
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_2_RNA.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_2_RNA_final_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=2, type=RNA
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount1/counts/HEPG2_2_RNA_final_counts.tsv.gz | awk '{print $1}' | gzip -c > results/experiments/exampleCount1/counts/HEPG2_2_RNA_final.BC.tsv.gz;
        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/nucleotideCountPerPosition.py         --column 1         --chunksize 100000         --input results/experiments/exampleCount1/counts/HEPG2_2_RNA_final.BC.tsv.gz         --output results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_2_RNA.tsv.gz &> results/logs/statistic/counts/barcode_base_composition.exampleCount1.HEPG2_2_RNA.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:22 2024]
Finished job 18.
81 of 199 steps (41%) done
Select jobs to execute...

[Sun Jun 23 16:23:22 2024]
rule assigned_counts_dna_rna_merge:
    input: results/experiments/exampleCount/counts/HEPG2_3.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assignment/fromFile.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_label.py
    output: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_3_barcode_assigned_counts.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.statistic.tsv.gz
    log: results/logs/assigned_counts/fromFile/dna_rna_merge.exampleCount.HEPG2.3.exampleConfig.log
    jobid: 174
    reason: Missing output files: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.statistic.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_3_barcode_assigned_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_3.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assignment/fromFile.tsv.gz
    wildcards: project=exampleCount, assignment=fromFile, config=exampleConfig, condition=HEPG2, replicate=3
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_label.py --counts results/experiments/exampleCount/counts/HEPG2_3.merged.config.exampleConfig.tsv.gz         --minRNACounts 1 --minDNACounts 1         --assignment results/experiments/exampleCount/assignment/fromFile.tsv.gz         --output results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.tsv.gz         --bcOutput results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_3_barcode_assigned_counts.tsv.gz         --statistic results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.statistic.tsv.gz &> results/logs/assigned_counts/fromFile/dna_rna_merge.exampleCount.HEPG2.3.exampleConfig.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:22 2024]
Finished job 36.
82 of 199 steps (41%) done
Select jobs to execute...

[Sun Jun 23 16:23:22 2024]
rule statistic_counts_BC_in_RNA_DNA:
    input: results/experiments/exampleCount1/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz, results/experiments/exampleCount1/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts/HEPG2_3_raw_BC_in_RNA_DNA.tsv.gz
    log: results/logs/statistic/counts/BC_in_RNA_DNA.exampleCount1.HEPG2_3_raw.log
    jobid: 96
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/HEPG2_3_raw_BC_in_RNA_DNA.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz, results/experiments/exampleCount1/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=3, countType=raw
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "3")         <( join <( zcat results/experiments/exampleCount1/counts/useUMI.HEPG2_3_DNA_raw_counts.tsv.gz | cut -f 1 | sort | uniq )         <( zcat results/experiments/exampleCount1/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz | cut -f 1 | sort | uniq ) | wc -l ) |         gzip -c > results/experiments/exampleCount1/statistic/counts/HEPG2_3_raw_BC_in_RNA_DNA.tsv.gz 2> results/logs/statistic/counts/BC_in_RNA_DNA.exampleCount1.HEPG2_3_raw.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:23 2024]
Finished job 46.
83 of 199 steps (42%) done
Select jobs to execute...

[Sun Jun 23 16:23:23 2024]
rule statistic_counts_frequent_umis:
    input: results/experiments/exampleCount/counts/HEPG2_2_DNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_2_DNA.txt
    log: results/logs/statistic/counts/frequent_umis.exampleCount.HEPG2.2.DNA.log
    jobid: 112
    reason: Missing output files: results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_2_DNA.txt; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_2_DNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=2, type=DNA
    resources: tmpdir=/tmp


        set +o pipefail;
        zcat results/experiments/exampleCount/counts/HEPG2_2_DNA_filtered_counts.tsv.gz | cut -f 2 | sort | uniq -c | sort -nr | head > results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_2_DNA.txt 2> results/logs/statistic/counts/frequent_umis.exampleCount.HEPG2.2.DNA.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:23 2024]
Finished job 96.
84 of 199 steps (42%) done
Select jobs to execute...

[Sun Jun 23 16:23:23 2024]
rule statistic_counts_BC_in_RNA_DNA_merge:
    input: results/experiments/exampleCount1/statistic/counts/HEPG2_1_raw_BC_in_RNA_DNA.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_2_raw_BC_in_RNA_DNA.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_3_raw_BC_in_RNA_DNA.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts/BC_in_RNA_DNA_raw.tsv
    log: results/logs/statistic/counts/BC_in_RNA_DNA_merge.exampleCount1.raw.log
    jobid: 93
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/BC_in_RNA_DNA_raw.tsv; Input files updated by another job: results/experiments/exampleCount1/statistic/counts/HEPG2_1_raw_BC_in_RNA_DNA.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_3_raw_BC_in_RNA_DNA.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_2_raw_BC_in_RNA_DNA.tsv.gz
    wildcards: project=exampleCount1, countType=raw
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount1/statistic/counts/HEPG2_1_raw_BC_in_RNA_DNA.tsv.gz results/experiments/exampleCount1/statistic/counts/HEPG2_2_raw_BC_in_RNA_DNA.tsv.gz results/experiments/exampleCount1/statistic/counts/HEPG2_3_raw_BC_in_RNA_DNA.tsv.gz | sort -k1,1 -k2,2 > results/experiments/exampleCount1/statistic/counts/BC_in_RNA_DNA_raw.tsv 2> results/logs/statistic/counts/BC_in_RNA_DNA_merge.exampleCount1.raw.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:23 2024]
Finished job 56.
85 of 199 steps (43%) done
Select jobs to execute...

[Sun Jun 23 16:23:23 2024]
rule assigned_counts_assignBarcodes:
    input: results/experiments/exampleCount/counts/HEPG2_1_RNA_final_counts.tsv.gz, results/experiments/exampleCount/assignment/fromFile.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_BC_and_assignment.py
    output: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1_RNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_1_RNA_exampleConfig.statistic.tsv.gz
    log: results/logs/assigned_counts/assignBarcodes.exampleCount.HEPG2.1.RNA.exampleConfig.fromFile.log
    jobid: 137
    reason: Missing output files: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1_RNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_1_RNA_exampleConfig.statistic.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_1_RNA_final_counts.tsv.gz, results/experiments/exampleCount/assignment/fromFile.tsv.gz
    wildcards: project=exampleCount, assignment=fromFile, condition=HEPG2, replicate=1, type=RNA, config=exampleConfig
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_BC_and_assignment.py --counts results/experiments/exampleCount/counts/HEPG2_1_RNA_final_counts.tsv.gz         --assignment results/experiments/exampleCount/assignment/fromFile.tsv.gz         --output results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1_RNA_final_counts.config.exampleConfig.tsv.gz         --statistic results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_1_RNA_exampleConfig.statistic.tsv.gz         --name HEPG2_1_RNA &> results/logs/assigned_counts/assignBarcodes.exampleCount.HEPG2.1.RNA.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:23 2024]
Finished job 93.
86 of 199 steps (43%) done
Select jobs to execute...

[Sun Jun 23 16:23:23 2024]
rule counts_dna_rna_merge_counts:
    input: results/experiments/exampleCount1/counts/HEPG2_2_DNA_final_counts.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_2_RNA_final_counts.tsv.gz
    output: results/experiments/exampleCount1/counts/HEPG2_2.merged.config.exampleConfig.tsv.gz
    log: results/logs/counts/dna_rna_merge_counts.exampleCount1.HEPG2.2.exampleConfig.log
    jobid: 129
    reason: Missing output files: results/experiments/exampleCount1/counts/HEPG2_2.merged.config.exampleConfig.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_2_DNA_final_counts.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_2_RNA_final_counts.tsv.gz
    wildcards: project=exampleCount1, raw_or_assigned=counts, condition=HEPG2, replicate=2, config=exampleConfig
    resources: tmpdir=/tmp


        zero=false;
        if [[ -z "${zero//false}" ]]
        then
            join -1 1 -2 1 -t"$(echo -e '\t')"             <( zcat  results/experiments/exampleCount1/counts/HEPG2_2_DNA_final_counts.tsv.gz | sort )             <( zcat results/experiments/exampleCount1/counts/HEPG2_2_RNA_final_counts.tsv.gz | sort);
        else
            join -e 0 -a1 -a2 -t"$(echo -e '\t')" -o 0 1.2 2.2             <( zcat  results/experiments/exampleCount1/counts/HEPG2_2_DNA_final_counts.tsv.gz | sort )             <( zcat results/experiments/exampleCount1/counts/HEPG2_2_RNA_final_counts.tsv.gz  | sort);
        fi  |         awk -v 'OFS=\t' '{if ($2 >= --minCounts 1 && $3 >= --minCounts 1) {print $0}}' |         gzip -c > results/experiments/exampleCount1/counts/HEPG2_2.merged.config.exampleConfig.tsv.gz 2> results/logs/counts/dna_rna_merge_counts.exampleCount1.HEPG2.2.exampleConfig.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:24 2024]
Finished job 112.
87 of 199 steps (44%) done
Select jobs to execute...

[Sun Jun 23 16:23:24 2024]
rule statistic_bc_overlap_run:
    input: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3_DNA_final_counts.config.exampleConfig.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/BCCounts_betweenReplicates.R
    output: results/experiments/exampleCount1/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv
    log: results/logs/statistic/bc_overlap/run.exampleCount1.HEPG2.DNA.exampleConfig.assigned_counts/fromFile.log
    jobid: 169
    reason: Missing output files: results/experiments/exampleCount1/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv; Input files updated by another job: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3_DNA_final_counts.config.exampleConfig.tsv.gz
    wildcards: project=exampleCount1, raw_or_assigned=assigned_counts/fromFile, condition=HEPG2, type=DNA, config=exampleConfig
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/BCCounts_betweenReplicates.R         --outfile results/experiments/exampleCount1/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv         --condition HEPG2_DNA         --files results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1_DNA_final_counts.config.exampleConfig.tsv.gz,results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2_DNA_final_counts.config.exampleConfig.tsv.gz,results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3_DNA_final_counts.config.exampleConfig.tsv.gz --replicates 1,2,3 &> results/logs/statistic/bc_overlap/run.exampleCount1.HEPG2.DNA.exampleConfig.assigned_counts/fromFile.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_
[Sun Jun 23 16:23:24 2024]
Finished job 129.
88 of 199 steps (44%) done
Select jobs to execute...

[Sun Jun 23 16:23:24 2024]
rule assigned_counts_dna_rna_merge:
    input: results/experiments/exampleCount1/counts/HEPG2_2.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assignment/fromFile.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_label.py
    output: results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_2_barcode_assigned_counts.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.statistic.tsv.gz
    log: results/logs/assigned_counts/fromFile/dna_rna_merge.exampleCount1.HEPG2.2.exampleConfig.log
    jobid: 180
    reason: Missing output files: results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.statistic.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_2_barcode_assigned_counts.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/assignment/fromFile.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_2.merged.config.exampleConfig.tsv.gz
    wildcards: project=exampleCount1, assignment=fromFile, config=exampleConfig, condition=HEPG2, replicate=2
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_label.py --counts results/experiments/exampleCount1/counts/HEPG2_2.merged.config.exampleConfig.tsv.gz         --minRNACounts 1 --minDNACounts 1         --assignment results/experiments/exampleCount1/assignment/fromFile.tsv.gz         --output results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.tsv.gz         --bcOutput results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_2_barcode_assigned_counts.tsv.gz         --statistic results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.statistic.tsv.gz &> results/logs/assigned_counts/fromFile/dna_rna_merge.exampleCount1.HEPG2.2.exampleConfig.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:26 2024]
Finished job 174.
89 of 199 steps (45%) done
Select jobs to execute...

[Sun Jun 23 16:23:26 2024]
rule statistic_counts_barcode_base_composition:
    input: results/experiments/exampleCount/counts/HEPG2_1_RNA_final_counts.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/nucleotideCountPerPosition.py
    output: results/experiments/exampleCount/counts/HEPG2_1_RNA_final.BC.tsv.gz, results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_1_RNA.tsv.gz
    log: results/logs/statistic/counts/barcode_base_composition.exampleCount.HEPG2_1_RNA.log
    jobid: 1
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_1_RNA.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_1_RNA_final_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=1, type=RNA
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount/counts/HEPG2_1_RNA_final_counts.tsv.gz | awk '{print $1}' | gzip -c > results/experiments/exampleCount/counts/HEPG2_1_RNA_final.BC.tsv.gz;
        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/nucleotideCountPerPosition.py         --column 1         --chunksize 100000         --input results/experiments/exampleCount/counts/HEPG2_1_RNA_final.BC.tsv.gz         --output results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_1_RNA.tsv.gz &> results/logs/statistic/counts/barcode_base_composition.exampleCount.HEPG2_1_RNA.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:28 2024]
Finished job 180.
90 of 199 steps (45%) done
Select jobs to execute...

[Sun Jun 23 16:23:28 2024]
rule statistic_counts_table:
    input: results/experiments/exampleCount1/counts/HEPG2_2_DNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts/HEPG2_2_DNA_filtered_counts.tsv.gz
    log: results/logs/statistic/counts/table.exampleCount1.HEPG2_2_DNA_filtered.log
    jobid: 101
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/HEPG2_2_DNA_filtered_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_2_DNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=2, type=DNA, countType=filtered
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "2") <( echo "DNA")         <( 
            zcat results/experiments/exampleCount1/counts/HEPG2_2_DNA_filtered_counts.tsv.gz |             awk -v OFS='\t' 'BEGIN{
                pbar="NA"
            }{ 
                count += $NF; umi_sum+=$3; if (pbar != $1) { barcodes+=1 }; pbar=$1 
            }END{ 
                if (NR > 0) {
                    print umi_sum/NR,count,NR,barcodes
                } else {
                    print 0,0,0,0
                }
            }' 
        )         <( 
            zcat results/experiments/exampleCount1/counts/HEPG2_2_DNA_filtered_counts.tsv.gz | cut -f 2 | sort -u | wc -l 
        ) |         gzip -c > results/experiments/exampleCount1/statistic/counts/HEPG2_2_DNA_filtered_counts.tsv.gz 2> results/logs/statistic/counts/table.exampleCount1.HEPG2_2_DNA_filtered.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:29 2024]
Finished job 101.
91 of 199 steps (46%) done
Select jobs to execute...

[Sun Jun 23 16:23:29 2024]
rule counts_final_counts:
    input: results/experiments/exampleCount1/counts/HEPG2_1_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount1/counts/HEPG2_1_RNA_final_counts.tsv.gz
    log: results/logs/counts/final_counts_umi.exampleCount1.HEPG2.1.RNA.log
    jobid: 32
    reason: Missing output files: results/experiments/exampleCount1/counts/HEPG2_1_RNA_final_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_1_RNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=1, type=RNA
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount1/counts/HEPG2_1_RNA_filtered_counts.tsv.gz | awk '{print $1}' |         uniq -c |         awk -v 'OFS=\t' '{ print $2,$1 }' |         gzip -c > results/experiments/exampleCount1/counts/HEPG2_1_RNA_final_counts.tsv.gz 2> results/logs/counts/final_counts_umi.exampleCount1.HEPG2.1.RNA.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:29 2024]
Finished job 32.
92 of 199 steps (46%) done
Select jobs to execute...

[Sun Jun 23 16:23:30 2024]
rule statistic_counts_table:
    input: results/experiments/exampleCount1/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts/HEPG2_3_RNA_raw_counts.tsv.gz
    log: results/logs/statistic/counts/table.exampleCount1.HEPG2_3_RNA_raw.log
    jobid: 92
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/HEPG2_3_RNA_raw_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=3, type=RNA, countType=raw
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "3") <( echo "RNA")         <( 
            zcat results/experiments/exampleCount1/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz |             awk -v OFS='\t' 'BEGIN{
                pbar="NA"
            }{ 
                count += $NF; umi_sum+=$3; if (pbar != $1) { barcodes+=1 }; pbar=$1 
            }END{ 
                if (NR > 0) {
                    print umi_sum/NR,count,NR,barcodes
                } else {
                    print 0,0,0,0
                }
            }' 
        )         <( 
            zcat results/experiments/exampleCount1/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz | cut -f 2 | sort -u | wc -l 
        ) |         gzip -c > results/experiments/exampleCount1/statistic/counts/HEPG2_3_RNA_raw_counts.tsv.gz 2> results/logs/statistic/counts/table.exampleCount1.HEPG2_3_RNA_raw.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:30 2024]
Finished job 21.
93 of 199 steps (47%) done
Select jobs to execute...

[Sun Jun 23 16:23:30 2024]
rule statistic_counts_barcode_base_composition:
    input: results/experiments/exampleCount1/counts/HEPG2_1_RNA_final_counts.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/nucleotideCountPerPosition.py
    output: results/experiments/exampleCount1/counts/HEPG2_1_RNA_final.BC.tsv.gz, results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_1_RNA.tsv.gz
    log: results/logs/statistic/counts/barcode_base_composition.exampleCount1.HEPG2_1_RNA.log
    jobid: 31
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_1_RNA.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_1_RNA_final_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=1, type=RNA
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount1/counts/HEPG2_1_RNA_final_counts.tsv.gz | awk '{print $1}' | gzip -c > results/experiments/exampleCount1/counts/HEPG2_1_RNA_final.BC.tsv.gz;
        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/nucleotideCountPerPosition.py         --column 1         --chunksize 100000         --input results/experiments/exampleCount1/counts/HEPG2_1_RNA_final.BC.tsv.gz         --output results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_1_RNA.tsv.gz &> results/logs/statistic/counts/barcode_base_composition.exampleCount1.HEPG2_1_RNA.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:30 2024]
Finished job 92.
94 of 199 steps (47%) done
Select jobs to execute...

[Sun Jun 23 16:23:30 2024]
rule assigned_counts_assignBarcodes:
    input: results/experiments/exampleCount1/counts/HEPG2_1_RNA_final_counts.tsv.gz, results/experiments/exampleCount1/assignment/fromFile.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_BC_and_assignment.py
    output: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1_RNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_1_RNA_exampleConfig.statistic.tsv.gz
    log: results/logs/assigned_counts/assignBarcodes.exampleCount1.HEPG2.1.RNA.exampleConfig.fromFile.log
    jobid: 148
    reason: Missing output files: results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_1_RNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1_RNA_final_counts.config.exampleConfig.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/assignment/fromFile.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_1_RNA_final_counts.tsv.gz
    wildcards: project=exampleCount1, assignment=fromFile, condition=HEPG2, replicate=1, type=RNA, config=exampleConfig
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_BC_and_assignment.py --counts results/experiments/exampleCount1/counts/HEPG2_1_RNA_final_counts.tsv.gz         --assignment results/experiments/exampleCount1/assignment/fromFile.tsv.gz         --output results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1_RNA_final_counts.config.exampleConfig.tsv.gz         --statistic results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_1_RNA_exampleConfig.statistic.tsv.gz         --name HEPG2_1_RNA &> results/logs/assigned_counts/assignBarcodes.exampleCount1.HEPG2.1.RNA.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:31 2024]
Finished job 169.
95 of 199 steps (48%) done
Select jobs to execute...

[Sun Jun 23 16:23:31 2024]
rule statistic_counts_table:
    input: results/experiments/exampleCount1/counts/HEPG2_1_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts/HEPG2_1_RNA_filtered_counts.tsv.gz
    log: results/logs/statistic/counts/table.exampleCount1.HEPG2_1_RNA_filtered.log
    jobid: 100
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/HEPG2_1_RNA_filtered_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_1_RNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=1, type=RNA, countType=filtered
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "1") <( echo "RNA")         <( 
            zcat results/experiments/exampleCount1/counts/HEPG2_1_RNA_filtered_counts.tsv.gz |             awk -v OFS='\t' 'BEGIN{
                pbar="NA"
            }{ 
                count += $NF; umi_sum+=$3; if (pbar != $1) { barcodes+=1 }; pbar=$1 
            }END{ 
                if (NR > 0) {
                    print umi_sum/NR,count,NR,barcodes
                } else {
                    print 0,0,0,0
                }
            }' 
        )         <( 
            zcat results/experiments/exampleCount1/counts/HEPG2_1_RNA_filtered_counts.tsv.gz | cut -f 2 | sort -u | wc -l 
        ) |         gzip -c > results/experiments/exampleCount1/statistic/counts/HEPG2_1_RNA_filtered_counts.tsv.gz 2> results/logs/statistic/counts/table.exampleCount1.HEPG2_1_RNA_filtered.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:32 2024]
Finished job 6.
96 of 199 steps (48%) done
Select jobs to execute...

[Sun Jun 23 16:23:32 2024]
rule counts_dna_rna_merge_counts:
    input: results/experiments/exampleCount/counts/HEPG2_1_DNA_final_counts.tsv.gz, results/experiments/exampleCount/counts/HEPG2_1_RNA_final_counts.tsv.gz
    output: results/experiments/exampleCount/counts/HEPG2_1.merged.config.exampleConfig.tsv.gz
    log: results/logs/counts/dna_rna_merge_counts.exampleCount.HEPG2.1.exampleConfig.log
    jobid: 123
    reason: Missing output files: results/experiments/exampleCount/counts/HEPG2_1.merged.config.exampleConfig.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_1_RNA_final_counts.tsv.gz, results/experiments/exampleCount/counts/HEPG2_1_DNA_final_counts.tsv.gz
    wildcards: project=exampleCount, raw_or_assigned=counts, condition=HEPG2, replicate=1, config=exampleConfig
    resources: tmpdir=/tmp


        zero=false;
        if [[ -z "${zero//false}" ]]
        then
            join -1 1 -2 1 -t"$(echo -e '\t')"             <( zcat  results/experiments/exampleCount/counts/HEPG2_1_DNA_final_counts.tsv.gz | sort )             <( zcat results/experiments/exampleCount/counts/HEPG2_1_RNA_final_counts.tsv.gz | sort);
        else
            join -e 0 -a1 -a2 -t"$(echo -e '\t')" -o 0 1.2 2.2             <( zcat  results/experiments/exampleCount/counts/HEPG2_1_DNA_final_counts.tsv.gz | sort )             <( zcat results/experiments/exampleCount/counts/HEPG2_1_RNA_final_counts.tsv.gz  | sort);
        fi  |         awk -v 'OFS=\t' '{if ($2 >= --minCounts 1 && $3 >= --minCounts 1) {print $0}}' |         gzip -c > results/experiments/exampleCount/counts/HEPG2_1.merged.config.exampleConfig.tsv.gz 2> results/logs/counts/dna_rna_merge_counts.exampleCount.HEPG2.1.exampleConfig.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:32 2024]
Finished job 100.
97 of 199 steps (49%) done
Select jobs to execute...

[Sun Jun 23 16:23:32 2024]
rule statistic_counts_table:
    input: results/experiments/exampleCount/counts/HEPG2_2_DNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts/HEPG2_2_DNA_filtered_counts.tsv.gz
    log: results/logs/statistic/counts/table.exampleCount.HEPG2_2_DNA_filtered.log
    jobid: 77
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/HEPG2_2_DNA_filtered_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_2_DNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=2, type=DNA, countType=filtered
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "2") <( echo "DNA")         <( 
            zcat results/experiments/exampleCount/counts/HEPG2_2_DNA_filtered_counts.tsv.gz |             awk -v OFS='\t' 'BEGIN{
                pbar="NA"
            }{ 
                count += $NF; umi_sum+=$3; if (pbar != $1) { barcodes+=1 }; pbar=$1 
            }END{ 
                if (NR > 0) {
                    print umi_sum/NR,count,NR,barcodes
                } else {
                    print 0,0,0,0
                }
            }' 
        )         <( 
            zcat results/experiments/exampleCount/counts/HEPG2_2_DNA_filtered_counts.tsv.gz | cut -f 2 | sort -u | wc -l 
        ) |         gzip -c > results/experiments/exampleCount/statistic/counts/HEPG2_2_DNA_filtered_counts.tsv.gz 2> results/logs/statistic/counts/table.exampleCount.HEPG2_2_DNA_filtered.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:32 2024]
Finished job 123.
98 of 199 steps (49%) done
Select jobs to execute...

[Sun Jun 23 16:23:32 2024]
rule assigned_counts_dna_rna_merge:
    input: results/experiments/exampleCount/counts/HEPG2_1.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assignment/fromFile.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_label.py
    output: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_1_barcode_assigned_counts.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.statistic.tsv.gz
    log: results/logs/assigned_counts/fromFile/dna_rna_merge.exampleCount.HEPG2.1.exampleConfig.log
    jobid: 172
    reason: Missing output files: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.statistic.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_1_barcode_assigned_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/assignment/fromFile.tsv.gz, results/experiments/exampleCount/counts/HEPG2_1.merged.config.exampleConfig.tsv.gz
    wildcards: project=exampleCount, assignment=fromFile, config=exampleConfig, condition=HEPG2, replicate=1
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_label.py --counts results/experiments/exampleCount/counts/HEPG2_1.merged.config.exampleConfig.tsv.gz         --minRNACounts 1 --minDNACounts 1         --assignment results/experiments/exampleCount/assignment/fromFile.tsv.gz         --output results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.tsv.gz         --bcOutput results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_1_barcode_assigned_counts.tsv.gz         --statistic results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.statistic.tsv.gz &> results/logs/assigned_counts/fromFile/dna_rna_merge.exampleCount.HEPG2.1.exampleConfig.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:33 2024]
Finished job 77.
99 of 199 steps (50%) done
Select jobs to execute...

[Sun Jun 23 16:23:33 2024]
rule counts_filter_counts:
    input: results/experiments/exampleCount1/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount1/counts/HEPG2_3_RNA_filtered_counts.tsv.gz
    log: results/logs/counts/filter_counts.exampleCount1.HEPG2.3.RNA.log
    jobid: 53
    reason: Missing output files: results/experiments/exampleCount1/counts/HEPG2_3_RNA_filtered_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=3, type=RNA
    resources: tmpdir=/tmp


        bc=15;
        echo $bc;
        zcat results/experiments/exampleCount1/counts/useUMI.HEPG2_3_RNA_raw_counts.tsv.gz | grep -v "N" |         awk -v var="$bc" -v 'OFS=\t' '{ if (length($1) == var) { print } }' |         sort |         gzip -c > results/experiments/exampleCount1/counts/HEPG2_3_RNA_filtered_counts.tsv.gz
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:33 2024]
Finished job 142.
100 of 199 steps (50%) done
Select jobs to execute...

[Sun Jun 23 16:23:33 2024]
rule counts_dna_rna_merge_counts:
    input: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3_RNA_final_counts.config.exampleConfig.tsv.gz
    output: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3.merged.config.exampleConfig.tsv.gz
    log: results/logs/assigned_counts/fromFile/dna_rna_merge_counts.exampleCount.HEPG2.3.exampleConfig.log
    jobid: 141
    reason: Missing output files: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3.merged.config.exampleConfig.tsv.gz; Input files updated by another job: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3_RNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3_DNA_final_counts.config.exampleConfig.tsv.gz
    wildcards: project=exampleCount, raw_or_assigned=assigned_counts/fromFile, condition=HEPG2, replicate=3, config=exampleConfig
    resources: tmpdir=/tmp


        zero=false;
        if [[ -z "${zero//false}" ]]
        then
            join -1 1 -2 1 -t"$(echo -e '\t')"             <( zcat  results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3_DNA_final_counts.config.exampleConfig.tsv.gz | sort )             <( zcat results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3_RNA_final_counts.config.exampleConfig.tsv.gz | sort);
        else
            join -e 0 -a1 -a2 -t"$(echo -e '\t')" -o 0 1.2 2.2             <( zcat  results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3_DNA_final_counts.config.exampleConfig.tsv.gz | sort )             <( zcat results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3_RNA_final_counts.config.exampleConfig.tsv.gz  | sort);
        fi  |         awk -v 'OFS=\t' '{if ($2 >= --minCounts 1 && $3 >= --minCounts 1) {print $0}}' |         gzip -c > results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3.merged.config.exampleConfig.tsv.gz 2> results/logs/assigned_counts/fromFile/dna_rna_merge_counts.exampleCount.HEPG2.3.exampleConfig.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:34 2024]
Finished job 141.
101 of 199 steps (51%) done
Select jobs to execute...

[Sun Jun 23 16:23:34 2024]
rule statistic_counts_table:
    input: results/experiments/exampleCount1/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts/HEPG2_2_RNA_raw_counts.tsv.gz
    log: results/logs/statistic/counts/table.exampleCount1.HEPG2_2_RNA_raw.log
    jobid: 90
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/HEPG2_2_RNA_raw_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=2, type=RNA, countType=raw
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "2") <( echo "RNA")         <( 
            zcat results/experiments/exampleCount1/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz |             awk -v OFS='\t' 'BEGIN{
                pbar="NA"
            }{ 
                count += $NF; umi_sum+=$3; if (pbar != $1) { barcodes+=1 }; pbar=$1 
            }END{ 
                if (NR > 0) {
                    print umi_sum/NR,count,NR,barcodes
                } else {
                    print 0,0,0,0
                }
            }' 
        )         <( 
            zcat results/experiments/exampleCount1/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz | cut -f 2 | sort -u | wc -l 
        ) |         gzip -c > results/experiments/exampleCount1/statistic/counts/HEPG2_2_RNA_raw_counts.tsv.gz 2> results/logs/statistic/counts/table.exampleCount1.HEPG2_2_RNA_raw.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:34 2024]
Finished job 53.
102 of 199 steps (51%) done
Select jobs to execute...

[Sun Jun 23 16:23:34 2024]
rule statistic_counts_table:
    input: results/experiments/exampleCount1/counts/HEPG2_3_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts/HEPG2_3_RNA_filtered_counts.tsv.gz
    log: results/logs/statistic/counts/table.exampleCount1.HEPG2_3_RNA_filtered.log
    jobid: 104
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/HEPG2_3_RNA_filtered_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_3_RNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=3, type=RNA, countType=filtered
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "3") <( echo "RNA")         <( 
            zcat results/experiments/exampleCount1/counts/HEPG2_3_RNA_filtered_counts.tsv.gz |             awk -v OFS='\t' 'BEGIN{
                pbar="NA"
            }{ 
                count += $NF; umi_sum+=$3; if (pbar != $1) { barcodes+=1 }; pbar=$1 
            }END{ 
                if (NR > 0) {
                    print umi_sum/NR,count,NR,barcodes
                } else {
                    print 0,0,0,0
                }
            }' 
        )         <( 
            zcat results/experiments/exampleCount1/counts/HEPG2_3_RNA_filtered_counts.tsv.gz | cut -f 2 | sort -u | wc -l 
        ) |         gzip -c > results/experiments/exampleCount1/statistic/counts/HEPG2_3_RNA_filtered_counts.tsv.gz 2> results/logs/statistic/counts/table.exampleCount1.HEPG2_3_RNA_filtered.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:34 2024]
Finished job 151.
103 of 199 steps (52%) done
Select jobs to execute...

[Sun Jun 23 16:23:34 2024]
rule statistic_counts_frequent_umis:
    input: results/experiments/exampleCount1/counts/HEPG2_3_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_3_RNA.txt
    log: results/logs/statistic/counts/frequent_umis.exampleCount1.HEPG2.3.RNA.log
    jobid: 119
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_3_RNA.txt; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_3_RNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=3, type=RNA
    resources: tmpdir=/tmp


        set +o pipefail;
        zcat results/experiments/exampleCount1/counts/HEPG2_3_RNA_filtered_counts.tsv.gz | cut -f 2 | sort | uniq -c | sort -nr | head > results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_3_RNA.txt 2> results/logs/statistic/counts/frequent_umis.exampleCount1.HEPG2.3.RNA.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:35 2024]
Finished job 90.
104 of 199 steps (52%) done
Select jobs to execute...

[Sun Jun 23 16:23:35 2024]
rule statistic_counts_stats_merge:
    input: results/experiments/exampleCount1/statistic/counts/HEPG2_1_DNA_raw_counts.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_1_RNA_raw_counts.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_2_DNA_raw_counts.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_2_RNA_raw_counts.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_3_DNA_raw_counts.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_3_RNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts/count_raw.tsv
    log: results/logs/statistic/counts/stats_merge.exampleCount1.raw.log
    jobid: 86
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/count_raw.tsv; Input files updated by another job: results/experiments/exampleCount1/statistic/counts/HEPG2_2_RNA_raw_counts.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_3_RNA_raw_counts.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_3_DNA_raw_counts.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_2_DNA_raw_counts.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_1_DNA_raw_counts.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_1_RNA_raw_counts.tsv.gz
    wildcards: project=exampleCount1, countType=raw
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount1/statistic/counts/HEPG2_1_DNA_raw_counts.tsv.gz results/experiments/exampleCount1/statistic/counts/HEPG2_1_RNA_raw_counts.tsv.gz results/experiments/exampleCount1/statistic/counts/HEPG2_2_DNA_raw_counts.tsv.gz results/experiments/exampleCount1/statistic/counts/HEPG2_2_RNA_raw_counts.tsv.gz results/experiments/exampleCount1/statistic/counts/HEPG2_3_DNA_raw_counts.tsv.gz results/experiments/exampleCount1/statistic/counts/HEPG2_3_RNA_raw_counts.tsv.gz | sort -k1,1 -k3,3 -k2,2 > results/experiments/exampleCount1/statistic/counts/count_raw.tsv 2> results/logs/statistic/counts/stats_merge.exampleCount1.raw.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:35 2024]
Finished job 86.
105 of 199 steps (53%) done
Select jobs to execute...

[Sun Jun 23 16:23:35 2024]
rule statistic_counts_final:
    input: results/experiments/exampleCount1/statistic/counts/count_raw.tsv, results/experiments/exampleCount1/statistic/counts/BC_in_RNA_DNA_raw.tsv, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/combine_count_stats.R
    output: results/experiments/exampleCount1/statistic/counts.raw.tsv
    log: results/logs/statistic/counts/final.exampleCount1.raw.log
    jobid: 85
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts.raw.tsv; Input files updated by another job: results/experiments/exampleCount1/statistic/counts/BC_in_RNA_DNA_raw.tsv, results/experiments/exampleCount1/statistic/counts/count_raw.tsv
    wildcards: project=exampleCount1, countType=raw
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/combine_count_stats.R --count results/experiments/exampleCount1/statistic/counts/count_raw.tsv --shared results/experiments/exampleCount1/statistic/counts/BC_in_RNA_DNA_raw.tsv --output results/experiments/exampleCount1/statistic/counts.raw.tsv > results/logs/statistic/counts/final.exampleCount1.raw.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_
[Sun Jun 23 16:23:35 2024]
Finished job 104.
106 of 199 steps (53%) done
Select jobs to execute...

[Sun Jun 23 16:23:35 2024]
rule statistic_counts_stats_merge:
    input: results/experiments/exampleCount1/statistic/counts/HEPG2_1_DNA_filtered_counts.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_1_RNA_filtered_counts.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_2_DNA_filtered_counts.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_2_RNA_filtered_counts.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_3_DNA_filtered_counts.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_3_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts/count_filtered.tsv
    log: results/logs/statistic/counts/stats_merge.exampleCount1.filtered.log
    jobid: 98
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/count_filtered.tsv; Input files updated by another job: results/experiments/exampleCount1/statistic/counts/HEPG2_1_DNA_filtered_counts.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_2_RNA_filtered_counts.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_3_DNA_filtered_counts.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_1_RNA_filtered_counts.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_3_RNA_filtered_counts.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_2_DNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount1, countType=filtered
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount1/statistic/counts/HEPG2_1_DNA_filtered_counts.tsv.gz results/experiments/exampleCount1/statistic/counts/HEPG2_1_RNA_filtered_counts.tsv.gz results/experiments/exampleCount1/statistic/counts/HEPG2_2_DNA_filtered_counts.tsv.gz results/experiments/exampleCount1/statistic/counts/HEPG2_2_RNA_filtered_counts.tsv.gz results/experiments/exampleCount1/statistic/counts/HEPG2_3_DNA_filtered_counts.tsv.gz results/experiments/exampleCount1/statistic/counts/HEPG2_3_RNA_filtered_counts.tsv.gz | sort -k1,1 -k3,3 -k2,2 > results/experiments/exampleCount1/statistic/counts/count_filtered.tsv 2> results/logs/statistic/counts/stats_merge.exampleCount1.filtered.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:35 2024]
Finished job 98.
107 of 199 steps (54%) done
Select jobs to execute...

[Sun Jun 23 16:23:35 2024]
rule statistic_counts_BC_in_RNA_DNA:
    input: results/experiments/exampleCount1/counts/HEPG2_3_DNA_filtered_counts.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_3_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts/HEPG2_3_filtered_BC_in_RNA_DNA.tsv.gz
    log: results/logs/statistic/counts/BC_in_RNA_DNA.exampleCount1.HEPG2_3_filtered.log
    jobid: 108
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/HEPG2_3_filtered_BC_in_RNA_DNA.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_3_RNA_filtered_counts.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_3_DNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=3, countType=filtered
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "3")         <( join <( zcat results/experiments/exampleCount1/counts/HEPG2_3_DNA_filtered_counts.tsv.gz | cut -f 1 | sort | uniq )         <( zcat results/experiments/exampleCount1/counts/HEPG2_3_RNA_filtered_counts.tsv.gz | cut -f 1 | sort | uniq ) | wc -l ) |         gzip -c > results/experiments/exampleCount1/statistic/counts/HEPG2_3_filtered_BC_in_RNA_DNA.tsv.gz 2> results/logs/statistic/counts/BC_in_RNA_DNA.exampleCount1.HEPG2_3_filtered.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:36 2024]
Finished job 119.
108 of 199 steps (54%) done
Select jobs to execute...

[Sun Jun 23 16:23:36 2024]
rule counts_dna_rna_merge_counts:
    input: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2_RNA_final_counts.config.exampleConfig.tsv.gz
    output: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2.merged.config.exampleConfig.tsv.gz
    log: results/logs/assigned_counts/fromFile/dna_rna_merge_counts.exampleCount1.HEPG2.2.exampleConfig.log
    jobid: 149
    reason: Missing output files: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2.merged.config.exampleConfig.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2_RNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2_DNA_final_counts.config.exampleConfig.tsv.gz
    wildcards: project=exampleCount1, raw_or_assigned=assigned_counts/fromFile, condition=HEPG2, replicate=2, config=exampleConfig
    resources: tmpdir=/tmp


        zero=false;
        if [[ -z "${zero//false}" ]]
        then
            join -1 1 -2 1 -t"$(echo -e '\t')"             <( zcat  results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2_DNA_final_counts.config.exampleConfig.tsv.gz | sort )             <( zcat results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2_RNA_final_counts.config.exampleConfig.tsv.gz | sort);
        else
            join -e 0 -a1 -a2 -t"$(echo -e '\t')" -o 0 1.2 2.2             <( zcat  results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2_DNA_final_counts.config.exampleConfig.tsv.gz | sort )             <( zcat results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2_RNA_final_counts.config.exampleConfig.tsv.gz  | sort);
        fi  |         awk -v 'OFS=\t' '{if ($2 >= --minCounts 1 && $3 >= --minCounts 1) {print $0}}' |         gzip -c > results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2.merged.config.exampleConfig.tsv.gz 2> results/logs/assigned_counts/fromFile/dna_rna_merge_counts.exampleCount1.HEPG2.2.exampleConfig.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:36 2024]
Finished job 108.
109 of 199 steps (55%) done
Select jobs to execute...

[Sun Jun 23 16:23:36 2024]
rule statistic_counts_BC_in_RNA_DNA_merge:
    input: results/experiments/exampleCount1/statistic/counts/HEPG2_1_filtered_BC_in_RNA_DNA.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_2_filtered_BC_in_RNA_DNA.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_3_filtered_BC_in_RNA_DNA.tsv.gz
    output: results/experiments/exampleCount1/statistic/counts/BC_in_RNA_DNA_filtered.tsv
    log: results/logs/statistic/counts/BC_in_RNA_DNA_merge.exampleCount1.filtered.log
    jobid: 105
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/BC_in_RNA_DNA_filtered.tsv; Input files updated by another job: results/experiments/exampleCount1/statistic/counts/HEPG2_3_filtered_BC_in_RNA_DNA.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_2_filtered_BC_in_RNA_DNA.tsv.gz, results/experiments/exampleCount1/statistic/counts/HEPG2_1_filtered_BC_in_RNA_DNA.tsv.gz
    wildcards: project=exampleCount1, countType=filtered
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount1/statistic/counts/HEPG2_1_filtered_BC_in_RNA_DNA.tsv.gz results/experiments/exampleCount1/statistic/counts/HEPG2_2_filtered_BC_in_RNA_DNA.tsv.gz results/experiments/exampleCount1/statistic/counts/HEPG2_3_filtered_BC_in_RNA_DNA.tsv.gz | sort -k1,1 -k2,2 > results/experiments/exampleCount1/statistic/counts/BC_in_RNA_DNA_filtered.tsv 2> results/logs/statistic/counts/BC_in_RNA_DNA_merge.exampleCount1.filtered.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:36 2024]
Finished job 172.
110 of 199 steps (55%) done
Select jobs to execute...

[Sun Jun 23 16:23:36 2024]
rule statistic_bc_overlap_run:
    input: results/experiments/exampleCount1/counts/HEPG2_1_DNA_final_counts.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_2_DNA_final_counts.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_3_DNA_final_counts.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/BCCounts_betweenReplicates.R
    output: results/experiments/exampleCount1/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv
    log: results/logs/statistic/bc_overlap/run.exampleCount1.HEPG2.DNA.exampleConfig.counts.log
    jobid: 159
    reason: Missing output files: results/experiments/exampleCount1/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_2_DNA_final_counts.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_3_DNA_final_counts.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_1_DNA_final_counts.tsv.gz
    wildcards: project=exampleCount1, raw_or_assigned=counts, condition=HEPG2, type=DNA, config=exampleConfig
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/BCCounts_betweenReplicates.R         --outfile results/experiments/exampleCount1/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv         --condition HEPG2_DNA         --files results/experiments/exampleCount1/counts/HEPG2_1_DNA_final_counts.tsv.gz,results/experiments/exampleCount1/counts/HEPG2_2_DNA_final_counts.tsv.gz,results/experiments/exampleCount1/counts/HEPG2_3_DNA_final_counts.tsv.gz --replicates 1,2,3 &> results/logs/statistic/bc_overlap/run.exampleCount1.HEPG2.DNA.exampleConfig.counts.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_
[Sun Jun 23 16:23:36 2024]
Finished job 149.
111 of 199 steps (56%) done
Select jobs to execute...

[Sun Jun 23 16:23:36 2024]
rule counts_dna_rna_merge_counts:
    input: results/experiments/exampleCount1/counts/HEPG2_1_DNA_final_counts.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_1_RNA_final_counts.tsv.gz
    output: results/experiments/exampleCount1/counts/HEPG2_1.merged.config.exampleConfig.tsv.gz
    log: results/logs/counts/dna_rna_merge_counts.exampleCount1.HEPG2.1.exampleConfig.log
    jobid: 128
    reason: Missing output files: results/experiments/exampleCount1/counts/HEPG2_1.merged.config.exampleConfig.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_1_DNA_final_counts.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_1_RNA_final_counts.tsv.gz
    wildcards: project=exampleCount1, raw_or_assigned=counts, condition=HEPG2, replicate=1, config=exampleConfig
    resources: tmpdir=/tmp


        zero=false;
        if [[ -z "${zero//false}" ]]
        then
            join -1 1 -2 1 -t"$(echo -e '\t')"             <( zcat  results/experiments/exampleCount1/counts/HEPG2_1_DNA_final_counts.tsv.gz | sort )             <( zcat results/experiments/exampleCount1/counts/HEPG2_1_RNA_final_counts.tsv.gz | sort);
        else
            join -e 0 -a1 -a2 -t"$(echo -e '\t')" -o 0 1.2 2.2             <( zcat  results/experiments/exampleCount1/counts/HEPG2_1_DNA_final_counts.tsv.gz | sort )             <( zcat results/experiments/exampleCount1/counts/HEPG2_1_RNA_final_counts.tsv.gz  | sort);
        fi  |         awk -v 'OFS=\t' '{if ($2 >= --minCounts 1 && $3 >= --minCounts 1) {print $0}}' |         gzip -c > results/experiments/exampleCount1/counts/HEPG2_1.merged.config.exampleConfig.tsv.gz 2> results/logs/counts/dna_rna_merge_counts.exampleCount1.HEPG2.1.exampleConfig.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:36 2024]
Finished job 105.
112 of 199 steps (56%) done
Select jobs to execute...

[Sun Jun 23 16:23:36 2024]
rule statistic_counts_final:
    input: results/experiments/exampleCount1/statistic/counts/count_filtered.tsv, results/experiments/exampleCount1/statistic/counts/BC_in_RNA_DNA_filtered.tsv, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/combine_count_stats.R
    output: results/experiments/exampleCount1/statistic/counts.filtered.tsv
    log: results/logs/statistic/counts/final.exampleCount1.filtered.log
    jobid: 97
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts.filtered.tsv; Input files updated by another job: results/experiments/exampleCount1/statistic/counts/BC_in_RNA_DNA_filtered.tsv, results/experiments/exampleCount1/statistic/counts/count_filtered.tsv
    wildcards: project=exampleCount1, countType=filtered
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/combine_count_stats.R --count results/experiments/exampleCount1/statistic/counts/count_filtered.tsv --shared results/experiments/exampleCount1/statistic/counts/BC_in_RNA_DNA_filtered.tsv --output results/experiments/exampleCount1/statistic/counts.filtered.tsv > results/logs/statistic/counts/final.exampleCount1.filtered.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_
[Sun Jun 23 16:23:36 2024]
Finished job 137.
113 of 199 steps (57%) done
Select jobs to execute...

[Sun Jun 23 16:23:36 2024]
rule counts_final_counts:
    input: results/experiments/exampleCount1/counts/HEPG2_3_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount1/counts/HEPG2_3_RNA_final_counts.tsv.gz
    log: results/logs/counts/final_counts_umi.exampleCount1.HEPG2.3.RNA.log
    jobid: 52
    reason: Missing output files: results/experiments/exampleCount1/counts/HEPG2_3_RNA_final_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_3_RNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=3, type=RNA
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount1/counts/HEPG2_3_RNA_filtered_counts.tsv.gz | awk '{print $1}' |         uniq -c |         awk -v 'OFS=\t' '{ print $2,$1 }' |         gzip -c > results/experiments/exampleCount1/counts/HEPG2_3_RNA_final_counts.tsv.gz 2> results/logs/counts/final_counts_umi.exampleCount1.HEPG2.3.RNA.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:37 2024]
Finished job 128.
114 of 199 steps (57%) done
Select jobs to execute...

[Sun Jun 23 16:23:37 2024]
rule assigned_counts_dna_rna_merge:
    input: results/experiments/exampleCount1/counts/HEPG2_1.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assignment/fromFile.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_label.py
    output: results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_1_barcode_assigned_counts.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.statistic.tsv.gz
    log: results/logs/assigned_counts/fromFile/dna_rna_merge.exampleCount1.HEPG2.1.exampleConfig.log
    jobid: 179
    reason: Missing output files: results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_1_barcode_assigned_counts.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.statistic.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/assignment/fromFile.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_1.merged.config.exampleConfig.tsv.gz
    wildcards: project=exampleCount1, assignment=fromFile, config=exampleConfig, condition=HEPG2, replicate=1
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_label.py --counts results/experiments/exampleCount1/counts/HEPG2_1.merged.config.exampleConfig.tsv.gz         --minRNACounts 1 --minDNACounts 1         --assignment results/experiments/exampleCount1/assignment/fromFile.tsv.gz         --output results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.tsv.gz         --bcOutput results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_1_barcode_assigned_counts.tsv.gz         --statistic results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.statistic.tsv.gz &> results/logs/assigned_counts/fromFile/dna_rna_merge.exampleCount1.HEPG2.1.exampleConfig.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:37 2024]
Finished job 52.
115 of 199 steps (58%) done
Select jobs to execute...

[Sun Jun 23 16:23:37 2024]
rule statistic_bc_overlap_run:
    input: results/experiments/exampleCount1/counts/HEPG2_1_RNA_final_counts.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_2_RNA_final_counts.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_3_RNA_final_counts.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/BCCounts_betweenReplicates.R
    output: results/experiments/exampleCount1/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_RNA.exampleConfig.tsv
    log: results/logs/statistic/bc_overlap/run.exampleCount1.HEPG2.RNA.exampleConfig.counts.log
    jobid: 160
    reason: Missing output files: results/experiments/exampleCount1/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_RNA.exampleConfig.tsv; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_3_RNA_final_counts.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_1_RNA_final_counts.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_2_RNA_final_counts.tsv.gz
    wildcards: project=exampleCount1, raw_or_assigned=counts, condition=HEPG2, type=RNA, config=exampleConfig
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/BCCounts_betweenReplicates.R         --outfile results/experiments/exampleCount1/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_RNA.exampleConfig.tsv         --condition HEPG2_RNA         --files results/experiments/exampleCount1/counts/HEPG2_1_RNA_final_counts.tsv.gz,results/experiments/exampleCount1/counts/HEPG2_2_RNA_final_counts.tsv.gz,results/experiments/exampleCount1/counts/HEPG2_3_RNA_final_counts.tsv.gz --replicates 1,2,3 &> results/logs/statistic/bc_overlap/run.exampleCount1.HEPG2.RNA.exampleConfig.counts.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_
[Sun Jun 23 16:23:37 2024]
Finished job 85.
116 of 199 steps (58%) done
Select jobs to execute...

[Sun Jun 23 16:23:37 2024]
rule statistic_counts_barcode_base_composition:
    input: results/experiments/exampleCount1/counts/HEPG2_3_RNA_final_counts.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/nucleotideCountPerPosition.py
    output: results/experiments/exampleCount1/counts/HEPG2_3_RNA_final.BC.tsv.gz, results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_3_RNA.tsv.gz
    log: results/logs/statistic/counts/barcode_base_composition.exampleCount1.HEPG2_3_RNA.log
    jobid: 51
    reason: Missing output files: results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_3_RNA.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_3_RNA_final_counts.tsv.gz
    wildcards: project=exampleCount1, condition=HEPG2, replicate=3, type=RNA
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount1/counts/HEPG2_3_RNA_final_counts.tsv.gz | awk '{print $1}' | gzip -c > results/experiments/exampleCount1/counts/HEPG2_3_RNA_final.BC.tsv.gz;
        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/nucleotideCountPerPosition.py         --column 1         --chunksize 100000         --input results/experiments/exampleCount1/counts/HEPG2_3_RNA_final.BC.tsv.gz         --output results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_3_RNA.tsv.gz &> results/logs/statistic/counts/barcode_base_composition.exampleCount1.HEPG2_3_RNA.log
        
[Sun Jun 23 16:23:37 2024]
Finished job 26.
117 of 199 steps (59%) done
Select jobs to execute...
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_

[Sun Jun 23 16:23:37 2024]
rule counts_dna_rna_merge_counts:
    input: results/experiments/exampleCount1/counts/HEPG2_3_DNA_final_counts.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_3_RNA_final_counts.tsv.gz
    output: results/experiments/exampleCount1/counts/HEPG2_3.merged.config.exampleConfig.tsv.gz
    log: results/logs/counts/dna_rna_merge_counts.exampleCount1.HEPG2.3.exampleConfig.log
    jobid: 130
    reason: Missing output files: results/experiments/exampleCount1/counts/HEPG2_3.merged.config.exampleConfig.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_3_DNA_final_counts.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_3_RNA_final_counts.tsv.gz
    wildcards: project=exampleCount1, raw_or_assigned=counts, condition=HEPG2, replicate=3, config=exampleConfig
    resources: tmpdir=/tmp


        zero=false;
        if [[ -z "${zero//false}" ]]
        then
            join -1 1 -2 1 -t"$(echo -e '\t')"             <( zcat  results/experiments/exampleCount1/counts/HEPG2_3_DNA_final_counts.tsv.gz | sort )             <( zcat results/experiments/exampleCount1/counts/HEPG2_3_RNA_final_counts.tsv.gz | sort);
        else
            join -e 0 -a1 -a2 -t"$(echo -e '\t')" -o 0 1.2 2.2             <( zcat  results/experiments/exampleCount1/counts/HEPG2_3_DNA_final_counts.tsv.gz | sort )             <( zcat results/experiments/exampleCount1/counts/HEPG2_3_RNA_final_counts.tsv.gz  | sort);
        fi  |         awk -v 'OFS=\t' '{if ($2 >= --minCounts 1 && $3 >= --minCounts 1) {print $0}}' |         gzip -c > results/experiments/exampleCount1/counts/HEPG2_3.merged.config.exampleConfig.tsv.gz 2> results/logs/counts/dna_rna_merge_counts.exampleCount1.HEPG2.3.exampleConfig.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:37 2024]
Finished job 41.
118 of 199 steps (59%) done
Select jobs to execute...

[Sun Jun 23 16:23:37 2024]
rule assigned_counts_assignBarcodes:
    input: results/experiments/exampleCount1/counts/HEPG2_3_RNA_final_counts.tsv.gz, results/experiments/exampleCount1/assignment/fromFile.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_BC_and_assignment.py
    output: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3_RNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_3_RNA_exampleConfig.statistic.tsv.gz
    log: results/logs/assigned_counts/assignBarcodes.exampleCount1.HEPG2.3.RNA.exampleConfig.fromFile.log
    jobid: 154
    reason: Missing output files: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3_RNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_3_RNA_exampleConfig.statistic.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/assignment/fromFile.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_3_RNA_final_counts.tsv.gz
    wildcards: project=exampleCount1, assignment=fromFile, condition=HEPG2, replicate=3, type=RNA, config=exampleConfig
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_BC_and_assignment.py --counts results/experiments/exampleCount1/counts/HEPG2_3_RNA_final_counts.tsv.gz         --assignment results/experiments/exampleCount1/assignment/fromFile.tsv.gz         --output results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3_RNA_final_counts.config.exampleConfig.tsv.gz         --statistic results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_3_RNA_exampleConfig.statistic.tsv.gz         --name HEPG2_3_RNA &> results/logs/assigned_counts/assignBarcodes.exampleCount1.HEPG2.3.RNA.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:38 2024]
Finished job 130.
119 of 199 steps (60%) done
Select jobs to execute...

[Sun Jun 23 16:23:38 2024]
rule statistic_correlation_bc_counts_hist:
    input: results/experiments/exampleCount1/counts/HEPG2_1.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_2.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_3.merged.config.exampleConfig.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/plot_perBCCounts_stats.R
    output: results/experiments/exampleCount1/statistic/barcode/counts/HEPG2_exampleConfig_DNA_perBarcode.png, results/experiments/exampleCount1/statistic/barcode/counts/HEPG2_exampleConfig_RNA_perBarcode.png
    log: results/logs/statistic/correlation/correlate_bc_counts_hist.exampleCount1.HEPG2.exampleConfig.counts.log
    jobid: 132
    reason: Missing output files: results/experiments/exampleCount1/statistic/barcode/counts/HEPG2_exampleConfig_RNA_perBarcode.png, results/experiments/exampleCount1/statistic/barcode/counts/HEPG2_exampleConfig_DNA_perBarcode.png; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_1.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_2.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_3.merged.config.exampleConfig.tsv.gz
    wildcards: project=exampleCount1, raw_or_assigned=counts, condition=HEPG2, config=exampleConfig
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/plot_perBCCounts_stats.R         --outdir results/experiments/exampleCount1/statistic/barcode/counts/HEPG2_exampleConfig         --condition HEPG2         --mindnacounts 1 --minrnacounts 1         --files results/experiments/exampleCount1/counts/HEPG2_1.merged.config.exampleConfig.tsv.gz,results/experiments/exampleCount1/counts/HEPG2_2.merged.config.exampleConfig.tsv.gz,results/experiments/exampleCount1/counts/HEPG2_3.merged.config.exampleConfig.tsv.gz --replicates 1,2,3 &> results/logs/statistic/correlation/correlate_bc_counts_hist.exampleCount1.HEPG2.exampleConfig.counts.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_
[Sun Jun 23 16:23:38 2024]
Finished job 97.
120 of 199 steps (60%) done
Select jobs to execute...

[Sun Jun 23 16:23:38 2024]
rule assigned_counts_dna_rna_merge:
    input: results/experiments/exampleCount1/counts/HEPG2_3.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assignment/fromFile.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_label.py
    output: results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_3_barcode_assigned_counts.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.statistic.tsv.gz
    log: results/logs/assigned_counts/fromFile/dna_rna_merge.exampleCount1.HEPG2.3.exampleConfig.log
    jobid: 181
    reason: Missing output files: results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_3_barcode_assigned_counts.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.statistic.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/assignment/fromFile.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_3.merged.config.exampleConfig.tsv.gz
    wildcards: project=exampleCount1, assignment=fromFile, config=exampleConfig, condition=HEPG2, replicate=3
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_label.py --counts results/experiments/exampleCount1/counts/HEPG2_3.merged.config.exampleConfig.tsv.gz         --minRNACounts 1 --minDNACounts 1         --assignment results/experiments/exampleCount1/assignment/fromFile.tsv.gz         --output results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.tsv.gz         --bcOutput results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_3_barcode_assigned_counts.tsv.gz         --statistic results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.statistic.tsv.gz &> results/logs/assigned_counts/fromFile/dna_rna_merge.exampleCount1.HEPG2.3.exampleConfig.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:40 2024]
Finished job 159.
121 of 199 steps (61%) done
Select jobs to execute...

[Sun Jun 23 16:23:40 2024]
rule statistic_correlation_bc_counts:
    input: results/experiments/exampleCount1/counts/HEPG2_1.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_2.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_3.merged.config.exampleConfig.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/plot_perBCCounts_correlation.R
    output: results/experiments/exampleCount1/statistic/barcode/counts/HEPG2_exampleConfig_barcode_DNA_pairwise.png, results/experiments/exampleCount1/statistic/barcode/counts/HEPG2_exampleConfig_barcode_RNA_pairwise.png, results/experiments/exampleCount1/statistic/barcode/counts/HEPG2_exampleConfig_barcode_Ratio_pairwise.png, results/experiments/exampleCount1/statistic/barcode/counts/HEPG2_exampleConfig_barcode_correlation.tsv
    log: results/logs/statistic/correlation/correlate_bc_counts.exampleCount1.HEPG2.exampleConfig.counts.log
    jobid: 127
    reason: Missing output files: results/experiments/exampleCount1/statistic/barcode/counts/HEPG2_exampleConfig_barcode_correlation.tsv; Input files updated by another job: results/experiments/exampleCount1/counts/HEPG2_1.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_2.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/counts/HEPG2_3.merged.config.exampleConfig.tsv.gz
    wildcards: project=exampleCount1, raw_or_assigned=counts, condition=HEPG2, config=exampleConfig
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/plot_perBCCounts_correlation.R         --outdir results/experiments/exampleCount1/statistic/barcode/counts/HEPG2_exampleConfig         --condition HEPG2         --mindnacounts 1 --minrnacounts 1         --files results/experiments/exampleCount1/counts/HEPG2_1.merged.config.exampleConfig.tsv.gz,results/experiments/exampleCount1/counts/HEPG2_2.merged.config.exampleConfig.tsv.gz,results/experiments/exampleCount1/counts/HEPG2_3.merged.config.exampleConfig.tsv.gz --replicates 1,2,3 &> results/logs/statistic/correlation/correlate_bc_counts.exampleCount1.HEPG2.exampleConfig.counts.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_
[Sun Jun 23 16:23:40 2024]
Finished job 160.
122 of 199 steps (61%) done
Select jobs to execute...

[Sun Jun 23 16:23:40 2024]
rule statistic_bc_overlap_combine_counts:
    input: results/experiments/exampleCount1/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv, results/experiments/exampleCount1/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_RNA.exampleConfig.tsv
    output: results/experiments/exampleCount1/statistic/bc_overlap.counts.exampleConfig.tsv
    log: results/logs/statistic/bc_overlap/combine_counts.exampleCount1.exampleConfig.log
    jobid: 158
    reason: Missing output files: results/experiments/exampleCount1/statistic/bc_overlap.counts.exampleConfig.tsv; Input files updated by another job: results/experiments/exampleCount1/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv, results/experiments/exampleCount1/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_RNA.exampleConfig.tsv
    wildcards: project=exampleCount1, config=exampleConfig
    resources: tmpdir=/tmp


        set +o pipefail;
        (
            cat results/experiments/exampleCount1/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv | head -n 1;
            for i in results/experiments/exampleCount1/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv results/experiments/exampleCount1/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_RNA.exampleConfig.tsv; do
                cat $i | tail -n +2
            done;
        ) > results/experiments/exampleCount1/statistic/bc_overlap.counts.exampleConfig.tsv 2> results/logs/statistic/bc_overlap/combine_counts.exampleCount1.exampleConfig.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:41 2024]
Finished job 158.
123 of 199 steps (62%) done
Select jobs to execute...

[Sun Jun 23 16:23:41 2024]
rule counts_dna_rna_merge_counts:
    input: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1_RNA_final_counts.config.exampleConfig.tsv.gz
    output: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1.merged.config.exampleConfig.tsv.gz
    log: results/logs/assigned_counts/fromFile/dna_rna_merge_counts.exampleCount.HEPG2.1.exampleConfig.log
    jobid: 134
    reason: Missing output files: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1.merged.config.exampleConfig.tsv.gz; Input files updated by another job: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1_RNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1_DNA_final_counts.config.exampleConfig.tsv.gz
    wildcards: project=exampleCount, raw_or_assigned=assigned_counts/fromFile, condition=HEPG2, replicate=1, config=exampleConfig
    resources: tmpdir=/tmp


        zero=false;
        if [[ -z "${zero//false}" ]]
        then
            join -1 1 -2 1 -t"$(echo -e '\t')"             <( zcat  results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1_DNA_final_counts.config.exampleConfig.tsv.gz | sort )             <( zcat results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1_RNA_final_counts.config.exampleConfig.tsv.gz | sort);
        else
            join -e 0 -a1 -a2 -t"$(echo -e '\t')" -o 0 1.2 2.2             <( zcat  results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1_DNA_final_counts.config.exampleConfig.tsv.gz | sort )             <( zcat results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1_RNA_final_counts.config.exampleConfig.tsv.gz  | sort);
        fi  |         awk -v 'OFS=\t' '{if ($2 >= --minCounts 1 && $3 >= --minCounts 1) {print $0}}' |         gzip -c > results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1.merged.config.exampleConfig.tsv.gz 2> results/logs/assigned_counts/fromFile/dna_rna_merge_counts.exampleCount.HEPG2.1.exampleConfig.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:41 2024]
Finished job 179.
124 of 199 steps (62%) done
Select jobs to execute...

[Sun Jun 23 16:23:41 2024]
rule counts_final_counts:
    input: results/experiments/exampleCount/counts/HEPG2_2_DNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount/counts/HEPG2_2_DNA_final_counts.tsv.gz
    log: results/logs/counts/final_counts_umi.exampleCount.HEPG2.2.DNA.log
    jobid: 17
    reason: Missing output files: results/experiments/exampleCount/counts/HEPG2_2_DNA_final_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_2_DNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=2, type=DNA
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount/counts/HEPG2_2_DNA_filtered_counts.tsv.gz | awk '{print $1}' |         uniq -c |         awk -v 'OFS=\t' '{ print $2,$1 }' |         gzip -c > results/experiments/exampleCount/counts/HEPG2_2_DNA_final_counts.tsv.gz 2> results/logs/counts/final_counts_umi.exampleCount.HEPG2.2.DNA.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:41 2024]
Finished job 134.
125 of 199 steps (63%) done
[Sun Jun 23 16:23:41 2024]
Finished job 17.
126 of 199 steps (63%) done
Select jobs to execute...

[Sun Jun 23 16:23:41 2024]
rule statistic_bc_overlap_run:
    input: results/experiments/exampleCount/counts/HEPG2_1_DNA_final_counts.tsv.gz, results/experiments/exampleCount/counts/HEPG2_2_DNA_final_counts.tsv.gz, results/experiments/exampleCount/counts/HEPG2_3_DNA_final_counts.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/BCCounts_betweenReplicates.R
    output: results/experiments/exampleCount/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv
    log: results/logs/statistic/bc_overlap/run.exampleCount.HEPG2.DNA.exampleConfig.counts.log
    jobid: 156
    reason: Missing output files: results/experiments/exampleCount/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_3_DNA_final_counts.tsv.gz, results/experiments/exampleCount/counts/HEPG2_1_DNA_final_counts.tsv.gz, results/experiments/exampleCount/counts/HEPG2_2_DNA_final_counts.tsv.gz
    wildcards: project=exampleCount, raw_or_assigned=counts, condition=HEPG2, type=DNA, config=exampleConfig
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/BCCounts_betweenReplicates.R         --outfile results/experiments/exampleCount/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv         --condition HEPG2_DNA         --files results/experiments/exampleCount/counts/HEPG2_1_DNA_final_counts.tsv.gz,results/experiments/exampleCount/counts/HEPG2_2_DNA_final_counts.tsv.gz,results/experiments/exampleCount/counts/HEPG2_3_DNA_final_counts.tsv.gz --replicates 1,2,3 &> results/logs/statistic/bc_overlap/run.exampleCount.HEPG2.DNA.exampleConfig.counts.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_

[Sun Jun 23 16:23:41 2024]
rule statistic_counts_barcode_base_composition:
    input: results/experiments/exampleCount/counts/HEPG2_2_DNA_final_counts.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/nucleotideCountPerPosition.py
    output: results/experiments/exampleCount/counts/HEPG2_2_DNA_final.BC.tsv.gz, results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_2_DNA.tsv.gz
    log: results/logs/statistic/counts/barcode_base_composition.exampleCount.HEPG2_2_DNA.log
    jobid: 16
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_2_DNA.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_2_DNA_final_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=2, type=DNA
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount/counts/HEPG2_2_DNA_final_counts.tsv.gz | awk '{print $1}' | gzip -c > results/experiments/exampleCount/counts/HEPG2_2_DNA_final.BC.tsv.gz;
        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/nucleotideCountPerPosition.py         --column 1         --chunksize 100000         --input results/experiments/exampleCount/counts/HEPG2_2_DNA_final.BC.tsv.gz         --output results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_2_DNA.tsv.gz &> results/logs/statistic/counts/barcode_base_composition.exampleCount.HEPG2_2_DNA.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:41 2024]
Finished job 181.
127 of 199 steps (64%) done
Select jobs to execute...

[Sun Jun 23 16:23:42 2024]
rule statistic_correlation_hist_box_plots:
    input: results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/plot_perInsertCounts_stats.R
    output: results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_all_barcodesPerInsert_box.png, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_all_barcodesPerInsert_box_minThreshold.png, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_group_barcodesPerInsert_box.png, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_group_barcodesPerInsert_box_minThreshold.png
    log: results/logs/statistic/correlation/hist_box_plots.exampleCount1.HEPG2.exampleConfig.fromFile.log
    jobid: 188
    reason: Missing output files: results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_group_barcodesPerInsert_box.png, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_all_barcodesPerInsert_box.png, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_group_barcodesPerInsert_box_minThreshold.png, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_all_barcodesPerInsert_box_minThreshold.png; Input files updated by another job: results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.tsv.gz
    wildcards: project=exampleCount1, assignment=fromFile, config=exampleConfig, condition=HEPG2
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/plot_perInsertCounts_stats.R         --condition HEPG2                  --files results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.tsv.gz,results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.tsv.gz,results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.tsv.gz         --replicates 1,2,3         --threshold 30         --outdir results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2 &> results/logs/statistic/correlation/hist_box_plots.exampleCount1.HEPG2.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_
[Sun Jun 23 16:23:44 2024]
Finished job 148.
128 of 199 steps (64%) done
Select jobs to execute...

[Sun Jun 23 16:23:44 2024]
rule assigned_counts_make_master_tables:
    input: results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/make_master_tables.R
    output: results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_average_allreps_merged.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_minThreshold_merged.tsv.gz
    log: results/logs/assigned_counts/make_master_tables.exampleCount1.HEPG2.exampleConfig.fromFile.log
    jobid: 178
    reason: Missing output files: results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_minThreshold_merged.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.tsv.gz
    wildcards: project=exampleCount1, assignment=fromFile, config=exampleConfig, condition=HEPG2
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/make_master_tables.R         --condition HEPG2         --threshold 30         --files results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.tsv.gz,results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.tsv.gz,results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.tsv.gz         --replicates 1,2,3         --output results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_minThreshold_merged.tsv.gz         --output-all results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.tsv.gz         --statistic results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_average_allreps_merged.tsv.gz &> results/logs/assigned_counts/make_master_tables.exampleCount1.HEPG2.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_
[Sun Jun 23 16:23:44 2024]
Finished job 1.
129 of 199 steps (65%) done
Select jobs to execute...

[Sun Jun 23 16:23:44 2024]
rule counts_dna_rna_merge_counts:
    input: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1_RNA_final_counts.config.exampleConfig.tsv.gz
    output: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1.merged.config.exampleConfig.tsv.gz
    log: results/logs/assigned_counts/fromFile/dna_rna_merge_counts.exampleCount1.HEPG2.1.exampleConfig.log
    jobid: 145
    reason: Missing output files: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1.merged.config.exampleConfig.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1_RNA_final_counts.config.exampleConfig.tsv.gz
    wildcards: project=exampleCount1, raw_or_assigned=assigned_counts/fromFile, condition=HEPG2, replicate=1, config=exampleConfig
    resources: tmpdir=/tmp


        zero=false;
        if [[ -z "${zero//false}" ]]
        then
            join -1 1 -2 1 -t"$(echo -e '\t')"             <( zcat  results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1_DNA_final_counts.config.exampleConfig.tsv.gz | sort )             <( zcat results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1_RNA_final_counts.config.exampleConfig.tsv.gz | sort);
        else
            join -e 0 -a1 -a2 -t"$(echo -e '\t')" -o 0 1.2 2.2             <( zcat  results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1_DNA_final_counts.config.exampleConfig.tsv.gz | sort )             <( zcat results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1_RNA_final_counts.config.exampleConfig.tsv.gz  | sort);
        fi  |         awk -v 'OFS=\t' '{if ($2 >= --minCounts 1 && $3 >= --minCounts 1) {print $0}}' |         gzip -c > results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1.merged.config.exampleConfig.tsv.gz 2> results/logs/assigned_counts/fromFile/dna_rna_merge_counts.exampleCount1.HEPG2.1.exampleConfig.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:44 2024]
Finished job 156.
130 of 199 steps (65%) done
Select jobs to execute...

[Sun Jun 23 16:23:44 2024]
rule assigned_counts_combine_replicates_barcode_output:
    input: results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_1_barcode_assigned_counts.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_2_barcode_assigned_counts.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_3_barcode_assigned_counts.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_replicates_barcode_counts.py
    output: results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged_barcode_assigned_counts.tsv.gz
    log: results/logs/assigned_counts/combine_replicates_barcode_output.exampleCount1.HEPG2.exampleConfig.fromFile.log
    jobid: 184
    reason: Missing output files: results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged_barcode_assigned_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_1_barcode_assigned_counts.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_2_barcode_assigned_counts.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_3_barcode_assigned_counts.tsv.gz
    wildcards: project=exampleCount1, assignment=fromFile, config=exampleConfig, condition=HEPG2
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_replicates_barcode_counts.py --counts results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_1_barcode_assigned_counts.tsv.gz --counts results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_2_barcode_assigned_counts.tsv.gz --counts results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_3_barcode_assigned_counts.tsv.gz         --threshold 30         --replicate 1 --replicate 2 --replicate 3          --output results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged_barcode_assigned_counts.tsv.gz &> results/logs/assigned_counts/combine_replicates_barcode_output.exampleCount1.HEPG2.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:44 2024]
Finished job 132.
131 of 199 steps (66%) done
Select jobs to execute...

[Sun Jun 23 16:23:44 2024]
rule assigned_counts_assignBarcodes:
    input: results/experiments/exampleCount/counts/HEPG2_2_DNA_final_counts.tsv.gz, results/experiments/exampleCount/assignment/fromFile.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_BC_and_assignment.py
    output: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_2_DNA_exampleConfig.statistic.tsv.gz
    log: results/logs/assigned_counts/assignBarcodes.exampleCount.HEPG2.2.DNA.exampleConfig.fromFile.log
    jobid: 139
    reason: Missing output files: results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_2_DNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2_DNA_final_counts.config.exampleConfig.tsv.gz; Input files updated by another job: results/experiments/exampleCount/assignment/fromFile.tsv.gz, results/experiments/exampleCount/counts/HEPG2_2_DNA_final_counts.tsv.gz
    wildcards: project=exampleCount, assignment=fromFile, condition=HEPG2, replicate=2, type=DNA, config=exampleConfig
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_BC_and_assignment.py --counts results/experiments/exampleCount/counts/HEPG2_2_DNA_final_counts.tsv.gz         --assignment results/experiments/exampleCount/assignment/fromFile.tsv.gz         --output results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2_DNA_final_counts.config.exampleConfig.tsv.gz         --statistic results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_2_DNA_exampleConfig.statistic.tsv.gz         --name HEPG2_2_DNA &> results/logs/assigned_counts/assignBarcodes.exampleCount.HEPG2.2.DNA.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:45 2024]
Finished job 145.
132 of 199 steps (66%) done
Select jobs to execute...

[Sun Jun 23 16:23:45 2024]
rule statistic_correlation_calculate:
    input: results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/plot_perInsertCounts_correlation.R
    output: results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_DNA_pairwise.png, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_RNA_pairwise.png, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_Ratio_pairwise.png, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_DNA_pairwise_minThreshold.png, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_RNA_pairwise_minThreshold.png, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_Ratio_pairwise_minThreshold.png, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_correlation.tsv, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_correlation_minThreshold.tsv
    log: results/logs/statistic/correlation/calculate.exampleCount1.HEPG2.exampleConfig.fromFile.log
    jobid: 196
    reason: Missing output files: results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_correlation_minThreshold.tsv, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_correlation.tsv; Input files updated by another job: results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.tsv.gz
    wildcards: project=exampleCount1, assignment=fromFile, config=exampleConfig, condition=HEPG2
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/plot_perInsertCounts_correlation.R         --condition HEPG2                  --files results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.tsv.gz,results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.tsv.gz,results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.tsv.gz         --replicates 1,2,3         --threshold 30         --outdir results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2 &> results/logs/statistic/correlation/calculate.exampleCount1.HEPG2.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_
[Sun Jun 23 16:23:46 2024]
Finished job 178.
133 of 199 steps (67%) done
Select jobs to execute...

[Sun Jun 23 16:23:46 2024]
rule assigned_counts_combine_replicates:
    input: results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_minThreshold_merged.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/combine_replicates.py
    output: results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_minThreshold_merged.combined.tsv.gz
    log: results/logs/assigned_counts/combine_replicates.exampleCount1.HEPG2.exampleConfig.fromFile.allreps_minThreshold.log
    jobid: 183
    reason: Missing output files: results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_minThreshold_merged.combined.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_minThreshold_merged.tsv.gz
    wildcards: project=exampleCount1, assignment=fromFile, config=exampleConfig, condition=HEPG2, allreps_or_threshold=allreps_minThreshold
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/combine_replicates.py         --input results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_minThreshold_merged.tsv.gz                  --output results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_minThreshold_merged.combined.tsv.gz  &> results/logs/assigned_counts/combine_replicates.exampleCount1.HEPG2.exampleConfig.fromFile.allreps_minThreshold.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:46 2024]
Finished job 183.
134 of 199 steps (67%) done
Select jobs to execute...

[Sun Jun 23 16:23:46 2024]
rule assigned_counts_combine_replicates:
    input: results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/combine_replicates.py
    output: results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.combined.tsv.gz
    log: results/logs/assigned_counts/combine_replicates.exampleCount1.HEPG2.exampleConfig.fromFile.allreps.log
    jobid: 182
    reason: Missing output files: results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.combined.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.tsv.gz
    wildcards: project=exampleCount1, assignment=fromFile, config=exampleConfig, condition=HEPG2, allreps_or_threshold=allreps
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/combine_replicates.py         --input results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.tsv.gz                  --output results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.combined.tsv.gz  &> results/logs/assigned_counts/combine_replicates.exampleCount1.HEPG2.exampleConfig.fromFile.allreps.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:47 2024]
Finished job 31.
135 of 199 steps (68%) done
Select jobs to execute...

[Sun Jun 23 16:23:47 2024]
rule statistic_assigned_counts_combine_stats_dna_rna_merge:
    input: results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.statistic.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.statistic.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.statistic.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_statistic_tables.py
    output: results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/combined/HEPG2_merged_assigned_counts.statistic.tsv.gz
    log: results/logs/statistic/assigned_counts/combine_stats_dna_rna_merge.exampleCount1.HEPG2.exampleConfig.fromFile.log
    jobid: 190
    reason: Missing output files: results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/combined/HEPG2_merged_assigned_counts.statistic.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.statistic.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.statistic.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.statistic.tsv.gz
    wildcards: project=exampleCount1, assignment=fromFile, config=exampleConfig, condition=HEPG2
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_statistic_tables.py         --condition HEPG2         --statistic 1 results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.statistic.tsv.gz --statistic 2 results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.statistic.tsv.gz --statistic 3 results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.statistic.tsv.gz         --output results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/combined/HEPG2_merged_assigned_counts.statistic.tsv.gz &> results/logs/statistic/assigned_counts/combine_stats_dna_rna_merge.exampleCount1.HEPG2.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:23:47 2024]
Finished job 190.
136 of 199 steps (68%) done
Select jobs to execute...

[Sun Jun 23 16:23:47 2024]
rule statistic_assigned_counts_combine_stats_dna_rna_merge_all:
    input: results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/combined/HEPG2_merged_assigned_counts.statistic.tsv.gz
    output: results/experiments/exampleCount1/statistic/statistic_assigned_counts_merged_fromFile_exampleConfig.tsv
    log: results/logs/statistic/assigned_counts/combine_stats_dna_rna_merge_all.exampleCount1.exampleConfig.fromFile.log
    jobid: 189
    reason: Missing output files: results/experiments/exampleCount1/statistic/statistic_assigned_counts_merged_fromFile_exampleConfig.tsv; Input files updated by another job: results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/combined/HEPG2_merged_assigned_counts.statistic.tsv.gz
    wildcards: project=exampleCount1, assignment=fromFile, config=exampleConfig
    resources: tmpdir=/tmp


        set +o pipefail;
        (
            zcat results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/combined/HEPG2_merged_assigned_counts.statistic.tsv.gz | head -n 1;
            for i in results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/combined/HEPG2_merged_assigned_counts.statistic.tsv.gz; do
                zcat $i | tail -n +2
            done
        ) > results/experiments/exampleCount1/statistic/statistic_assigned_counts_merged_fromFile_exampleConfig.tsv 2> results/logs/statistic/assigned_counts/combine_stats_dna_rna_merge_all.exampleCount1.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:47 2024]
Finished job 184.
137 of 199 steps (69%) done
[Sun Jun 23 16:23:47 2024]
Finished job 182.
138 of 199 steps (69%) done
[Sun Jun 23 16:23:47 2024]
Finished job 189.
139 of 199 steps (70%) done
[Sun Jun 23 16:23:50 2024]
Finished job 154.
140 of 199 steps (70%) done
Select jobs to execute...

[Sun Jun 23 16:23:50 2024]
rule counts_dna_rna_merge_counts:
    input: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3_RNA_final_counts.config.exampleConfig.tsv.gz
    output: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3.merged.config.exampleConfig.tsv.gz
    log: results/logs/assigned_counts/fromFile/dna_rna_merge_counts.exampleCount1.HEPG2.3.exampleConfig.log
    jobid: 152
    reason: Missing output files: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3.merged.config.exampleConfig.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3_RNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3_DNA_final_counts.config.exampleConfig.tsv.gz
    wildcards: project=exampleCount1, raw_or_assigned=assigned_counts/fromFile, condition=HEPG2, replicate=3, config=exampleConfig
    resources: tmpdir=/tmp


        zero=false;
        if [[ -z "${zero//false}" ]]
        then
            join -1 1 -2 1 -t"$(echo -e '\t')"             <( zcat  results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3_DNA_final_counts.config.exampleConfig.tsv.gz | sort )             <( zcat results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3_RNA_final_counts.config.exampleConfig.tsv.gz | sort);
        else
            join -e 0 -a1 -a2 -t"$(echo -e '\t')" -o 0 1.2 2.2             <( zcat  results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3_DNA_final_counts.config.exampleConfig.tsv.gz | sort )             <( zcat results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3_RNA_final_counts.config.exampleConfig.tsv.gz  | sort);
        fi  |         awk -v 'OFS=\t' '{if ($2 >= --minCounts 1 && $3 >= --minCounts 1) {print $0}}' |         gzip -c > results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3.merged.config.exampleConfig.tsv.gz 2> results/logs/assigned_counts/fromFile/dna_rna_merge_counts.exampleCount1.HEPG2.3.exampleConfig.log
        

Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:50 2024]
rule statistic_bc_overlap_run:
    input: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1_RNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2_RNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3_RNA_final_counts.config.exampleConfig.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/BCCounts_betweenReplicates.R
    output: results/experiments/exampleCount1/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_RNA.exampleConfig.tsv
    log: results/logs/statistic/bc_overlap/run.exampleCount1.HEPG2.RNA.exampleConfig.assigned_counts/fromFile.log
    jobid: 170
    reason: Missing output files: results/experiments/exampleCount1/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_RNA.exampleConfig.tsv; Input files updated by another job: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2_RNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3_RNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1_RNA_final_counts.config.exampleConfig.tsv.gz
    wildcards: project=exampleCount1, raw_or_assigned=assigned_counts/fromFile, condition=HEPG2, type=RNA, config=exampleConfig
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/BCCounts_betweenReplicates.R         --outfile results/experiments/exampleCount1/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_RNA.exampleConfig.tsv         --condition HEPG2_RNA         --files results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1_RNA_final_counts.config.exampleConfig.tsv.gz,results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2_RNA_final_counts.config.exampleConfig.tsv.gz,results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3_RNA_final_counts.config.exampleConfig.tsv.gz --replicates 1,2,3 &> results/logs/statistic/bc_overlap/run.exampleCount1.HEPG2.RNA.exampleConfig.assigned_counts/fromFile.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_

[Sun Jun 23 16:23:50 2024]
rule statistic_assigned_counts_combine_BC_assignment_stats_helper:
    input: results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_1_DNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_2_DNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_3_DNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_1_RNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_2_RNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_3_RNA_exampleConfig.statistic.tsv.gz
    output: results/experiments/exampleCount1/statistic/assigned_counts/fromFile/helper.HEPG2.exampleConfig.statistic.tsv.gz
    log: results/logs/statistic/assigned_counts/combine_BC_assignment_stats_helper.exampleCount1.HEPG2.exampleConfig.fromFile.log
    jobid: 198
    reason: Missing output files: results/experiments/exampleCount1/statistic/assigned_counts/fromFile/helper.HEPG2.exampleConfig.statistic.tsv.gz; Input files updated by another job: results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_1_DNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_2_DNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_2_RNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_1_RNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_3_DNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_3_RNA_exampleConfig.statistic.tsv.gz
    wildcards: project=exampleCount1, assignment=fromFile, condition=HEPG2, config=exampleConfig
    resources: tmpdir=/tmp


        set +o pipefail;
        (
            zcat results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_1_DNA_exampleConfig.statistic.tsv.gz | head -n 1;
            for i in results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_1_DNA_exampleConfig.statistic.tsv.gz results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_2_DNA_exampleConfig.statistic.tsv.gz results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_3_DNA_exampleConfig.statistic.tsv.gz results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_1_RNA_exampleConfig.statistic.tsv.gz results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_2_RNA_exampleConfig.statistic.tsv.gz results/experiments/exampleCount1/statistic/assigned_counts/fromFile/HEPG2_3_RNA_exampleConfig.statistic.tsv.gz; do
                zcat $i | tail -n +2
            done;
        ) | gzip -c > results/experiments/exampleCount1/statistic/assigned_counts/fromFile/helper.HEPG2.exampleConfig.statistic.tsv.gz 2> results/logs/statistic/assigned_counts/combine_BC_assignment_stats_helper.exampleCount1.HEPG2.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:50 2024]
Finished job 198.
141 of 199 steps (71%) done
Select jobs to execute...

[Sun Jun 23 16:23:50 2024]
rule statistic_assigned_counts_combine_BC_assignment_stats:
    input: results/experiments/exampleCount1/statistic/assigned_counts/fromFile/helper.HEPG2.exampleConfig.statistic.tsv.gz
    output: results/experiments/exampleCount1/statistic/statistic_assigned_counts_single_fromFile_exampleConfig.tsv
    log: results/logs/statistic/assigned_counts/combine_BC_assignment_stats.exampleCount1.fromFile_exampleConfig.log
    jobid: 197
    reason: Missing output files: results/experiments/exampleCount1/statistic/statistic_assigned_counts_single_fromFile_exampleConfig.tsv; Input files updated by another job: results/experiments/exampleCount1/statistic/assigned_counts/fromFile/helper.HEPG2.exampleConfig.statistic.tsv.gz
    wildcards: project=exampleCount1, assignment=fromFile, config=exampleConfig
    resources: tmpdir=/tmp


        set +o pipefail;
        (
            zcat results/experiments/exampleCount1/statistic/assigned_counts/fromFile/helper.HEPG2.exampleConfig.statistic.tsv.gz | head -n 1;
            for i in results/experiments/exampleCount1/statistic/assigned_counts/fromFile/helper.HEPG2.exampleConfig.statistic.tsv.gz; do
                zcat $i | tail -n +2
            done;
        ) > results/experiments/exampleCount1/statistic/statistic_assigned_counts_single_fromFile_exampleConfig.tsv 2> results/logs/statistic/assigned_counts/combine_BC_assignment_stats.exampleCount1.fromFile_exampleConfig.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:50 2024]
Finished job 197.
142 of 199 steps (71%) done
[Sun Jun 23 16:23:50 2024]
Finished job 152.
143 of 199 steps (72%) done
Select jobs to execute...

[Sun Jun 23 16:23:50 2024]
rule statistic_correlation_bc_counts:
    input: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3.merged.config.exampleConfig.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/plot_perBCCounts_correlation.R
    output: results/experiments/exampleCount1/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_barcode_DNA_pairwise.png, results/experiments/exampleCount1/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_barcode_RNA_pairwise.png, results/experiments/exampleCount1/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_barcode_Ratio_pairwise.png, results/experiments/exampleCount1/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_barcode_correlation.tsv
    log: results/logs/statistic/correlation/correlate_bc_counts.exampleCount1.HEPG2.exampleConfig.assigned_counts/fromFile.log
    jobid: 167
    reason: Missing output files: results/experiments/exampleCount1/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_barcode_correlation.tsv; Input files updated by another job: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2.merged.config.exampleConfig.tsv.gz
    wildcards: project=exampleCount1, raw_or_assigned=assigned_counts/fromFile, condition=HEPG2, config=exampleConfig
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/plot_perBCCounts_correlation.R         --outdir results/experiments/exampleCount1/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig         --condition HEPG2         --mindnacounts 1 --minrnacounts 1         --files results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1.merged.config.exampleConfig.tsv.gz,results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2.merged.config.exampleConfig.tsv.gz,results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3.merged.config.exampleConfig.tsv.gz --replicates 1,2,3 &> results/logs/statistic/correlation/correlate_bc_counts.exampleCount1.HEPG2.exampleConfig.assigned_counts/fromFile.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_

[Sun Jun 23 16:23:50 2024]
rule statistic_correlation_bc_counts_hist:
    input: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3.merged.config.exampleConfig.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/plot_perBCCounts_stats.R
    output: results/experiments/exampleCount1/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_DNA_perBarcode.png, results/experiments/exampleCount1/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_RNA_perBarcode.png
    log: results/logs/statistic/correlation/correlate_bc_counts_hist.exampleCount1.HEPG2.exampleConfig.assigned_counts/fromFile.log
    jobid: 144
    reason: Missing output files: results/experiments/exampleCount1/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_DNA_perBarcode.png, results/experiments/exampleCount1/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_RNA_perBarcode.png; Input files updated by another job: results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2.merged.config.exampleConfig.tsv.gz
    wildcards: project=exampleCount1, raw_or_assigned=assigned_counts/fromFile, condition=HEPG2, config=exampleConfig
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/plot_perBCCounts_stats.R         --outdir results/experiments/exampleCount1/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig         --condition HEPG2         --mindnacounts 1 --minrnacounts 1         --files results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_1.merged.config.exampleConfig.tsv.gz,results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_2.merged.config.exampleConfig.tsv.gz,results/experiments/exampleCount1/assigned_counts/fromFile/HEPG2_3.merged.config.exampleConfig.tsv.gz --replicates 1,2,3 &> results/logs/statistic/correlation/correlate_bc_counts_hist.exampleCount1.HEPG2.exampleConfig.assigned_counts/fromFile.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_
[Sun Jun 23 16:23:52 2024]
Finished job 51.
144 of 199 steps (72%) done
[Sun Jun 23 16:23:53 2024]
Finished job 170.
145 of 199 steps (73%) done
Select jobs to execute...

[Sun Jun 23 16:23:53 2024]
rule statistic_bc_overlap_combine_assigned_counts:
    input: results/experiments/exampleCount1/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv, results/experiments/exampleCount1/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_RNA.exampleConfig.tsv
    output: results/experiments/exampleCount1/statistic/bc_overlap.assigned_counts.exampleConfig.fromFile.tsv
    log: results/logs/statistic/bc_overlap/combine_assigned_counts.exampleCount1.exampleConfig.fromFile.log
    jobid: 168
    reason: Missing output files: results/experiments/exampleCount1/statistic/bc_overlap.assigned_counts.exampleConfig.fromFile.tsv; Input files updated by another job: results/experiments/exampleCount1/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv, results/experiments/exampleCount1/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_RNA.exampleConfig.tsv
    wildcards: project=exampleCount1, config=exampleConfig, assignment=fromFile
    resources: tmpdir=/tmp


        set +o pipefail;
        (
            cat results/experiments/exampleCount1/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv | head -n 1;
            for i in results/experiments/exampleCount1/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv results/experiments/exampleCount1/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_RNA.exampleConfig.tsv; do
                cat $i | tail -n +2
            done;
        ) > results/experiments/exampleCount1/statistic/bc_overlap.assigned_counts.exampleConfig.fromFile.tsv 2> results/logs/statistic/bc_overlap/combine_assigned_counts.exampleCount1.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:53 2024]
Finished job 168.
146 of 199 steps (73%) done
[Sun Jun 23 16:23:55 2024]
Finished job 144.
147 of 199 steps (74%) done
[Sun Jun 23 16:23:56 2024]
Finished job 139.
148 of 199 steps (74%) done
Select jobs to execute...

[Sun Jun 23 16:23:56 2024]
rule statistic_bc_overlap_run:
    input: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3_DNA_final_counts.config.exampleConfig.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/BCCounts_betweenReplicates.R
    output: results/experiments/exampleCount/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv
    log: results/logs/statistic/bc_overlap/run.exampleCount.HEPG2.DNA.exampleConfig.assigned_counts/fromFile.log
    jobid: 164
    reason: Missing output files: results/experiments/exampleCount/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv; Input files updated by another job: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3_DNA_final_counts.config.exampleConfig.tsv.gz
    wildcards: project=exampleCount, raw_or_assigned=assigned_counts/fromFile, condition=HEPG2, type=DNA, config=exampleConfig
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/BCCounts_betweenReplicates.R         --outfile results/experiments/exampleCount/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv         --condition HEPG2_DNA         --files results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1_DNA_final_counts.config.exampleConfig.tsv.gz,results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2_DNA_final_counts.config.exampleConfig.tsv.gz,results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3_DNA_final_counts.config.exampleConfig.tsv.gz --replicates 1,2,3 &> results/logs/statistic/bc_overlap/run.exampleCount.HEPG2.DNA.exampleConfig.assigned_counts/fromFile.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_
[Sun Jun 23 16:23:57 2024]
Finished job 16.
149 of 199 steps (75%) done
[Sun Jun 23 16:23:58 2024]
Finished job 164.
150 of 199 steps (75%) done
[Sun Jun 23 16:23:59 2024]
Finished job 127.
151 of 199 steps (76%) done
Select jobs to execute...

[Sun Jun 23 16:23:59 2024]
rule statistic_correlation_combine_bc_raw:
    input: results/experiments/exampleCount1/statistic/barcode/counts/HEPG2_exampleConfig_barcode_correlation.tsv
    output: results/experiments/exampleCount1/statistic/statistic_bc_correlation_merged_exampleConfig.tsv
    log: results/logs/statistic/correlation/combine_bc_raw.exampleCount1.exampleConfig.log
    jobid: 126
    reason: Missing output files: results/experiments/exampleCount1/statistic/statistic_bc_correlation_merged_exampleConfig.tsv; Input files updated by another job: results/experiments/exampleCount1/statistic/barcode/counts/HEPG2_exampleConfig_barcode_correlation.tsv
    wildcards: project=exampleCount1, config=exampleConfig
    resources: tmpdir=/tmp


        (
        cat results/experiments/exampleCount1/statistic/barcode/counts/HEPG2_exampleConfig_barcode_correlation.tsv | head -n 1;
        for i in results/experiments/exampleCount1/statistic/barcode/counts/HEPG2_exampleConfig_barcode_correlation.tsv; do
            cat $i | tail -n +2;
        done;
        ) > results/experiments/exampleCount1/statistic/statistic_bc_correlation_merged_exampleConfig.tsv 2> results/logs/statistic/correlation/combine_bc_raw.exampleCount1.exampleConfig.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:23:59 2024]
Finished job 126.
152 of 199 steps (76%) done
[Sun Jun 23 16:24:04 2024]
Finished job 167.
153 of 199 steps (77%) done
Select jobs to execute...

[Sun Jun 23 16:24:04 2024]
rule statistic_correlation_combine_bc_assigned:
    input: results/experiments/exampleCount1/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_barcode_correlation.tsv
    output: results/experiments/exampleCount1/statistic/statistic_assigned_bc_correlation_merged_fromFile_exampleConfig.tsv
    log: results/logs/statistic/correlation/combine_bc_assigned.exampleCount1.fromFile_exampleConfig.log
    jobid: 166
    reason: Missing output files: results/experiments/exampleCount1/statistic/statistic_assigned_bc_correlation_merged_fromFile_exampleConfig.tsv; Input files updated by another job: results/experiments/exampleCount1/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_barcode_correlation.tsv
    wildcards: project=exampleCount1, assignment=fromFile, config=exampleConfig
    resources: tmpdir=/tmp


        (
        cat results/experiments/exampleCount1/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_barcode_correlation.tsv | head -n 1;
        for i in results/experiments/exampleCount1/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_barcode_correlation.tsv; do
            cat $i | tail -n +2;
        done;
        ) > results/experiments/exampleCount1/statistic/statistic_assigned_bc_correlation_merged_fromFile_exampleConfig.tsv 2> results/logs/statistic/correlation/combine_bc_assigned.exampleCount1.fromFile_exampleConfig.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:24:04 2024]
Finished job 166.
154 of 199 steps (77%) done
[Sun Jun 23 16:24:05 2024]
Finished job 196.
155 of 199 steps (78%) done
Select jobs to execute...

[Sun Jun 23 16:24:05 2024]
rule statistic_correlation_combine_oligo:
    input: results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_correlation.tsv, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_correlation_minThreshold.tsv
    output: results/experiments/exampleCount1/statistic/statistic_oligo_correlation_merged_fromFile_exampleConfig.tsv
    log: results/logs/statistic/correlation/combine_oligo.exampleCount1.exampleConfig.fromFile.log
    jobid: 195
    reason: Missing output files: results/experiments/exampleCount1/statistic/statistic_oligo_correlation_merged_fromFile_exampleConfig.tsv; Input files updated by another job: results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_correlation_minThreshold.tsv, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_correlation.tsv
    wildcards: project=exampleCount1, assignment=fromFile, config=exampleConfig
    resources: tmpdir=/tmp


        set +o pipefail;
        (
        cat results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_correlation.tsv | head -n 1 | awk -v 'OFS=\t' '{print $0,"threshold (min 30)"}';
        for i in results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_correlation.tsv; do
            cat $i | tail -n +2 | awk -v 'OFS=\t' '{print $0,"False"}'
        done;
        for i in results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_correlation_minThreshold.tsv; do
            cat $i | tail -n +2 | awk -v 'OFS=\t' '{print $0,"True"}'
        done;
        ) > results/experiments/exampleCount1/statistic/statistic_oligo_correlation_merged_fromFile_exampleConfig.tsv 2> results/logs/statistic/correlation/combine_oligo.exampleCount1.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:24:05 2024]
Finished job 195.
156 of 199 steps (78%) done
[Sun Jun 23 16:24:09 2024]
Finished job 15.
157 of 199 steps (79%) done
Select jobs to execute...

[Sun Jun 23 16:24:09 2024]
rule counts_umi_raw_counts:
    input: results/experiments/exampleCount/counts/useUMI.HEPG2_2_RNA.bam
    output: results/experiments/exampleCount/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz
    log: results/logs/counts/umi/raw_counts.exampleCount.HEPG2.2.RNA.log
    jobid: 14
    reason: Missing output files: results/experiments/exampleCount/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/useUMI.HEPG2_2_RNA.bam
    wildcards: project=exampleCount, condition=HEPG2, replicate=2, type=RNA
    resources: tmpdir=/tmp


        samtools view -F 1 -r HEPG2_2_RNA results/experiments/exampleCount/counts/useUMI.HEPG2_2_RNA.bam |         awk -v 'OFS=\t' '{ for (i=12; i<=NF; i++) {
          if ($i ~ /^XJ:Z:/) print $10,substr($i,6,10)
        }}' |         sort | uniq -c |         awk -v 'OFS=\t' '{ print $2,$3,$1 }' |         gzip -c > results/experiments/exampleCount/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz 2> results/logs/counts/umi/raw_counts.exampleCount.HEPG2.2.RNA.log
        
Activating conda environment: .snakemake/conda/9030bacf18a7682e51f4bb53f8e2c2d9_
[Sun Jun 23 16:24:11 2024]
Finished job 14.
158 of 199 steps (79%) done
Select jobs to execute...

[Sun Jun 23 16:24:11 2024]
rule counts_filter_counts:
    input: results/experiments/exampleCount/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount/counts/HEPG2_2_RNA_filtered_counts.tsv.gz
    log: results/logs/counts/filter_counts.exampleCount.HEPG2.2.RNA.log
    jobid: 13
    reason: Missing output files: results/experiments/exampleCount/counts/HEPG2_2_RNA_filtered_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=2, type=RNA
    resources: tmpdir=/tmp


        bc=15;
        echo $bc;
        zcat results/experiments/exampleCount/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz | grep -v "N" |         awk -v var="$bc" -v 'OFS=\t' '{ if (length($1) == var) { print } }' |         sort |         gzip -c > results/experiments/exampleCount/counts/HEPG2_2_RNA_filtered_counts.tsv.gz
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_

[Sun Jun 23 16:24:11 2024]
rule statistic_counts_BC_in_RNA_DNA:
    input: results/experiments/exampleCount/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz, results/experiments/exampleCount/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts/HEPG2_2_raw_BC_in_RNA_DNA.tsv.gz
    log: results/logs/statistic/counts/BC_in_RNA_DNA.exampleCount.HEPG2_2_raw.log
    jobid: 71
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/HEPG2_2_raw_BC_in_RNA_DNA.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz, results/experiments/exampleCount/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=2, countType=raw
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "2")         <( join <( zcat results/experiments/exampleCount/counts/useUMI.HEPG2_2_DNA_raw_counts.tsv.gz | cut -f 1 | sort | uniq )         <( zcat results/experiments/exampleCount/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz | cut -f 1 | sort | uniq ) | wc -l ) |         gzip -c > results/experiments/exampleCount/statistic/counts/HEPG2_2_raw_BC_in_RNA_DNA.tsv.gz 2> results/logs/statistic/counts/BC_in_RNA_DNA.exampleCount.HEPG2_2_raw.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_

[Sun Jun 23 16:24:11 2024]
rule statistic_counts_table:
    input: results/experiments/exampleCount/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts/HEPG2_2_RNA_raw_counts.tsv.gz
    log: results/logs/statistic/counts/table.exampleCount.HEPG2_2_RNA_raw.log
    jobid: 66
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/HEPG2_2_RNA_raw_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=2, type=RNA, countType=raw
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "2") <( echo "RNA")         <( 
            zcat results/experiments/exampleCount/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz |             awk -v OFS='\t' 'BEGIN{
                pbar="NA"
            }{ 
                count += $NF; umi_sum+=$3; if (pbar != $1) { barcodes+=1 }; pbar=$1 
            }END{ 
                if (NR > 0) {
                    print umi_sum/NR,count,NR,barcodes
                } else {
                    print 0,0,0,0
                }
            }' 
        )         <( 
            zcat results/experiments/exampleCount/counts/useUMI.HEPG2_2_RNA_raw_counts.tsv.gz | cut -f 2 | sort -u | wc -l 
        ) |         gzip -c > results/experiments/exampleCount/statistic/counts/HEPG2_2_RNA_raw_counts.tsv.gz 2> results/logs/statistic/counts/table.exampleCount.HEPG2_2_RNA_raw.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:24:12 2024]
Finished job 71.
159 of 199 steps (80%) done
Select jobs to execute...

[Sun Jun 23 16:24:12 2024]
rule statistic_counts_BC_in_RNA_DNA_merge:
    input: results/experiments/exampleCount/statistic/counts/HEPG2_1_raw_BC_in_RNA_DNA.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_2_raw_BC_in_RNA_DNA.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_3_raw_BC_in_RNA_DNA.tsv.gz
    output: results/experiments/exampleCount/statistic/counts/BC_in_RNA_DNA_raw.tsv
    log: results/logs/statistic/counts/BC_in_RNA_DNA_merge.exampleCount.raw.log
    jobid: 69
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/BC_in_RNA_DNA_raw.tsv; Input files updated by another job: results/experiments/exampleCount/statistic/counts/HEPG2_3_raw_BC_in_RNA_DNA.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_2_raw_BC_in_RNA_DNA.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_1_raw_BC_in_RNA_DNA.tsv.gz
    wildcards: project=exampleCount, countType=raw
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount/statistic/counts/HEPG2_1_raw_BC_in_RNA_DNA.tsv.gz results/experiments/exampleCount/statistic/counts/HEPG2_2_raw_BC_in_RNA_DNA.tsv.gz results/experiments/exampleCount/statistic/counts/HEPG2_3_raw_BC_in_RNA_DNA.tsv.gz | sort -k1,1 -k2,2 > results/experiments/exampleCount/statistic/counts/BC_in_RNA_DNA_raw.tsv 2> results/logs/statistic/counts/BC_in_RNA_DNA_merge.exampleCount.raw.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:24:12 2024]
Finished job 69.
160 of 199 steps (80%) done
[Sun Jun 23 16:24:12 2024]
Finished job 66.
161 of 199 steps (81%) done
Select jobs to execute...

[Sun Jun 23 16:24:12 2024]
rule statistic_counts_stats_merge:
    input: results/experiments/exampleCount/statistic/counts/HEPG2_1_DNA_raw_counts.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_1_RNA_raw_counts.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_2_DNA_raw_counts.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_2_RNA_raw_counts.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_3_DNA_raw_counts.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_3_RNA_raw_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts/count_raw.tsv
    log: results/logs/statistic/counts/stats_merge.exampleCount.raw.log
    jobid: 62
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/count_raw.tsv; Input files updated by another job: results/experiments/exampleCount/statistic/counts/HEPG2_1_DNA_raw_counts.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_3_DNA_raw_counts.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_1_RNA_raw_counts.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_3_RNA_raw_counts.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_2_DNA_raw_counts.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_2_RNA_raw_counts.tsv.gz
    wildcards: project=exampleCount, countType=raw
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount/statistic/counts/HEPG2_1_DNA_raw_counts.tsv.gz results/experiments/exampleCount/statistic/counts/HEPG2_1_RNA_raw_counts.tsv.gz results/experiments/exampleCount/statistic/counts/HEPG2_2_DNA_raw_counts.tsv.gz results/experiments/exampleCount/statistic/counts/HEPG2_2_RNA_raw_counts.tsv.gz results/experiments/exampleCount/statistic/counts/HEPG2_3_DNA_raw_counts.tsv.gz results/experiments/exampleCount/statistic/counts/HEPG2_3_RNA_raw_counts.tsv.gz | sort -k1,1 -k3,3 -k2,2 > results/experiments/exampleCount/statistic/counts/count_raw.tsv 2> results/logs/statistic/counts/stats_merge.exampleCount.raw.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:24:12 2024]
Finished job 62.
162 of 199 steps (81%) done
Select jobs to execute...

[Sun Jun 23 16:24:12 2024]
rule statistic_counts_final:
    input: results/experiments/exampleCount/statistic/counts/count_raw.tsv, results/experiments/exampleCount/statistic/counts/BC_in_RNA_DNA_raw.tsv, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/combine_count_stats.R
    output: results/experiments/exampleCount/statistic/counts.raw.tsv
    log: results/logs/statistic/counts/final.exampleCount.raw.log
    jobid: 61
    reason: Missing output files: results/experiments/exampleCount/statistic/counts.raw.tsv; Input files updated by another job: results/experiments/exampleCount/statistic/counts/count_raw.tsv, results/experiments/exampleCount/statistic/counts/BC_in_RNA_DNA_raw.tsv
    wildcards: project=exampleCount, countType=raw
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/combine_count_stats.R --count results/experiments/exampleCount/statistic/counts/count_raw.tsv --shared results/experiments/exampleCount/statistic/counts/BC_in_RNA_DNA_raw.tsv --output results/experiments/exampleCount/statistic/counts.raw.tsv > results/logs/statistic/counts/final.exampleCount.raw.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_
[Sun Jun 23 16:24:13 2024]
Finished job 13.
163 of 199 steps (82%) done
Select jobs to execute...

[Sun Jun 23 16:24:13 2024]
rule statistic_counts_BC_in_RNA_DNA:
    input: results/experiments/exampleCount/counts/HEPG2_2_DNA_filtered_counts.tsv.gz, results/experiments/exampleCount/counts/HEPG2_2_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts/HEPG2_2_filtered_BC_in_RNA_DNA.tsv.gz
    log: results/logs/statistic/counts/BC_in_RNA_DNA.exampleCount.HEPG2_2_filtered.log
    jobid: 83
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/HEPG2_2_filtered_BC_in_RNA_DNA.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_2_RNA_filtered_counts.tsv.gz, results/experiments/exampleCount/counts/HEPG2_2_DNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=2, countType=filtered
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "2")         <( join <( zcat results/experiments/exampleCount/counts/HEPG2_2_DNA_filtered_counts.tsv.gz | cut -f 1 | sort | uniq )         <( zcat results/experiments/exampleCount/counts/HEPG2_2_RNA_filtered_counts.tsv.gz | cut -f 1 | sort | uniq ) | wc -l ) |         gzip -c > results/experiments/exampleCount/statistic/counts/HEPG2_2_filtered_BC_in_RNA_DNA.tsv.gz 2> results/logs/statistic/counts/BC_in_RNA_DNA.exampleCount.HEPG2_2_filtered.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_

[Sun Jun 23 16:24:13 2024]
rule statistic_counts_frequent_umis:
    input: results/experiments/exampleCount/counts/HEPG2_2_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_2_RNA.txt
    log: results/logs/statistic/counts/frequent_umis.exampleCount.HEPG2.2.RNA.log
    jobid: 111
    reason: Missing output files: results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_2_RNA.txt; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_2_RNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=2, type=RNA
    resources: tmpdir=/tmp


        set +o pipefail;
        zcat results/experiments/exampleCount/counts/HEPG2_2_RNA_filtered_counts.tsv.gz | cut -f 2 | sort | uniq -c | sort -nr | head > results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_2_RNA.txt 2> results/logs/statistic/counts/frequent_umis.exampleCount.HEPG2.2.RNA.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_

[Sun Jun 23 16:24:13 2024]
rule counts_final_counts:
    input: results/experiments/exampleCount/counts/HEPG2_2_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount/counts/HEPG2_2_RNA_final_counts.tsv.gz
    log: results/logs/counts/final_counts_umi.exampleCount.HEPG2.2.RNA.log
    jobid: 12
    reason: Missing output files: results/experiments/exampleCount/counts/HEPG2_2_RNA_final_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_2_RNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=2, type=RNA
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount/counts/HEPG2_2_RNA_filtered_counts.tsv.gz | awk '{print $1}' |         uniq -c |         awk -v 'OFS=\t' '{ print $2,$1 }' |         gzip -c > results/experiments/exampleCount/counts/HEPG2_2_RNA_final_counts.tsv.gz 2> results/logs/counts/final_counts_umi.exampleCount.HEPG2.2.RNA.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_

[Sun Jun 23 16:24:13 2024]
rule statistic_counts_table:
    input: results/experiments/exampleCount/counts/HEPG2_2_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts/HEPG2_2_RNA_filtered_counts.tsv.gz
    log: results/logs/statistic/counts/table.exampleCount.HEPG2_2_RNA_filtered.log
    jobid: 78
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/HEPG2_2_RNA_filtered_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_2_RNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=2, type=RNA, countType=filtered
    resources: tmpdir=/tmp


        paste <( echo "HEPG2") <( echo "2") <( echo "RNA")         <( 
            zcat results/experiments/exampleCount/counts/HEPG2_2_RNA_filtered_counts.tsv.gz |             awk -v OFS='\t' 'BEGIN{
                pbar="NA"
            }{ 
                count += $NF; umi_sum+=$3; if (pbar != $1) { barcodes+=1 }; pbar=$1 
            }END{ 
                if (NR > 0) {
                    print umi_sum/NR,count,NR,barcodes
                } else {
                    print 0,0,0,0
                }
            }' 
        )         <( 
            zcat results/experiments/exampleCount/counts/HEPG2_2_RNA_filtered_counts.tsv.gz | cut -f 2 | sort -u | wc -l 
        ) |         gzip -c > results/experiments/exampleCount/statistic/counts/HEPG2_2_RNA_filtered_counts.tsv.gz 2> results/logs/statistic/counts/table.exampleCount.HEPG2_2_RNA_filtered.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:24:13 2024]
Finished job 83.
164 of 199 steps (82%) done
Select jobs to execute...

[Sun Jun 23 16:24:13 2024]
rule statistic_counts_BC_in_RNA_DNA_merge:
    input: results/experiments/exampleCount/statistic/counts/HEPG2_1_filtered_BC_in_RNA_DNA.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_2_filtered_BC_in_RNA_DNA.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_3_filtered_BC_in_RNA_DNA.tsv.gz
    output: results/experiments/exampleCount/statistic/counts/BC_in_RNA_DNA_filtered.tsv
    log: results/logs/statistic/counts/BC_in_RNA_DNA_merge.exampleCount.filtered.log
    jobid: 81
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/BC_in_RNA_DNA_filtered.tsv; Input files updated by another job: results/experiments/exampleCount/statistic/counts/HEPG2_3_filtered_BC_in_RNA_DNA.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_2_filtered_BC_in_RNA_DNA.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_1_filtered_BC_in_RNA_DNA.tsv.gz
    wildcards: project=exampleCount, countType=filtered
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount/statistic/counts/HEPG2_1_filtered_BC_in_RNA_DNA.tsv.gz results/experiments/exampleCount/statistic/counts/HEPG2_2_filtered_BC_in_RNA_DNA.tsv.gz results/experiments/exampleCount/statistic/counts/HEPG2_3_filtered_BC_in_RNA_DNA.tsv.gz | sort -k1,1 -k2,2 > results/experiments/exampleCount/statistic/counts/BC_in_RNA_DNA_filtered.tsv 2> results/logs/statistic/counts/BC_in_RNA_DNA_merge.exampleCount.filtered.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:24:13 2024]
Finished job 12.
165 of 199 steps (83%) done
Select jobs to execute...

[Sun Jun 23 16:24:13 2024]
rule assigned_counts_assignBarcodes:
    input: results/experiments/exampleCount/counts/HEPG2_2_RNA_final_counts.tsv.gz, results/experiments/exampleCount/assignment/fromFile.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_BC_and_assignment.py
    output: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2_RNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_2_RNA_exampleConfig.statistic.tsv.gz
    log: results/logs/assigned_counts/assignBarcodes.exampleCount.HEPG2.2.RNA.exampleConfig.fromFile.log
    jobid: 140
    reason: Missing output files: results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_2_RNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2_RNA_final_counts.config.exampleConfig.tsv.gz; Input files updated by another job: results/experiments/exampleCount/assignment/fromFile.tsv.gz, results/experiments/exampleCount/counts/HEPG2_2_RNA_final_counts.tsv.gz
    wildcards: project=exampleCount, assignment=fromFile, condition=HEPG2, replicate=2, type=RNA, config=exampleConfig
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_BC_and_assignment.py --counts results/experiments/exampleCount/counts/HEPG2_2_RNA_final_counts.tsv.gz         --assignment results/experiments/exampleCount/assignment/fromFile.tsv.gz         --output results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2_RNA_final_counts.config.exampleConfig.tsv.gz         --statistic results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_2_RNA_exampleConfig.statistic.tsv.gz         --name HEPG2_2_RNA &> results/logs/assigned_counts/assignBarcodes.exampleCount.HEPG2.2.RNA.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_

[Sun Jun 23 16:24:13 2024]
rule statistic_bc_overlap_run:
    input: results/experiments/exampleCount/counts/HEPG2_1_RNA_final_counts.tsv.gz, results/experiments/exampleCount/counts/HEPG2_2_RNA_final_counts.tsv.gz, results/experiments/exampleCount/counts/HEPG2_3_RNA_final_counts.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/BCCounts_betweenReplicates.R
    output: results/experiments/exampleCount/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_RNA.exampleConfig.tsv
    log: results/logs/statistic/bc_overlap/run.exampleCount.HEPG2.RNA.exampleConfig.counts.log
    jobid: 157
    reason: Missing output files: results/experiments/exampleCount/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_RNA.exampleConfig.tsv; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_1_RNA_final_counts.tsv.gz, results/experiments/exampleCount/counts/HEPG2_3_RNA_final_counts.tsv.gz, results/experiments/exampleCount/counts/HEPG2_2_RNA_final_counts.tsv.gz
    wildcards: project=exampleCount, raw_or_assigned=counts, condition=HEPG2, type=RNA, config=exampleConfig
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/BCCounts_betweenReplicates.R         --outfile results/experiments/exampleCount/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_RNA.exampleConfig.tsv         --condition HEPG2_RNA         --files results/experiments/exampleCount/counts/HEPG2_1_RNA_final_counts.tsv.gz,results/experiments/exampleCount/counts/HEPG2_2_RNA_final_counts.tsv.gz,results/experiments/exampleCount/counts/HEPG2_3_RNA_final_counts.tsv.gz --replicates 1,2,3 &> results/logs/statistic/bc_overlap/run.exampleCount.HEPG2.RNA.exampleConfig.counts.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_

[Sun Jun 23 16:24:13 2024]
rule counts_dna_rna_merge_counts:
    input: results/experiments/exampleCount/counts/HEPG2_2_DNA_final_counts.tsv.gz, results/experiments/exampleCount/counts/HEPG2_2_RNA_final_counts.tsv.gz
    output: results/experiments/exampleCount/counts/HEPG2_2.merged.config.exampleConfig.tsv.gz
    log: results/logs/counts/dna_rna_merge_counts.exampleCount.HEPG2.2.exampleConfig.log
    jobid: 124
    reason: Missing output files: results/experiments/exampleCount/counts/HEPG2_2.merged.config.exampleConfig.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_2_RNA_final_counts.tsv.gz, results/experiments/exampleCount/counts/HEPG2_2_DNA_final_counts.tsv.gz
    wildcards: project=exampleCount, raw_or_assigned=counts, condition=HEPG2, replicate=2, config=exampleConfig
    resources: tmpdir=/tmp


        zero=false;
        if [[ -z "${zero//false}" ]]
        then
            join -1 1 -2 1 -t"$(echo -e '\t')"             <( zcat  results/experiments/exampleCount/counts/HEPG2_2_DNA_final_counts.tsv.gz | sort )             <( zcat results/experiments/exampleCount/counts/HEPG2_2_RNA_final_counts.tsv.gz | sort);
        else
            join -e 0 -a1 -a2 -t"$(echo -e '\t')" -o 0 1.2 2.2             <( zcat  results/experiments/exampleCount/counts/HEPG2_2_DNA_final_counts.tsv.gz | sort )             <( zcat results/experiments/exampleCount/counts/HEPG2_2_RNA_final_counts.tsv.gz  | sort);
        fi  |         awk -v 'OFS=\t' '{if ($2 >= --minCounts 1 && $3 >= --minCounts 1) {print $0}}' |         gzip -c > results/experiments/exampleCount/counts/HEPG2_2.merged.config.exampleConfig.tsv.gz 2> results/logs/counts/dna_rna_merge_counts.exampleCount.HEPG2.2.exampleConfig.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_

[Sun Jun 23 16:24:13 2024]
rule statistic_counts_barcode_base_composition:
    input: results/experiments/exampleCount/counts/HEPG2_2_RNA_final_counts.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/nucleotideCountPerPosition.py
    output: results/experiments/exampleCount/counts/HEPG2_2_RNA_final.BC.tsv.gz, results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_2_RNA.tsv.gz
    log: results/logs/statistic/counts/barcode_base_composition.exampleCount.HEPG2_2_RNA.log
    jobid: 11
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_2_RNA.tsv.gz; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_2_RNA_final_counts.tsv.gz
    wildcards: project=exampleCount, condition=HEPG2, replicate=2, type=RNA
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount/counts/HEPG2_2_RNA_final_counts.tsv.gz | awk '{print $1}' | gzip -c > results/experiments/exampleCount/counts/HEPG2_2_RNA_final.BC.tsv.gz;
        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/nucleotideCountPerPosition.py         --column 1         --chunksize 100000         --input results/experiments/exampleCount/counts/HEPG2_2_RNA_final.BC.tsv.gz         --output results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_2_RNA.tsv.gz &> results/logs/statistic/counts/barcode_base_composition.exampleCount.HEPG2_2_RNA.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:24:13 2024]
Finished job 81.
166 of 199 steps (83%) done
[Sun Jun 23 16:24:13 2024]
Finished job 61.
167 of 199 steps (84%) done
[Sun Jun 23 16:24:13 2024]
Finished job 78.
168 of 199 steps (84%) done
Select jobs to execute...

[Sun Jun 23 16:24:13 2024]
rule statistic_counts_stats_merge:
    input: results/experiments/exampleCount/statistic/counts/HEPG2_1_DNA_filtered_counts.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_1_RNA_filtered_counts.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_2_DNA_filtered_counts.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_2_RNA_filtered_counts.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_3_DNA_filtered_counts.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_3_RNA_filtered_counts.tsv.gz
    output: results/experiments/exampleCount/statistic/counts/count_filtered.tsv
    log: results/logs/statistic/counts/stats_merge.exampleCount.filtered.log
    jobid: 74
    reason: Missing output files: results/experiments/exampleCount/statistic/counts/count_filtered.tsv; Input files updated by another job: results/experiments/exampleCount/statistic/counts/HEPG2_2_RNA_filtered_counts.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_3_DNA_filtered_counts.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_1_RNA_filtered_counts.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_3_RNA_filtered_counts.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_1_DNA_filtered_counts.tsv.gz, results/experiments/exampleCount/statistic/counts/HEPG2_2_DNA_filtered_counts.tsv.gz
    wildcards: project=exampleCount, countType=filtered
    resources: tmpdir=/tmp


        zcat results/experiments/exampleCount/statistic/counts/HEPG2_1_DNA_filtered_counts.tsv.gz results/experiments/exampleCount/statistic/counts/HEPG2_1_RNA_filtered_counts.tsv.gz results/experiments/exampleCount/statistic/counts/HEPG2_2_DNA_filtered_counts.tsv.gz results/experiments/exampleCount/statistic/counts/HEPG2_2_RNA_filtered_counts.tsv.gz results/experiments/exampleCount/statistic/counts/HEPG2_3_DNA_filtered_counts.tsv.gz results/experiments/exampleCount/statistic/counts/HEPG2_3_RNA_filtered_counts.tsv.gz | sort -k1,1 -k3,3 -k2,2 > results/experiments/exampleCount/statistic/counts/count_filtered.tsv 2> results/logs/statistic/counts/stats_merge.exampleCount.filtered.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:24:13 2024]
Finished job 111.
169 of 199 steps (85%) done
[Sun Jun 23 16:24:13 2024]
Finished job 74.
170 of 199 steps (85%) done
Select jobs to execute...

[Sun Jun 23 16:24:13 2024]
rule statistic_counts_final:
    input: results/experiments/exampleCount/statistic/counts/count_filtered.tsv, results/experiments/exampleCount/statistic/counts/BC_in_RNA_DNA_filtered.tsv, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/combine_count_stats.R
    output: results/experiments/exampleCount/statistic/counts.filtered.tsv
    log: results/logs/statistic/counts/final.exampleCount.filtered.log
    jobid: 73
    reason: Missing output files: results/experiments/exampleCount/statistic/counts.filtered.tsv; Input files updated by another job: results/experiments/exampleCount/statistic/counts/BC_in_RNA_DNA_filtered.tsv, results/experiments/exampleCount/statistic/counts/count_filtered.tsv
    wildcards: project=exampleCount, countType=filtered
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/combine_count_stats.R --count results/experiments/exampleCount/statistic/counts/count_filtered.tsv --shared results/experiments/exampleCount/statistic/counts/BC_in_RNA_DNA_filtered.tsv --output results/experiments/exampleCount/statistic/counts.filtered.tsv > results/logs/statistic/counts/final.exampleCount.filtered.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_
[Sun Jun 23 16:24:14 2024]
Finished job 124.
171 of 199 steps (86%) done
Select jobs to execute...

[Sun Jun 23 16:24:14 2024]
rule statistic_correlation_bc_counts:
    input: results/experiments/exampleCount/counts/HEPG2_1.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount/counts/HEPG2_2.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount/counts/HEPG2_3.merged.config.exampleConfig.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/plot_perBCCounts_correlation.R
    output: results/experiments/exampleCount/statistic/barcode/counts/HEPG2_exampleConfig_barcode_DNA_pairwise.png, results/experiments/exampleCount/statistic/barcode/counts/HEPG2_exampleConfig_barcode_RNA_pairwise.png, results/experiments/exampleCount/statistic/barcode/counts/HEPG2_exampleConfig_barcode_Ratio_pairwise.png, results/experiments/exampleCount/statistic/barcode/counts/HEPG2_exampleConfig_barcode_correlation.tsv
    log: results/logs/statistic/correlation/correlate_bc_counts.exampleCount.HEPG2.exampleConfig.counts.log
    jobid: 122
    reason: Missing output files: results/experiments/exampleCount/statistic/barcode/counts/HEPG2_exampleConfig_barcode_correlation.tsv; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_3.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount/counts/HEPG2_2.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount/counts/HEPG2_1.merged.config.exampleConfig.tsv.gz
    wildcards: project=exampleCount, raw_or_assigned=counts, condition=HEPG2, config=exampleConfig
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/plot_perBCCounts_correlation.R         --outdir results/experiments/exampleCount/statistic/barcode/counts/HEPG2_exampleConfig         --condition HEPG2         --mindnacounts 1 --minrnacounts 1         --files results/experiments/exampleCount/counts/HEPG2_1.merged.config.exampleConfig.tsv.gz,results/experiments/exampleCount/counts/HEPG2_2.merged.config.exampleConfig.tsv.gz,results/experiments/exampleCount/counts/HEPG2_3.merged.config.exampleConfig.tsv.gz --replicates 1,2,3 &> results/logs/statistic/correlation/correlate_bc_counts.exampleCount.HEPG2.exampleConfig.counts.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_

[Sun Jun 23 16:24:14 2024]
rule statistic_correlation_bc_counts_hist:
    input: results/experiments/exampleCount/counts/HEPG2_1.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount/counts/HEPG2_2.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount/counts/HEPG2_3.merged.config.exampleConfig.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/plot_perBCCounts_stats.R
    output: results/experiments/exampleCount/statistic/barcode/counts/HEPG2_exampleConfig_DNA_perBarcode.png, results/experiments/exampleCount/statistic/barcode/counts/HEPG2_exampleConfig_RNA_perBarcode.png
    log: results/logs/statistic/correlation/correlate_bc_counts_hist.exampleCount.HEPG2.exampleConfig.counts.log
    jobid: 131
    reason: Missing output files: results/experiments/exampleCount/statistic/barcode/counts/HEPG2_exampleConfig_RNA_perBarcode.png, results/experiments/exampleCount/statistic/barcode/counts/HEPG2_exampleConfig_DNA_perBarcode.png; Input files updated by another job: results/experiments/exampleCount/counts/HEPG2_3.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount/counts/HEPG2_2.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount/counts/HEPG2_1.merged.config.exampleConfig.tsv.gz
    wildcards: project=exampleCount, raw_or_assigned=counts, condition=HEPG2, config=exampleConfig
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/plot_perBCCounts_stats.R         --outdir results/experiments/exampleCount/statistic/barcode/counts/HEPG2_exampleConfig         --condition HEPG2         --mindnacounts 1 --minrnacounts 1         --files results/experiments/exampleCount/counts/HEPG2_1.merged.config.exampleConfig.tsv.gz,results/experiments/exampleCount/counts/HEPG2_2.merged.config.exampleConfig.tsv.gz,results/experiments/exampleCount/counts/HEPG2_3.merged.config.exampleConfig.tsv.gz --replicates 1,2,3 &> results/logs/statistic/correlation/correlate_bc_counts_hist.exampleCount.HEPG2.exampleConfig.counts.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_

[Sun Jun 23 16:24:14 2024]
rule assigned_counts_dna_rna_merge:
    input: results/experiments/exampleCount/counts/HEPG2_2.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assignment/fromFile.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_label.py
    output: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_2_barcode_assigned_counts.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.statistic.tsv.gz
    log: results/logs/assigned_counts/fromFile/dna_rna_merge.exampleCount.HEPG2.2.exampleConfig.log
    jobid: 173
    reason: Missing output files: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_2_barcode_assigned_counts.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.statistic.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/assignment/fromFile.tsv.gz, results/experiments/exampleCount/counts/HEPG2_2.merged.config.exampleConfig.tsv.gz
    wildcards: project=exampleCount, assignment=fromFile, config=exampleConfig, condition=HEPG2, replicate=2
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_label.py --counts results/experiments/exampleCount/counts/HEPG2_2.merged.config.exampleConfig.tsv.gz         --minRNACounts 1 --minDNACounts 1         --assignment results/experiments/exampleCount/assignment/fromFile.tsv.gz         --output results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.tsv.gz         --bcOutput results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_2_barcode_assigned_counts.tsv.gz         --statistic results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.statistic.tsv.gz &> results/logs/assigned_counts/fromFile/dna_rna_merge.exampleCount.HEPG2.2.exampleConfig.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:24:15 2024]
Finished job 73.
172 of 199 steps (86%) done
[Sun Jun 23 16:24:16 2024]
Finished job 157.
173 of 199 steps (87%) done
Select jobs to execute...

[Sun Jun 23 16:24:16 2024]
rule statistic_bc_overlap_combine_counts:
    input: results/experiments/exampleCount/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv, results/experiments/exampleCount/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_RNA.exampleConfig.tsv
    output: results/experiments/exampleCount/statistic/bc_overlap.counts.exampleConfig.tsv
    log: results/logs/statistic/bc_overlap/combine_counts.exampleCount.exampleConfig.log
    jobid: 155
    reason: Missing output files: results/experiments/exampleCount/statistic/bc_overlap.counts.exampleConfig.tsv; Input files updated by another job: results/experiments/exampleCount/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_RNA.exampleConfig.tsv, results/experiments/exampleCount/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv
    wildcards: project=exampleCount, config=exampleConfig
    resources: tmpdir=/tmp


        set +o pipefail;
        (
            cat results/experiments/exampleCount/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv | head -n 1;
            for i in results/experiments/exampleCount/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv results/experiments/exampleCount/statistic/bc_overlap/counts/overlapBCandCounts.HEPG2_RNA.exampleConfig.tsv; do
                cat $i | tail -n +2
            done;
        ) > results/experiments/exampleCount/statistic/bc_overlap.counts.exampleConfig.tsv 2> results/logs/statistic/bc_overlap/combine_counts.exampleCount.exampleConfig.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:24:16 2024]
Finished job 155.
174 of 199 steps (87%) done
[Sun Jun 23 16:24:17 2024]
Finished job 173.
175 of 199 steps (88%) done
Select jobs to execute...

[Sun Jun 23 16:24:17 2024]
rule statistic_correlation_calculate:
    input: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/plot_perInsertCounts_correlation.R
    output: results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_DNA_pairwise.png, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_RNA_pairwise.png, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_Ratio_pairwise.png, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_DNA_pairwise_minThreshold.png, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_RNA_pairwise_minThreshold.png, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_Ratio_pairwise_minThreshold.png, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_correlation.tsv, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_correlation_minThreshold.tsv
    log: results/logs/statistic/correlation/calculate.exampleCount.HEPG2.exampleConfig.fromFile.log
    jobid: 192
    reason: Missing output files: results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_correlation.tsv, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_correlation_minThreshold.tsv; Input files updated by another job: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.tsv.gz
    wildcards: project=exampleCount, assignment=fromFile, config=exampleConfig, condition=HEPG2
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/plot_perInsertCounts_correlation.R         --condition HEPG2                  --files results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.tsv.gz,results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.tsv.gz,results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.tsv.gz         --replicates 1,2,3         --threshold 10         --outdir results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2 &> results/logs/statistic/correlation/calculate.exampleCount.HEPG2.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_

[Sun Jun 23 16:24:17 2024]
rule assigned_counts_make_master_tables:
    input: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/make_master_tables.R
    output: results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_average_allreps_merged.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_minThreshold_merged.tsv.gz
    log: results/logs/assigned_counts/make_master_tables.exampleCount.HEPG2.exampleConfig.fromFile.log
    jobid: 171
    reason: Missing output files: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_minThreshold_merged.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.tsv.gz; Input files updated by another job: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.tsv.gz
    wildcards: project=exampleCount, assignment=fromFile, config=exampleConfig, condition=HEPG2
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/make_master_tables.R         --condition HEPG2         --threshold 10         --files results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.tsv.gz,results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.tsv.gz,results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.tsv.gz         --replicates 1,2,3         --output results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_minThreshold_merged.tsv.gz         --output-all results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.tsv.gz         --statistic results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_average_allreps_merged.tsv.gz &> results/logs/assigned_counts/make_master_tables.exampleCount.HEPG2.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_

[Sun Jun 23 16:24:17 2024]
rule assigned_counts_combine_replicates_barcode_output:
    input: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_1_barcode_assigned_counts.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_2_barcode_assigned_counts.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_3_barcode_assigned_counts.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_replicates_barcode_counts.py
    output: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged_barcode_assigned_counts.tsv.gz
    log: results/logs/assigned_counts/combine_replicates_barcode_output.exampleCount.HEPG2.exampleConfig.fromFile.log
    jobid: 177
    reason: Missing output files: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged_barcode_assigned_counts.tsv.gz; Input files updated by another job: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_1_barcode_assigned_counts.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_2_barcode_assigned_counts.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_3_barcode_assigned_counts.tsv.gz
    wildcards: project=exampleCount, assignment=fromFile, config=exampleConfig, condition=HEPG2
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_replicates_barcode_counts.py --counts results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_1_barcode_assigned_counts.tsv.gz --counts results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_2_barcode_assigned_counts.tsv.gz --counts results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_3_barcode_assigned_counts.tsv.gz         --threshold 10         --replicate 1 --replicate 2 --replicate 3          --output results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged_barcode_assigned_counts.tsv.gz &> results/logs/assigned_counts/combine_replicates_barcode_output.exampleCount.HEPG2.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_

[Sun Jun 23 16:24:17 2024]
rule statistic_assigned_counts_combine_stats_dna_rna_merge:
    input: results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.statistic.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.statistic.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.statistic.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_statistic_tables.py
    output: results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/combined/HEPG2_merged_assigned_counts.statistic.tsv.gz
    log: results/logs/statistic/assigned_counts/combine_stats_dna_rna_merge.exampleCount.HEPG2.exampleConfig.fromFile.log
    jobid: 187
    reason: Missing output files: results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/combined/HEPG2_merged_assigned_counts.statistic.tsv.gz; Input files updated by another job: results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.statistic.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.statistic.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.statistic.tsv.gz
    wildcards: project=exampleCount, assignment=fromFile, config=exampleConfig, condition=HEPG2
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/merge_statistic_tables.py         --condition HEPG2         --statistic 1 results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.statistic.tsv.gz --statistic 2 results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.statistic.tsv.gz --statistic 3 results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.statistic.tsv.gz         --output results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/combined/HEPG2_merged_assigned_counts.statistic.tsv.gz &> results/logs/statistic/assigned_counts/combine_stats_dna_rna_merge.exampleCount.HEPG2.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_

[Sun Jun 23 16:24:17 2024]
rule statistic_correlation_hist_box_plots:
    input: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/plot_perInsertCounts_stats.R
    output: results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_all_barcodesPerInsert_box.png, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_all_barcodesPerInsert_box_minThreshold.png, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_group_barcodesPerInsert_box.png, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_group_barcodesPerInsert_box_minThreshold.png
    log: results/logs/statistic/correlation/hist_box_plots.exampleCount.HEPG2.exampleConfig.fromFile.log
    jobid: 185
    reason: Missing output files: results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_group_barcodesPerInsert_box_minThreshold.png, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_all_barcodesPerInsert_box_minThreshold.png, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_all_barcodesPerInsert_box.png, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_group_barcodesPerInsert_box.png; Input files updated by another job: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.tsv.gz
    wildcards: project=exampleCount, assignment=fromFile, config=exampleConfig, condition=HEPG2
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/plot_perInsertCounts_stats.R         --condition HEPG2                  --files results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_1_merged_assigned_counts.tsv.gz,results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_2_merged_assigned_counts.tsv.gz,results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_3_merged_assigned_counts.tsv.gz         --replicates 1,2,3         --threshold 10         --outdir results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2 &> results/logs/statistic/correlation/hist_box_plots.exampleCount.HEPG2.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_
[Sun Jun 23 16:24:17 2024]
Finished job 131.
176 of 199 steps (88%) done
[Sun Jun 23 16:24:17 2024]
Finished job 187.
177 of 199 steps (89%) done
Select jobs to execute...

[Sun Jun 23 16:24:17 2024]
rule statistic_assigned_counts_combine_stats_dna_rna_merge_all:
    input: results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/combined/HEPG2_merged_assigned_counts.statistic.tsv.gz
    output: results/experiments/exampleCount/statistic/statistic_assigned_counts_merged_fromFile_exampleConfig.tsv
    log: results/logs/statistic/assigned_counts/combine_stats_dna_rna_merge_all.exampleCount.exampleConfig.fromFile.log
    jobid: 186
    reason: Missing output files: results/experiments/exampleCount/statistic/statistic_assigned_counts_merged_fromFile_exampleConfig.tsv; Input files updated by another job: results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/combined/HEPG2_merged_assigned_counts.statistic.tsv.gz
    wildcards: project=exampleCount, assignment=fromFile, config=exampleConfig
    resources: tmpdir=/tmp


        set +o pipefail;
        (
            zcat results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/combined/HEPG2_merged_assigned_counts.statistic.tsv.gz | head -n 1;
            for i in results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/combined/HEPG2_merged_assigned_counts.statistic.tsv.gz; do
                zcat $i | tail -n +2
            done
        ) > results/experiments/exampleCount/statistic/statistic_assigned_counts_merged_fromFile_exampleConfig.tsv 2> results/logs/statistic/assigned_counts/combine_stats_dna_rna_merge_all.exampleCount.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:24:18 2024]
Finished job 186.
178 of 199 steps (89%) done
[Sun Jun 23 16:24:18 2024]
Finished job 177.
179 of 199 steps (90%) done
[Sun Jun 23 16:24:18 2024]
Finished job 171.
180 of 199 steps (90%) done
Select jobs to execute...

[Sun Jun 23 16:24:18 2024]
rule assigned_counts_combine_replicates:
    input: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_minThreshold_merged.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/combine_replicates.py
    output: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_minThreshold_merged.combined.tsv.gz
    log: results/logs/assigned_counts/combine_replicates.exampleCount.HEPG2.exampleConfig.fromFile.allreps_minThreshold.log
    jobid: 176
    reason: Missing output files: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_minThreshold_merged.combined.tsv.gz; Input files updated by another job: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_minThreshold_merged.tsv.gz
    wildcards: project=exampleCount, assignment=fromFile, config=exampleConfig, condition=HEPG2, allreps_or_threshold=allreps_minThreshold
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/combine_replicates.py         --input results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_minThreshold_merged.tsv.gz                  --output results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_minThreshold_merged.combined.tsv.gz  &> results/logs/assigned_counts/combine_replicates.exampleCount.HEPG2.exampleConfig.fromFile.allreps_minThreshold.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_

[Sun Jun 23 16:24:18 2024]
rule assigned_counts_combine_replicates:
    input: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/combine_replicates.py
    output: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.combined.tsv.gz
    log: results/logs/assigned_counts/combine_replicates.exampleCount.HEPG2.exampleConfig.fromFile.allreps.log
    jobid: 175
    reason: Missing output files: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.combined.tsv.gz; Input files updated by another job: results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.tsv.gz
    wildcards: project=exampleCount, assignment=fromFile, config=exampleConfig, condition=HEPG2, allreps_or_threshold=allreps
    resources: tmpdir=/tmp


        python /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/combine_replicates.py         --input results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.tsv.gz                  --output results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.combined.tsv.gz  &> results/logs/assigned_counts/combine_replicates.exampleCount.HEPG2.exampleConfig.fromFile.allreps.log
        
Activating conda environment: .snakemake/conda/448857998163f09608263e0c36fa5740_
[Sun Jun 23 16:24:19 2024]
Finished job 176.
181 of 199 steps (91%) done
[Sun Jun 23 16:24:19 2024]
Finished job 175.
182 of 199 steps (91%) done
[Sun Jun 23 16:24:23 2024]
Finished job 140.
183 of 199 steps (92%) done
Select jobs to execute...

[Sun Jun 23 16:24:23 2024]
rule counts_dna_rna_merge_counts:
    input: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2_RNA_final_counts.config.exampleConfig.tsv.gz
    output: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2.merged.config.exampleConfig.tsv.gz
    log: results/logs/assigned_counts/fromFile/dna_rna_merge_counts.exampleCount.HEPG2.2.exampleConfig.log
    jobid: 138
    reason: Missing output files: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2.merged.config.exampleConfig.tsv.gz; Input files updated by another job: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2_DNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2_RNA_final_counts.config.exampleConfig.tsv.gz
    wildcards: project=exampleCount, raw_or_assigned=assigned_counts/fromFile, condition=HEPG2, replicate=2, config=exampleConfig
    resources: tmpdir=/tmp


        zero=false;
        if [[ -z "${zero//false}" ]]
        then
            join -1 1 -2 1 -t"$(echo -e '\t')"             <( zcat  results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2_DNA_final_counts.config.exampleConfig.tsv.gz | sort )             <( zcat results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2_RNA_final_counts.config.exampleConfig.tsv.gz | sort);
        else
            join -e 0 -a1 -a2 -t"$(echo -e '\t')" -o 0 1.2 2.2             <( zcat  results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2_DNA_final_counts.config.exampleConfig.tsv.gz | sort )             <( zcat results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2_RNA_final_counts.config.exampleConfig.tsv.gz  | sort);
        fi  |         awk -v 'OFS=\t' '{if ($2 >= --minCounts 1 && $3 >= --minCounts 1) {print $0}}' |         gzip -c > results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2.merged.config.exampleConfig.tsv.gz 2> results/logs/assigned_counts/fromFile/dna_rna_merge_counts.exampleCount.HEPG2.2.exampleConfig.log
        

[Sun Jun 23 16:24:23 2024]
rule statistic_bc_overlap_run:
    input: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1_RNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2_RNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3_RNA_final_counts.config.exampleConfig.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/BCCounts_betweenReplicates.R
    output: results/experiments/exampleCount/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_RNA.exampleConfig.tsv
    log: results/logs/statistic/bc_overlap/run.exampleCount.HEPG2.RNA.exampleConfig.assigned_counts/fromFile.log
    jobid: 165
    reason: Missing output files: results/experiments/exampleCount/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_RNA.exampleConfig.tsv; Input files updated by another job: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1_RNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3_RNA_final_counts.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2_RNA_final_counts.config.exampleConfig.tsv.gz
    wildcards: project=exampleCount, raw_or_assigned=assigned_counts/fromFile, condition=HEPG2, type=RNA, config=exampleConfig
    resources: tmpdir=/tmp

Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_

        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/BCCounts_betweenReplicates.R         --outfile results/experiments/exampleCount/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_RNA.exampleConfig.tsv         --condition HEPG2_RNA         --files results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1_RNA_final_counts.config.exampleConfig.tsv.gz,results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2_RNA_final_counts.config.exampleConfig.tsv.gz,results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3_RNA_final_counts.config.exampleConfig.tsv.gz --replicates 1,2,3 &> results/logs/statistic/bc_overlap/run.exampleCount.HEPG2.RNA.exampleConfig.assigned_counts/fromFile.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_

[Sun Jun 23 16:24:23 2024]
rule statistic_assigned_counts_combine_BC_assignment_stats_helper:
    input: results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_1_DNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_2_DNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_3_DNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_1_RNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_2_RNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_3_RNA_exampleConfig.statistic.tsv.gz
    output: results/experiments/exampleCount/statistic/assigned_counts/fromFile/helper.HEPG2.exampleConfig.statistic.tsv.gz
    log: results/logs/statistic/assigned_counts/combine_BC_assignment_stats_helper.exampleCount.HEPG2.exampleConfig.fromFile.log
    jobid: 194
    reason: Missing output files: results/experiments/exampleCount/statistic/assigned_counts/fromFile/helper.HEPG2.exampleConfig.statistic.tsv.gz; Input files updated by another job: results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_3_DNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_1_DNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_2_DNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_3_RNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_1_RNA_exampleConfig.statistic.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_2_RNA_exampleConfig.statistic.tsv.gz
    wildcards: project=exampleCount, assignment=fromFile, condition=HEPG2, config=exampleConfig
    resources: tmpdir=/tmp


        set +o pipefail;
        (
            zcat results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_1_DNA_exampleConfig.statistic.tsv.gz | head -n 1;
            for i in results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_1_DNA_exampleConfig.statistic.tsv.gz results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_2_DNA_exampleConfig.statistic.tsv.gz results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_3_DNA_exampleConfig.statistic.tsv.gz results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_1_RNA_exampleConfig.statistic.tsv.gz results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_2_RNA_exampleConfig.statistic.tsv.gz results/experiments/exampleCount/statistic/assigned_counts/fromFile/HEPG2_3_RNA_exampleConfig.statistic.tsv.gz; do
                zcat $i | tail -n +2
            done;
        ) | gzip -c > results/experiments/exampleCount/statistic/assigned_counts/fromFile/helper.HEPG2.exampleConfig.statistic.tsv.gz 2> results/logs/statistic/assigned_counts/combine_BC_assignment_stats_helper.exampleCount.HEPG2.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:24:23 2024]
Finished job 194.
184 of 199 steps (92%) done
Select jobs to execute...

[Sun Jun 23 16:24:23 2024]
rule statistic_assigned_counts_combine_BC_assignment_stats:
    input: results/experiments/exampleCount/statistic/assigned_counts/fromFile/helper.HEPG2.exampleConfig.statistic.tsv.gz
    output: results/experiments/exampleCount/statistic/statistic_assigned_counts_single_fromFile_exampleConfig.tsv
    log: results/logs/statistic/assigned_counts/combine_BC_assignment_stats.exampleCount.fromFile_exampleConfig.log
    jobid: 193
    reason: Missing output files: results/experiments/exampleCount/statistic/statistic_assigned_counts_single_fromFile_exampleConfig.tsv; Input files updated by another job: results/experiments/exampleCount/statistic/assigned_counts/fromFile/helper.HEPG2.exampleConfig.statistic.tsv.gz
    wildcards: project=exampleCount, assignment=fromFile, config=exampleConfig
    resources: tmpdir=/tmp


        set +o pipefail;
        (
            zcat results/experiments/exampleCount/statistic/assigned_counts/fromFile/helper.HEPG2.exampleConfig.statistic.tsv.gz | head -n 1;
            for i in results/experiments/exampleCount/statistic/assigned_counts/fromFile/helper.HEPG2.exampleConfig.statistic.tsv.gz; do
                zcat $i | tail -n +2
            done;
        ) > results/experiments/exampleCount/statistic/statistic_assigned_counts_single_fromFile_exampleConfig.tsv 2> results/logs/statistic/assigned_counts/combine_BC_assignment_stats.exampleCount.fromFile_exampleConfig.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:24:23 2024]
Finished job 193.
185 of 199 steps (93%) done
[Sun Jun 23 16:24:24 2024]
Finished job 138.
186 of 199 steps (93%) done
Select jobs to execute...

[Sun Jun 23 16:24:24 2024]
rule statistic_correlation_bc_counts:
    input: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3.merged.config.exampleConfig.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/plot_perBCCounts_correlation.R
    output: results/experiments/exampleCount/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_barcode_DNA_pairwise.png, results/experiments/exampleCount/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_barcode_RNA_pairwise.png, results/experiments/exampleCount/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_barcode_Ratio_pairwise.png, results/experiments/exampleCount/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_barcode_correlation.tsv
    log: results/logs/statistic/correlation/correlate_bc_counts.exampleCount.HEPG2.exampleConfig.assigned_counts/fromFile.log
    jobid: 162
    reason: Missing output files: results/experiments/exampleCount/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_barcode_correlation.tsv; Input files updated by another job: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3.merged.config.exampleConfig.tsv.gz
    wildcards: project=exampleCount, raw_or_assigned=assigned_counts/fromFile, condition=HEPG2, config=exampleConfig
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/plot_perBCCounts_correlation.R         --outdir results/experiments/exampleCount/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig         --condition HEPG2         --mindnacounts 1 --minrnacounts 1         --files results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1.merged.config.exampleConfig.tsv.gz,results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2.merged.config.exampleConfig.tsv.gz,results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3.merged.config.exampleConfig.tsv.gz --replicates 1,2,3 &> results/logs/statistic/correlation/correlate_bc_counts.exampleCount.HEPG2.exampleConfig.assigned_counts/fromFile.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_

[Sun Jun 23 16:24:24 2024]
rule statistic_correlation_bc_counts_hist:
    input: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3.merged.config.exampleConfig.tsv.gz, /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/plot_perBCCounts_stats.R
    output: results/experiments/exampleCount/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_DNA_perBarcode.png, results/experiments/exampleCount/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_RNA_perBarcode.png
    log: results/logs/statistic/correlation/correlate_bc_counts_hist.exampleCount.HEPG2.exampleConfig.assigned_counts/fromFile.log
    jobid: 133
    reason: Missing output files: results/experiments/exampleCount/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_DNA_perBarcode.png, results/experiments/exampleCount/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_RNA_perBarcode.png; Input files updated by another job: results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1.merged.config.exampleConfig.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3.merged.config.exampleConfig.tsv.gz
    wildcards: project=exampleCount, raw_or_assigned=assigned_counts/fromFile, condition=HEPG2, config=exampleConfig
    resources: tmpdir=/tmp


        Rscript /home/ali/Documents/MPRAsnakeflow/workflow/rules/../scripts/count/plot_perBCCounts_stats.R         --outdir results/experiments/exampleCount/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig         --condition HEPG2         --mindnacounts 1 --minrnacounts 1         --files results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_1.merged.config.exampleConfig.tsv.gz,results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_2.merged.config.exampleConfig.tsv.gz,results/experiments/exampleCount/assigned_counts/fromFile/HEPG2_3.merged.config.exampleConfig.tsv.gz --replicates 1,2,3 &> results/logs/statistic/correlation/correlate_bc_counts_hist.exampleCount.HEPG2.exampleConfig.assigned_counts/fromFile.log
        
Activating conda environment: .snakemake/conda/fb27fd851d3f9b8c27fc404b6e0c725e_
[Sun Jun 23 16:24:26 2024]
Finished job 165.
187 of 199 steps (94%) done
Select jobs to execute...

[Sun Jun 23 16:24:26 2024]
rule statistic_bc_overlap_combine_assigned_counts:
    input: results/experiments/exampleCount/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv, results/experiments/exampleCount/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_RNA.exampleConfig.tsv
    output: results/experiments/exampleCount/statistic/bc_overlap.assigned_counts.exampleConfig.fromFile.tsv
    log: results/logs/statistic/bc_overlap/combine_assigned_counts.exampleCount.exampleConfig.fromFile.log
    jobid: 163
    reason: Missing output files: results/experiments/exampleCount/statistic/bc_overlap.assigned_counts.exampleConfig.fromFile.tsv; Input files updated by another job: results/experiments/exampleCount/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv, results/experiments/exampleCount/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_RNA.exampleConfig.tsv
    wildcards: project=exampleCount, config=exampleConfig, assignment=fromFile
    resources: tmpdir=/tmp


        set +o pipefail;
        (
            cat results/experiments/exampleCount/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv | head -n 1;
            for i in results/experiments/exampleCount/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_DNA.exampleConfig.tsv results/experiments/exampleCount/statistic/bc_overlap/assigned_counts/fromFile/overlapBCandCounts.HEPG2_RNA.exampleConfig.tsv; do
                cat $i | tail -n +2
            done;
        ) > results/experiments/exampleCount/statistic/bc_overlap.assigned_counts.exampleConfig.fromFile.tsv 2> results/logs/statistic/bc_overlap/combine_assigned_counts.exampleCount.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:24:26 2024]
Finished job 163.
188 of 199 steps (94%) done
[Sun Jun 23 16:24:26 2024]
Finished job 11.
189 of 199 steps (95%) done
[Sun Jun 23 16:24:27 2024]
Finished job 133.
190 of 199 steps (95%) done
[Sun Jun 23 16:24:30 2024]
Finished job 122.
191 of 199 steps (96%) done
Select jobs to execute...

[Sun Jun 23 16:24:30 2024]
rule statistic_correlation_combine_bc_raw:
    input: results/experiments/exampleCount/statistic/barcode/counts/HEPG2_exampleConfig_barcode_correlation.tsv
    output: results/experiments/exampleCount/statistic/statistic_bc_correlation_merged_exampleConfig.tsv
    log: results/logs/statistic/correlation/combine_bc_raw.exampleCount.exampleConfig.log
    jobid: 121
    reason: Missing output files: results/experiments/exampleCount/statistic/statistic_bc_correlation_merged_exampleConfig.tsv; Input files updated by another job: results/experiments/exampleCount/statistic/barcode/counts/HEPG2_exampleConfig_barcode_correlation.tsv
    wildcards: project=exampleCount, config=exampleConfig
    resources: tmpdir=/tmp


        (
        cat results/experiments/exampleCount/statistic/barcode/counts/HEPG2_exampleConfig_barcode_correlation.tsv | head -n 1;
        for i in results/experiments/exampleCount/statistic/barcode/counts/HEPG2_exampleConfig_barcode_correlation.tsv; do
            cat $i | tail -n +2;
        done;
        ) > results/experiments/exampleCount/statistic/statistic_bc_correlation_merged_exampleConfig.tsv 2> results/logs/statistic/correlation/combine_bc_raw.exampleCount.exampleConfig.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:24:30 2024]
Finished job 121.
192 of 199 steps (96%) done
[Sun Jun 23 16:24:36 2024]
Finished job 162.
193 of 199 steps (97%) done
Select jobs to execute...

[Sun Jun 23 16:24:36 2024]
rule statistic_correlation_combine_bc_assigned:
    input: results/experiments/exampleCount/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_barcode_correlation.tsv
    output: results/experiments/exampleCount/statistic/statistic_assigned_bc_correlation_merged_fromFile_exampleConfig.tsv
    log: results/logs/statistic/correlation/combine_bc_assigned.exampleCount.fromFile_exampleConfig.log
    jobid: 161
    reason: Missing output files: results/experiments/exampleCount/statistic/statistic_assigned_bc_correlation_merged_fromFile_exampleConfig.tsv; Input files updated by another job: results/experiments/exampleCount/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_barcode_correlation.tsv
    wildcards: project=exampleCount, assignment=fromFile, config=exampleConfig
    resources: tmpdir=/tmp


        (
        cat results/experiments/exampleCount/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_barcode_correlation.tsv | head -n 1;
        for i in results/experiments/exampleCount/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_barcode_correlation.tsv; do
            cat $i | tail -n +2;
        done;
        ) > results/experiments/exampleCount/statistic/statistic_assigned_bc_correlation_merged_fromFile_exampleConfig.tsv 2> results/logs/statistic/correlation/combine_bc_assigned.exampleCount.fromFile_exampleConfig.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:24:36 2024]
Finished job 161.
194 of 199 steps (97%) done
[Sun Jun 23 16:24:37 2024]
Finished job 192.
195 of 199 steps (98%) done
Select jobs to execute...

[Sun Jun 23 16:24:37 2024]
rule statistic_correlation_combine_oligo:
    input: results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_correlation.tsv, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_correlation_minThreshold.tsv
    output: results/experiments/exampleCount/statistic/statistic_oligo_correlation_merged_fromFile_exampleConfig.tsv
    log: results/logs/statistic/correlation/combine_oligo.exampleCount.exampleConfig.fromFile.log
    jobid: 191
    reason: Missing output files: results/experiments/exampleCount/statistic/statistic_oligo_correlation_merged_fromFile_exampleConfig.tsv; Input files updated by another job: results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_correlation.tsv, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_correlation_minThreshold.tsv
    wildcards: project=exampleCount, assignment=fromFile, config=exampleConfig
    resources: tmpdir=/tmp


        set +o pipefail;
        (
        cat results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_correlation.tsv | head -n 1 | awk -v 'OFS=\t' '{print $0,"threshold (min 10)"}';
        for i in results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_correlation.tsv; do
            cat $i | tail -n +2 | awk -v 'OFS=\t' '{print $0,"False"}'
        done;
        for i in results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_correlation_minThreshold.tsv; do
            cat $i | tail -n +2 | awk -v 'OFS=\t' '{print $0,"True"}'
        done;
        ) > results/experiments/exampleCount/statistic/statistic_oligo_correlation_merged_fromFile_exampleConfig.tsv 2> results/logs/statistic/correlation/combine_oligo.exampleCount.exampleConfig.fromFile.log
        
Activating conda environment: .snakemake/conda/25d920c031b0e98fe2c142f0370cdf88_
[Sun Jun 23 16:24:37 2024]
Finished job 191.
196 of 199 steps (98%) done
[Sun Jun 23 16:25:06 2024]
Finished job 188.
197 of 199 steps (99%) done
[Sun Jun 23 16:25:57 2024]
Finished job 185.
198 of 199 steps (99%) done
Select jobs to execute...

[Sun Jun 23 16:25:57 2024]
localrule all:
    input: results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_1_RNA.tsv.gz, results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_1_DNA.tsv.gz, results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_2_RNA.tsv.gz, results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_2_DNA.tsv.gz, results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_3_RNA.tsv.gz, results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_3_DNA.tsv.gz, results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_1_RNA.tsv.gz, results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_1_DNA.tsv.gz, results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_2_RNA.tsv.gz, results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_2_DNA.tsv.gz, results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_3_RNA.tsv.gz, results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_3_DNA.tsv.gz, results/experiments/exampleCount/statistic/counts.raw.tsv, results/experiments/exampleCount/statistic/counts.filtered.tsv, results/experiments/exampleCount1/statistic/counts.raw.tsv, results/experiments/exampleCount1/statistic/counts.filtered.tsv, results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_1_RNA.txt, results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_1_DNA.txt, results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_2_RNA.txt, results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_2_DNA.txt, results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_3_RNA.txt, results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_3_DNA.txt, results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_1_RNA.txt, results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_1_DNA.txt, results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_2_RNA.txt, results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_2_DNA.txt, results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_3_RNA.txt, results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_3_DNA.txt, results/experiments/exampleCount/statistic/statistic_bc_correlation_merged_exampleConfig.tsv, results/experiments/exampleCount1/statistic/statistic_bc_correlation_merged_exampleConfig.tsv, results/experiments/exampleCount/statistic/barcode/counts/HEPG2_exampleConfig_DNA_perBarcode.png, results/experiments/exampleCount/statistic/barcode/counts/HEPG2_exampleConfig_RNA_perBarcode.png, results/experiments/exampleCount1/statistic/barcode/counts/HEPG2_exampleConfig_DNA_perBarcode.png, results/experiments/exampleCount1/statistic/barcode/counts/HEPG2_exampleConfig_RNA_perBarcode.png, results/experiments/exampleCount/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_DNA_perBarcode.png, results/experiments/exampleCount/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_RNA_perBarcode.png, results/experiments/exampleCount1/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_DNA_perBarcode.png, results/experiments/exampleCount1/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_RNA_perBarcode.png, results/experiments/exampleCount/statistic/bc_overlap.counts.exampleConfig.tsv, results/experiments/exampleCount1/statistic/bc_overlap.counts.exampleConfig.tsv, results/experiments/exampleCount/statistic/statistic_assigned_bc_correlation_merged_fromFile_exampleConfig.tsv, results/experiments/exampleCount/statistic/bc_overlap.assigned_counts.exampleConfig.fromFile.tsv, results/experiments/exampleCount1/statistic/statistic_assigned_bc_correlation_merged_fromFile_exampleConfig.tsv, results/experiments/exampleCount1/statistic/bc_overlap.assigned_counts.exampleConfig.fromFile.tsv, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.combined.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_minThreshold_merged.combined.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged_barcode_assigned_counts.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.combined.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_minThreshold_merged.combined.tsv.gz, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged_barcode_assigned_counts.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_all_barcodesPerInsert_box.png, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_all_barcodesPerInsert_box_minThreshold.png, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_group_barcodesPerInsert_box.png, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_group_barcodesPerInsert_box_minThreshold.png, results/experiments/exampleCount/statistic/statistic_assigned_counts_merged_fromFile_exampleConfig.tsv, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_all_barcodesPerInsert_box.png, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_all_barcodesPerInsert_box_minThreshold.png, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_group_barcodesPerInsert_box.png, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_group_barcodesPerInsert_box_minThreshold.png, results/experiments/exampleCount1/statistic/statistic_assigned_counts_merged_fromFile_exampleConfig.tsv, results/experiments/exampleCount/statistic/statistic_oligo_correlation_merged_fromFile_exampleConfig.tsv, results/experiments/exampleCount/statistic/statistic_assigned_counts_single_fromFile_exampleConfig.tsv, results/experiments/exampleCount1/statistic/statistic_oligo_correlation_merged_fromFile_exampleConfig.tsv, results/experiments/exampleCount1/statistic/statistic_assigned_counts_single_fromFile_exampleConfig.tsv
    jobid: 0
    reason: Input files updated by another job: results/experiments/exampleCount1/statistic/barcode/counts/HEPG2_exampleConfig_RNA_perBarcode.png, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged_barcode_assigned_counts.tsv.gz, results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_3_RNA.txt, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_group_barcodesPerInsert_box.png, results/experiments/exampleCount/statistic/counts.filtered.tsv, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.combined.tsv.gz, results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_3_RNA.txt, results/experiments/exampleCount/statistic/statistic_bc_correlation_merged_exampleConfig.tsv, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged_barcode_assigned_counts.tsv.gz, results/experiments/exampleCount/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_DNA_perBarcode.png, results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_1_DNA.txt, results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_2_DNA.txt, results/experiments/exampleCount/statistic/bc_overlap.counts.exampleConfig.tsv, results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_1_RNA.tsv.gz, results/experiments/exampleCount/statistic/statistic_assigned_counts_single_fromFile_exampleConfig.tsv, results/experiments/exampleCount1/statistic/statistic_oligo_correlation_merged_fromFile_exampleConfig.tsv, results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_2_DNA.txt, results/experiments/exampleCount1/statistic/statistic_assigned_counts_single_fromFile_exampleConfig.tsv, results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_3_DNA.txt, results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_2_RNA.tsv.gz, results/experiments/exampleCount/statistic/statistic_assigned_bc_correlation_merged_fromFile_exampleConfig.tsv, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_minThreshold_merged.combined.tsv.gz, results/experiments/exampleCount/statistic/bc_overlap.assigned_counts.exampleConfig.fromFile.tsv, results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_2_RNA.txt, results/experiments/exampleCount1/statistic/barcode/counts/HEPG2_exampleConfig_DNA_perBarcode.png, results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_1_DNA.tsv.gz, results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_1_RNA.tsv.gz, results/experiments/exampleCount1/statistic/counts.raw.tsv, results/experiments/exampleCount/statistic/statistic_oligo_correlation_merged_fromFile_exampleConfig.tsv, results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_1_RNA.txt, results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_3_DNA.txt, results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_1_DNA.tsv.gz, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.tsv.gz, results/experiments/exampleCount1/statistic/bc_overlap.counts.exampleConfig.tsv, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_group_barcodesPerInsert_box.png, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_group_barcodesPerInsert_box_minThreshold.png, results/experiments/exampleCount1/statistic/counts.filtered.tsv, results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_2_RNA.txt, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_group_barcodesPerInsert_box_minThreshold.png, results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_3_RNA.tsv.gz, results/experiments/exampleCount1/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_RNA_perBarcode.png, results/experiments/exampleCount/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_minThreshold_merged.combined.tsv.gz, results/experiments/exampleCount1/statistic/statistic_assigned_counts_merged_fromFile_exampleConfig.tsv, results/experiments/exampleCount1/statistic/counts.freqUMIs.HEPG2_1_DNA.txt, results/experiments/exampleCount/statistic/statistic_assigned_counts_merged_fromFile_exampleConfig.tsv, results/experiments/exampleCount/statistic/barcode/counts/HEPG2_exampleConfig_DNA_perBarcode.png, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_all_barcodesPerInsert_box_minThreshold.png, results/experiments/exampleCount1/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_DNA_perBarcode.png, results/experiments/exampleCount1/statistic/bc_overlap.assigned_counts.exampleConfig.fromFile.tsv, results/experiments/exampleCount1/statistic/statistic_bc_correlation_merged_exampleConfig.tsv, results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_2_RNA.tsv.gz, results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_3_RNA.tsv.gz, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_all_barcodesPerInsert_box.png, results/experiments/exampleCount/statistic/counts.raw.tsv, results/experiments/exampleCount/statistic/barcode/assigned_counts/fromFile/HEPG2_exampleConfig_RNA_perBarcode.png, results/experiments/exampleCount1/statistic/statistic_assigned_bc_correlation_merged_fromFile_exampleConfig.tsv, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.tsv.gz, results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_2_DNA.tsv.gz, results/experiments/exampleCount/statistic/barcode/counts/HEPG2_exampleConfig_RNA_perBarcode.png, results/experiments/exampleCount1/assigned_counts/fromFile/exampleConfig/HEPG2_allreps_merged.combined.tsv.gz, results/experiments/exampleCount/statistic/counts.freqUMIs.HEPG2_1_RNA.txt, results/experiments/exampleCount/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_all_barcodesPerInsert_box_minThreshold.png, results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_3_DNA.tsv.gz, results/experiments/exampleCount1/statistic/assigned_counts/fromFile/exampleConfig/HEPG2_all_barcodesPerInsert_box.png, results/experiments/exampleCount1/statistic/counts/BCNucleotideComposition.HEPG2_3_DNA.tsv.gz, results/experiments/exampleCount/statistic/counts/BCNucleotideComposition.HEPG2_2_DNA.tsv.gz
    resources: tmpdir=/tmp

[Sun Jun 23 16:25:57 2024]
Finished job 0.
199 of 199 steps (100%) done
Complete log: .snakemake/log/2024-06-23T162107.902855.snakemake.log
